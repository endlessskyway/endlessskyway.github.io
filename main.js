jsgl={elements:{dom:{}},panel:{},path:{},stroke:{},fill:{},util:{}};jsgl.util.BrowserInfo=(function(){__browserinfo=0;document.write("<!--[if vml]><script type='text/javascript'>__browserinfo++;<\/script><![endif]-->");if(document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))){__browserinfo+=2}document.write("<!--[if IE]><script type='text/javascript'>__browserinfo+=4;<\/script><![endif]-->");document.write("<!--[if IE 5.5000]><script type='text/javascript'>__browserinfo+=8;<\/script><![endif]-->");document.write("<!--[if lte IE 6]><script type='text/javascript'>__browserinfo+=32;<\/script><![endif]-->");document.write("<!--[if lte IE 7]><script type='text/javascript'>__browserinfo+=64;<\/script><![endif]-->");if(typeof(window.event)!="undefined"){__browserinfo+=16}this.supportsVml=!!(__browserinfo&1);this.supportsSvg=!!(__browserinfo&2);this.isMSIE=!!(__browserinfo&4);this.isMSIE55=!!(__browserinfo&8);this.usesWindowEvent=!!(__browserinfo&16);this.isMSIElte6=!!(__browserinfo&32);this.isMSIElte7=!!(__browserinfo&&64);this.isOpera=!this.isMSIE&&this.usesWindowEvent;return this})();Function.prototype.jsglExtend=function(a){function b(){}b.prototype=a.prototype;this.prototype=new b();this.prototype.constructor=this;this.base=b.prototype;this.base.constructor=a};Number.prototype.jsglVmlize=function(){return Math.round(this*1000)};jsgl.util.delegate=function(a,b){return function(){return b.apply(a,arguments)}};jsgl.cloneObject=function(c){if(c==null||typeof(c)!="object"){return c}var a=new c.constructor();for(var b in c){a[b]=jsgl.cloneObject(c[b])}return a};jsgl.util.clone=function(c){if(c==null||typeof(c)!="object"){return c}var a=new c.constructor();for(var b in c){a[b]=jsgl.util.clone(c[b])}return a};if(navigator.userAgent.indexOf("MSIE 5.0")>0){Function.prototype.call=function(obj){obj.__fnc=this;var __args="";for(var i=1;i<arguments.length;i++){__args+=(i==1?"":",")+"arguments["+i+"]"}return eval("obj.__fnc("+__args+")")};Function.prototype.apply=function(obj,args){obj.__fnc=this;var __args="";for(var i=0;i<args.length;i++){__args+=(i==0?"":",")+"args["+i+"]"}return eval("obj.__fnc("+__args+")")}}jsgl.util.ArrayList=function(){this.items=[];this.count=0};jsgl.util.ArrayList.prototype.add=function(a){if(typeof(a)=="undefined"){return}this.insertAt(a,this.count)};jsgl.util.ArrayList.prototype.clear=function(c){var d=c||jsgl.util.ArrayList.DEFAULT_CLEAR_FILTER;var a=0;for(var b=0;b<this.count;b++){if(d(this.items[b])){delete this.items[b]}else{if(b!=a){this.items[a]=this.items[b];delete this.items[b]}a++}}this.count=a};jsgl.util.ArrayList.prototype.contains=function(b){for(var a=0;a<this.count;a++){if(this.items[a]===b){return true}}return false};jsgl.util.ArrayList.prototype.getCount=function(){return this.count};jsgl.util.ArrayList.DEFAULT_CLEAR_FILTER=function(){return true};jsgl.util.ArrayList.prototype.get=function(a){if((a>=0)&&(a<this.count)){return this.items[a]}else{return null}};jsgl.util.ArrayList.prototype.setAt=function(b,a){if(typeof(b)=="undefined"||a<0){return}this.items[a]=b;if(a>=this.count){this.count=a+1}};jsgl.util.ArrayList.prototype.insertAt=function(c,a){if(typeof(c)=="undefined"||a<0){return}for(var b=this.count;b>a;b--){this.items[b]=this.items[b-1]}for(var b=this.count;b<a;b++){this.items[b]=null}this.items[a]=c;if(a>this.count){this.count=a+1}else{this.count++}};jsgl.util.ArrayList.prototype.removeAt=function(a){if(a<0||a>=this.count){return}for(var b=a+1;b<this.count;b++){this.items[b-1]=this.items[b]}this.items[this.count-1]=null;this.count--};jsgl.util.ArrayList.prototype.remove=function(a){this.clear(function(b){return b===a})};jsgl.util.ArrayList.prototype.reverse=function(){this.items.reverse()};jsgl.util.ArrayList.prototype.sort=function(a){var e=function(h,g){var c=(a||jsgl.util.ArrayList.DEFAULT_COMPARATOR)(h,g);return(typeof(c)=="number"?c:0)};var f=true;while(f){f=false;for(var d=1;d<this.count;d++){if(e(this.items[d-1],this.items[d])<0){f=true;var b=this.items[d-1];this.items[d-1]=this.items[d];this.items[d]=b}}}};jsgl.util.ArrayList.DEFAULT_COMPARATOR=function(d,c){return c-d};jsgl.util.ArrayList.prototype.toString=function(a){var c="";for(var b=0;b<this.count;b++){if(b!=0){c+=","}c+=b+":"+this.items[b]}return"ArrayList(count="+this.count+",items=["+c+"])"};jsgl.util.SortedList=function(a){if(a){this.comparator=a}this.items=[];this.count=0};jsgl.util.SortedList.prototype.comparator=function(d,c){if(c>d){return 1}if(c<d){return -1}return 0};jsgl.util.SortedList.prototype.setComparator=function(a){if(a){this.comparator=a}else{delete this.comparator}};jsgl.util.SortedList.prototype.add=function(b){var c;if(this.count==0){c=0}else{var a=this.count;while((a>0)&&(this.comparator(this.items[a-1],b)<0)){a--}c=a;for(var a=this.count;a>=c;a--){this.items[a+1]=this.items[a]}}this.items[c]=b;this.count++};jsgl.util.SortedList.prototype.contains=function(b){for(var a=0;a<this.count;a++){if(this.items[a]==b){return true}}return false};jsgl.util.SortedList.prototype.get=function(a){return this.items[a]};jsgl.util.SortedList.prototype.getCount=function(){return this.count};jsgl.util.SortedList.prototype.remove=function(c){if(this.count==0){return}for(var b=0;b<this.count;b++){if(this.items[b]==c){for(var a=b;a<this.count-1;a++){this.items[a]=this.items[a+1]}this.items[this.count-1]=null;this.count--;break}}};jsgl.util.SortedList.prototype.removeAt=function(a){if(a<0||a>=this.count){return}for(var b=a;b<this.count-1;b++){this.items[b]=this.items[b+1]}this.items[this.count-1]=null;this.count--};jsgl.util.SortedList.prototype.toString=function(){var a="";for(var b=0;b<this.count;b++){if(b!=0){a+=","}a+=this.items[b]}return"SortedList(count="+this.count+",items=["+a+"])"};jsgl.util.Queue=function(){this.first=null;this.last=null;this.count=0};jsgl.util.Queue.prototype.enqueue=function(a){if(this.first==null){this.first=this.last={item:a,next:null}}else{this.last.next=this.last={item:a,next:null}}this.count++};jsgl.util.Queue.prototype.dequeue=function(){var a=this.first&&this.first.item;if(this.first!=null){if(this.last==this.first){this.last=null}this.first=this.first.next;this.count--}return a};jsgl.util.Queue.prototype.peek=function(){return this.first&&this.first.item};jsgl.util.Queue.prototype.getCount=function(){return this.count};jsgl.util.Queue.prototype.toString=function(){var a="";obj=this.first;while(obj){if(obj!=this.first){a+=","}a+=obj.item;obj=obj.next}return"Queue(count="+this.getCount()+",items=["+a+"])"};jsgl.util.CommandQueue=function(){jsgl.util.Queue.call(this);this.stopped=false};jsgl.util.CommandQueue.jsglExtend(jsgl.util.Queue);jsgl.util.CommandQueue.prototype.stop=function(){this.stopped=true};jsgl.util.CommandQueue.prototype.go=function(){while(this.peek()!=null){this.dequeue()}this.stopped=false};jsgl.util.CommandQueue.prototype.enqueue=function(a){if(this.stopped){jsgl.util.Queue.prototype.enqueue.call(this,a)}else{a()}};jsgl.util.CommandQueue.prototype.dequeue=function(){jsgl.util.Queue.prototype.dequeue.call(this)()};jsgl.util.EventRaiser=function(){this.listeners=new jsgl.util.ArrayList();this.commandQueue=new jsgl.util.CommandQueue()};jsgl.util.EventRaiser.prototype.registerListener=function(a){if(!a){return}this.commandQueue.enqueue(jsgl.util.delegate(this,function(){this.listeners.add(a)}))};jsgl.util.EventRaiser.prototype.unregisterListener=function(a){if(!a){return}this.commandQueue.enqueue(jsgl.util.delegate(this,function(){this.listeners.remove(a)}))};jsgl.util.EventRaiser.prototype.raiseEvent=function(a){this.commandQueue.enqueue(jsgl.util.delegate(this,function(){this.commandQueue.stop();for(var b=0;b<this.listeners.getCount();b++){this.listeners.get(b)(a)}this.commandQueue.go()}))};jsgl.util.Property=function(a){this.value=a;this.eventRaiser=new jsgl.util.EventRaiser()};jsgl.util.Property.prototype.setValue=function(a){if(this.value!=a){this.value=a;this.eventRaiser.raiseEvent(a)}};jsgl.util.Property.prototype.getValue=function(){return this.value};jsgl.util.Property.prototype.registerChangeListener=function(a){this.eventRaiser.registerListener(a)};jsgl.util.Property.prototype.unregisterChangeListener=function(a){this.eventRaiser.unregisterListener(a)};jsgl.util.StructuredProperty=function(a){jsgl.util.Property.call(this,a);this.internalChangeListener=jsgl.util.delegate(this.eventRaiser,this.eventRaiser.raiseEvent)};jsgl.util.StructuredProperty.jsglExtend(jsgl.util.Property);jsgl.util.StructuredProperty.prototype.getInternalChangeListener=function(){return this.internalChangeListener};jsgl.util.singletonInstanceGetter=function(){if(!this.instance){this.instance=new this()}return this.instance};jsgl.util.Animator=function(){this.startValue=0;this.endValue=1;this.duration=1000;this.currTime=0;this.reversed=false;this.animRaiser=new jsgl.util.EventRaiser();this.animStartRaiser=new jsgl.util.EventRaiser();this.animEndRaiser=new jsgl.util.EventRaiser();this.prevStepTime=0;this.timer=0;this.fps=jsgl.util.BrowserInfo.isMSIE?10:20;this.repeat=false;this.playing=false};jsgl.util.Animator.prototype.getStartValue=function(){return this.startValue};jsgl.util.Animator.prototype.setStartValue=function(a){this.startValue=a};jsgl.util.Animator.prototype.getEndValue=function(){return this.endValue};jsgl.util.Animator.prototype.setEndValue=function(a){this.endValue=a};jsgl.util.Animator.prototype.getDuration=function(){return this.timeStep};jsgl.util.Animator.prototype.setDuration=function(a){this.duration=a};jsgl.util.Animator.prototype.getReversed=function(){return this.reversed};jsgl.util.Animator.prototype.isReversed=function(){return this.reversed};jsgl.util.Animator.prototype.setReversed=function(a){this.reversed=a};jsgl.util.Animator.prototype.addStartListener=function(a){this.animStartRaiser.registerListener(a)};jsgl.util.Animator.prototype.removeStartListener=function(a){this.animStartRaiser.unregisterListener(a)};jsgl.util.Animator.prototype.addStepListener=function(a){this.animRaiser.registerListener(a)};jsgl.util.Animator.prototype.removeStepListener=function(a){this.animRaiser.unregisterListener(a)};jsgl.util.Animator.prototype.addEndListener=function(a){this.animEndRaiser.registerListener(a)};jsgl.util.Animator.prototype.removeEndListener=function(a){this.animEndRaiser.unregisterListener(a)};jsgl.util.Animator.prototype.step=function(){var a=(new Date()).getTime();if(this.prevStepTime){this.currTime+=(this.reversed?-1:1)*(a-this.prevStepTime)}this.currTime=Math.max(0,Math.min(this.currTime,this.duration));var b=this.startValue+(this.currTime/this.duration)*(this.endValue-this.startValue);this.animRaiser.raiseEvent(b);if((!this.reversed&&this.currTime==this.duration)||(this.reversed&&this.currTime==0)){if(this.repeat){this.currTime=this.reversed?this.duration:0;this.prevStepTime=a}else{window.clearInterval(this.timer);this.playing=false;this.timer=0;this.prevStepTime=0}this.animEndRaiser.raiseEvent()}else{this.prevStepTime=a}};jsgl.util.Animator.prototype.init=function(){this.animRaiser.raiseEvent(this.startValue+(this.currTime/this.duration)*(this.endValue-this.startValue))};jsgl.util.Animator.prototype.play=function(){if(this.currTime==this.duration&&!this.reversed){this.currTime=0}if(!this.currTime){this.animStartRaiser.raiseEvent()}if(!this.timer){this.step();this.timer=window.setInterval(jsgl.util.delegate(this,this.step),1000/this.fps)}this.playing=true};jsgl.util.Animator.prototype.rewind=function(){this.currTime=0;this.prevStepTime=0};jsgl.util.Animator.prototype.pause=function(){window.clearInterval(this.timer);this.timer=0;this.prevStepTime=0;this.playing=false};jsgl.util.Animator.prototype.stop=function(){window.clearInterval(this.timer);this.timer=0;this.currTime=0;this.prevStepTime=0;this.step();this.currTime=0;this.prevStepTime=0;this.playing=false};jsgl.util.Animator.prototype.setRepeating=function(a){this.repeat=a};jsgl.util.Animator.prototype.isRepeating=function(){return this.repeat};jsgl.util.Animator.prototype.isPlaying=function(){return this.playing};jsgl.util.Animator.prototype.setFps=function(a){this.fps=a};jsgl.util.Animator.prototype.getFps=function(){return this.fps};jsgl.Vector2D=function(a,b){this.X=typeof(a)=="number"?a:0;this.Y=typeof(b)=="number"?b:0};jsgl.Vector2D.NULL=new jsgl.Vector2D();jsgl.Vector2D.INVALID=new jsgl.Vector2D(Number.NaN,Number.NaN);jsgl.Vector2D.prototype.getX=function(){return this.X};jsgl.Vector2D.prototype.setX=function(a){this.X=typeof(a)=="number"?a:0};jsgl.Vector2D.prototype.getY=function(){return this.Y};jsgl.Vector2D.prototype.setY=function(a){this.Y=typeof(a)=="number"?a:0};jsgl.Vector2D.prototype.add=function(a){return new jsgl.Vector2D(this.X+a.X,this.Y+a.Y)};jsgl.Vector2D.prototype.subtract=function(a){return new jsgl.Vector2D(this.X-a.X,this.Y-a.Y)};jsgl.Vector2D.prototype.rotate=function(d,b,e){var c=e+Math.atan2(this.Y-b,this.X-d),a=Math.sqrt((this.X-d)*(this.X-d)+(this.Y-b)*(this.Y-b));return new jsgl.Vector2D(d+Math.cos(c)*a,b+Math.sin(c)*a)};jsgl.Vector2D.prototype.multiply=function(a){return new jsgl.Vector2D(a*this.X,a*this.Y)};jsgl.Vector2D.prototype.round=function(){return new jsgl.Vector2D(Math.round(this.X),Math.round(this.Y))};jsgl.Vector2D.prototype.applyToCSSLocationOf=function(a){a.style.left=this.X+"px";a.style.top=this.Y+"px"};jsgl.Vector2D.prototype.applyToCSSSizeOf=function(a){a.style.width=this.X+"px";a.style.height=this.Y+"px"};jsgl.Vector2D.prototype.equals=function(a){if(a==null||typeof(a)!="object"){return false}if(a.constructor!=jsgl.Vector2D){return false}return(a.X==this.X)&&(a.Y==this.Y)};jsgl.Vector2D.prototype.toString=function(){return this.X+" "+this.Y};jsgl.Vector2D.getDistance=function(b,a){return Math.sqrt((b.X-a.X)*(b.X-a.X)+(b.Y-a.Y)*(b.Y-a.Y))};jsgl.stroke.AbstractStroke=function(){this.onChangeRaiser=new jsgl.util.EventRaiser()};jsgl.stroke.AbstractStroke.prototype.applyToSvgElement=function(a){throw"not implemented"};jsgl.stroke.AbstractStroke.prototype.applyToVmlStrokeElement=function(a){throw"not implemented"};jsgl.stroke.AbstractStroke.prototype.registerChangeListener=function(a){this.onChangeRaiser.registerListener(a)};jsgl.stroke.AbstractStroke.prototype.unregisterChangeListener=function(a){this.onChangeRaiser.unregisterListener(a)};jsgl.stroke.DisabledStroke=function(){jsgl.stroke.AbstractStroke.call(this)};jsgl.stroke.DisabledStroke.jsglExtend(jsgl.stroke.AbstractStroke);jsgl.stroke.DISABLED=new jsgl.stroke.DisabledStroke();jsgl.stroke.DisabledStroke.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke","none",null)};jsgl.stroke.DisabledStroke.prototype.applyToVmlStrokeElement=function(a){a.on=false};jsgl.stroke.SolidStroke=function(){jsgl.stroke.AbstractStroke.call(this);this.weight=1;this.color="black";this.opacity=1;this.enabled=true;this.dashStyle=new jsgl.stroke.SolidDashStyle();this.endcapType=new jsgl.stroke.RoundEndcapType();this.joinStyle=new jsgl.stroke.RoundJoinStyle()};jsgl.stroke.SolidStroke.jsglExtend(jsgl.stroke.AbstractStroke);jsgl.stroke.SolidStroke.prototype.applyToSvgElement=function(a){if(this.enabled){a.style.setProperty("stroke",this.color,null);a.style.setProperty("stroke-width",this.weight+"px",null);a.style.setProperty("stroke-opacity",this.opacity,null);this.dashStyle.applyToSvgElement(a,this.weight);this.endcapType.applyToSvgElement(a);this.joinStyle.applyToSvgElement(a)}else{a.style.setProperty("stroke","none",null)}};jsgl.stroke.SolidStroke.prototype.applyToVmlStrokeElement=function(a){if(this.enabled){a.color=this.color;a.weight=this.weight+"px";a.opacity=this.opacity;a.on=true;this.dashStyle.applyToVmlStrokeElement(a);this.endcapType.applyToVmlStrokeElement(a);this.joinStyle.applyToVmlStrokeElement(a)}else{a.on=false}};jsgl.stroke.SolidStroke.prototype.getWeight=function(){return this.weight};jsgl.stroke.SolidStroke.prototype.setWeight=function(a){this.weight=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getColor=function(){return this.color};jsgl.stroke.SolidStroke.prototype.setColor=function(a){this.color=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getOpacity=function(){return this.opacity};jsgl.stroke.SolidStroke.prototype.setOpacity=function(a){this.opacity=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getDashStyle=function(){return this.dashStyle};jsgl.stroke.SolidStroke.prototype.setDashStyle=function(a){this.dashStyle=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getEndcapType=function(){return this.endcapType};jsgl.stroke.SolidStroke.prototype.setEndcapType=function(a){this.endcapType=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getJoinStyle=function(){return this.joinStyle};jsgl.stroke.SolidStroke.prototype.setJoinStyle=function(a){this.joinStyle=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.SolidStroke.prototype.getEnabled=function(){return this.enabled};jsgl.stroke.SolidStroke.prototype.isEnabled=jsgl.stroke.SolidStroke.prototype.getEnabled;jsgl.stroke.SolidStroke.prototype.isEnabled=function(){return this.enabled};jsgl.stroke.SolidStroke.prototype.setEnabled=function(a){this.enabled=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.AbstractEndcapType=function(){};jsgl.stroke.AbstractEndcapType.prototype.applyToSvgElement=function(a){throw"not implemented"};jsgl.stroke.AbstractEndcapType.prototype.applyToVmlStrokeElement=function(a){throw"not implemented"};jsgl.stroke.FlatEndcapType=function(){};jsgl.stroke.FlatEndcapType.jsglExtend(jsgl.stroke.AbstractEndcapType);jsgl.stroke.FlatEndcapType.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke-linecap","butt",null)};jsgl.stroke.FlatEndcapType.prototype.applyToVmlStrokeElement=function(a){a.endcap="flat"};jsgl.stroke.FlatEndcapType.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.RoundEndcapType=function(){};jsgl.stroke.RoundEndcapType.jsglExtend(jsgl.stroke.AbstractEndcapType);jsgl.stroke.RoundEndcapType.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke-linecap","round",null)};jsgl.stroke.RoundEndcapType.prototype.applyToVmlStrokeElement=function(a){a.endcap="round"};jsgl.stroke.RoundEndcapType.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.SquareEndcapType=function(){};jsgl.stroke.SquareEndcapType.jsglExtend(jsgl.stroke.AbstractEndcapType);jsgl.stroke.SquareEndcapType.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke-linecap","square",null)};jsgl.stroke.SquareEndcapType.prototype.applyToVmlStrokeElement=function(a){a.endcap="square"};jsgl.stroke.SquareEndcapType.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.AbstractJoinStyle=function(){this.onChangeRaiser=new EventRaiser()};jsgl.stroke.AbstractJoinStyle.prototype.applyToSvgElement=function(a){throw"not implemented"};jsgl.stroke.AbstractJoinStyle.prototype.applyToVmlStrokeElement=function(a){throw"not implemented"};jsgl.stroke.AbstractJoinStyle.prototype.containsPointStrokeTest=function(a,d,c,b,e){return false};jsgl.stroke.AbstractJoinStyle.prototype.registerChangeListener=function(a){this.onChangeRaiser.registerListener(a)};jsgl.stroke.AbstractJoinStyle.prototype.unregisterChangeListener=function(a){this.onChangeRaiser.unregisterListener(a)};jsgl.stroke.BevelJoinStyle=function(){};jsgl.stroke.BevelJoinStyle.jsglExtend(jsgl.stroke.AbstractJoinStyle);jsgl.stroke.BevelJoinStyle.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke-linejoin","bevel",null)};jsgl.stroke.BevelJoinStyle.prototype.applyToVmlStrokeElement=function(a){a.joinstyle="bevel"};jsgl.stroke.BevelJoinStyle.prototype.containsPointStrokeTest=function(l,c,k,h,g){var b=Math.cos(k+Math.PI/2)*g/2,a=Math.sin(k+Math.PI/2)*g/2,j=Math.cos(h-Math.PI/2)*g/2,f=Math.sin(h-Math.PI/2)*g/2,e=l.X-c.X,d=l.Y-c.Y;var m=(b*d-a*e)/(b*f-a*j),n=(e-j*m)/b;return(n>=0)&&(m>=0)&&(n+m<=1)};jsgl.stroke.BevelJoinStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.MiterJoinStyle=function(a){this.miterLimit=a};jsgl.stroke.MiterJoinStyle.jsglExtend(jsgl.stroke.AbstractJoinStyle);jsgl.stroke.MiterJoinStyle.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke-linejoin","miter",null);a.style.setProperty("stroke-miterlimit",this.miterLimit,null)};jsgl.stroke.MiterJoinStyle.prototype.applyToVmlStrokeElement=function(a){a.joinstyle="miter";a.miterlimit=this.miterLimit};jsgl.stroke.MiterJoinStyle.prototype.getMiterLimit=function(){return this.miterLimit};jsgl.stroke.MiterJoinStyle.prototype.setMiterLimit=function(a){this.miterLimit=a;this.onChangeRaiser.raiseEvent()};jsgl.stroke.RoundJoinStyle=function(){};jsgl.stroke.RoundJoinStyle.jsglExtend(jsgl.stroke.AbstractJoinStyle);jsgl.stroke.RoundJoinStyle.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke-linejoin","round",null)};jsgl.stroke.RoundJoinStyle.prototype.applyToVmlStrokeElement=function(a){a.joinstyle="round"};jsgl.stroke.RoundJoinStyle.prototype.containsPointStrokeTest=function(a,d,c,b,e){return jsgl.Vector2D.getDistance(a,d)<=e/2};jsgl.stroke.RoundJoinStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.AbstractDashStyle=function(){};jsgl.stroke.AbstractDashStyle.prototype.getDashArray=function(){throw"not implemented"};jsgl.stroke.AbstractDashStyle.prototype.applyToSvgElement=function(d,c){var a=this.getDashArray();for(var b=0;b<a.length;b++){a[b]*=c;if(!a[b]){a[b]+=0.01}}d.style.setProperty("stroke-dasharray",a.join(),null)};jsgl.stroke.AbstractDashStyle.prototype.applyToVmlStrokeElement=function(a){throw"not implemented"};jsgl.stroke.DashDashStyle=function(){};jsgl.stroke.DashDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.DashDashStyle.prototype.getDashArray=function(){return[3,4]};jsgl.stroke.DashDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="dash"};jsgl.stroke.DashDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.DashDotDashStyle=function(){};jsgl.stroke.DashDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.DashDotDashStyle.prototype.getDashArray=function(){return[3,4,0,4]};jsgl.stroke.DashDotDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="dashdot"};jsgl.stroke.DashDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.DotDashStyle=function(){};jsgl.stroke.DotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.DotDashStyle.prototype.getDashArray=function(){return[0,4]};jsgl.stroke.DotDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="dot"};jsgl.stroke.DotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.LongDashDashStyle=function(){};jsgl.stroke.LongDashDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.LongDashDashStyle.prototype.getDashArray=function(){return[7,4]};jsgl.stroke.LongDashDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="longdash"};jsgl.stroke.LongDashDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.LongDashDotDashStyle=function(){};jsgl.stroke.LongDashDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.LongDashDotDashStyle.prototype.getDashArray=function(){return[7,4,0,4]};jsgl.stroke.LongDashDotDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="longdashdot"};jsgl.stroke.LongDashDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.LongDashDotDotDashStyle=function(){};jsgl.stroke.LongDashDotDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.LongDashDotDotDashStyle.prototype.getDashArray=function(){return[7,4,0,4,0,4]};jsgl.stroke.LongDashDotDotDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="longdashdotdot"};jsgl.stroke.LongDashDotDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.ShortDashDotDashStyle=function(){};jsgl.stroke.ShortDashDotDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.ShortDashDotDashStyle.prototype.getDashArray=function(){return[2,2,0,2]};jsgl.stroke.ShortDashDotDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="shortdashdot"};jsgl.stroke.ShortDashDotDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.stroke.SolidDashStyle=function(){};jsgl.stroke.SolidDashStyle.jsglExtend(jsgl.stroke.AbstractDashStyle);jsgl.stroke.SolidDashStyle.prototype.getDashArray=function(){return[Number.POSITIVE_INFINITY]};jsgl.stroke.SolidDashStyle.prototype.applyToSvgElement=function(a){a.style.setProperty("stroke-dasharray","none",null)};jsgl.stroke.SolidDashStyle.prototype.applyToVmlStrokeElement=function(a){a.dashstyle="solid"};jsgl.stroke.SolidDashStyle.getInstance=jsgl.util.singletonInstanceGetter;jsgl.fill.AbstractFill=function(){this.onChangeRaiser=new jsgl.util.EventRaiser()};jsgl.fill.AbstractFill.prototype.applyToSvgElement=function(a){throw"not implemented"};jsgl.fill.AbstractFill.prototype.applyToVmlFillElement=function(a){throw"not implemented"};jsgl.fill.AbstractFill.prototype.registerChangeListener=function(a){this.onChangeRaiser.registerListener(a)};jsgl.fill.AbstractFill.prototype.unregisterChangeListener=function(a){this.onChangeRaiser.unregisterListener(a)};jsgl.fill.DisabledFill=function(){jsgl.fill.AbstractFill.call(this)};jsgl.fill.DisabledFill.jsglExtend(jsgl.fill.AbstractFill);jsgl.fill.DISABLED=new jsgl.fill.DisabledFill();jsgl.fill.DisabledFill.prototype.applyToSvgElement=function(a){a.style.setProperty("fill","none",null)};jsgl.fill.DisabledFill.prototype.applyToVmlFillElement=function(a){a.on=false};jsgl.fill.SolidFill=function(a,c,b){jsgl.fill.AbstractFill.call(this);this.color=a||"white";this.opacity=typeof(c)!="undefined"?c:1;this.enabled=typeof(b)!="undefined"?!!b:true};jsgl.fill.SolidFill.jsglExtend(jsgl.fill.AbstractFill);jsgl.fill.SolidFill.prototype.applyToSvgElement=function(a){if(this.enabled){a.style.setProperty("fill",this.color,null);a.style.setProperty("fill-opacity",this.opacity,null)}else{a.style.setProperty("fill","none",null)}};jsgl.fill.SolidFill.prototype.applyToVmlFillElement=function(a){if(this.enabled){a.type="solid";a.color=this.color;a.opacity=this.opacity;a.on=true}else{a.on=false}};jsgl.fill.SolidFill.prototype.getColor=function(){return this.color};jsgl.fill.SolidFill.prototype.setColor=function(a){this.color=a;this.onChangeRaiser.raiseEvent()};jsgl.fill.SolidFill.prototype.getEnabled=function(){return this.enabled};jsgl.fill.SolidFill.prototype.isEnabled=jsgl.fill.SolidFill.prototype.getEnabled;jsgl.fill.SolidFill.prototype.setEnabled=function(a){this.enabled=a;this.onChangeRaiser.raiseEvent()};jsgl.fill.SolidFill.prototype.getOpacity=function(){return this.opacity};jsgl.fill.SolidFill.prototype.setOpacity=function(a){this.opacity=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractElement=function(a){this.panel=a;this.container=null;this.age=0;this.zIndex=0;this.zIndexChangeRaiser=new jsgl.util.EventRaiser();this.cursor=jsgl.Cursor.INHERIT;this.uid=jsgl.elements.AbstractElement.uidCounter++;this.onChangeRaiser=new jsgl.util.EventRaiser();this.mouseMoveRaiser=new jsgl.util.EventRaiser();this.mouseDownRaiser=new jsgl.util.EventRaiser();this.mouseUpRaiser=new jsgl.util.EventRaiser();this.mouseOverRaiser=new jsgl.util.EventRaiser();this.mouseOutRaiser=new jsgl.util.EventRaiser();this.clickRaiser=new jsgl.util.EventRaiser();this.dblClickRaiser=new jsgl.util.EventRaiser()};jsgl.elements.AbstractElement.uidCounter=0;jsgl.elements.AbstractElement.prototype.getUid=function(){return this.uid};jsgl.elements.AbstractElement.prototype.getPanel=function(){return this.panel};jsgl.elements.AbstractElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.AbstractElement.prototype.setContainer=function(a){this.container=a};jsgl.elements.AbstractElement.prototype.getContainer=function(){return this.container};jsgl.elements.AbstractElement.prototype.getAge=function(){return this.age};jsgl.elements.AbstractElement.prototype.setAge=function(a){this.age=a};jsgl.elements.AbstractElement.prototype.addMouseMoveListener=function(a){this.mouseMoveRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeMouseMoveListener=function(a){this.mouseMoveRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.raiseMouseMove=function(a){this.mouseMoveRaiser.raiseEvent(a)};jsgl.elements.AbstractElement.prototype.addMouseDownListener=function(a){this.mouseDownRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeMouseDownListener=function(a){this.mouseDownRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.raiseMouseDown=function(a){this.mouseDownRaiser.raiseEvent(a)};jsgl.elements.AbstractElement.prototype.addMouseUpListener=function(a){this.mouseUpRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeMouseUpListener=function(a){this.mouseUpRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.raiseMouseUp=function(a){this.mouseUpRaiser.raiseEvent(a)};jsgl.elements.AbstractElement.prototype.addMouseOverListener=function(a){this.mouseOverRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeMouseOverListener=function(a){this.mouseOverRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.raiseMouseOver=function(a){this.mouseOverRaiser.raiseEvent(a)};jsgl.elements.AbstractElement.prototype.addMouseOutListener=function(a){this.mouseOutRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeMouseOutListener=function(a){this.mouseOutRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.raiseMouseOut=function(a){this.mouseOutRaiser.raiseEvent(a)};jsgl.elements.AbstractElement.prototype.addClickListener=function(a){this.clickRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeClickListener=function(a){this.clickRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.raiseClick=function(a){this.clickRaiser.raiseEvent(a)};jsgl.elements.AbstractElement.prototype.addDoubleClickListener=function(a){this.dblClickRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeDoubleClickListener=function(a){this.dblClickRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.raiseDoubleClick=function(a){this.dblClickRaiser.raiseEvent(a)};jsgl.elements.AbstractElement.prototype.addChangeListener=function(a){this.onChangeRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeChangeListener=function(a){this.onChangeRaiser.unregisterListener(a)};jsgl.elements.AbstractElement.prototype.setZIndex=function(a){this.zIndex=Number(a);this.zIndexChangeRaiser.raiseEvent();this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractElement.prototype.getZIndex=function(){return this.zIndex};jsgl.elements.AbstractElement.prototype.setCursor=function(a){this.cursor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractElement.prototype.getCursor=function(){return this.cursor};jsgl.elements.AbstractElement.prototype.addZIndexChangeListener=function(a){this.zIndexChangeRaiser.registerListener(a)};jsgl.elements.AbstractElement.prototype.removeZIndexChangeListener=function(a){this.zIndexChangeRaiser.unregisterListener(a)};jsgl.elements.AbstractDomPresenter=function(){this.graphicsElement=null;this.refreshTimer=null};jsgl.elements.AbstractDomPresenter.prototype.getGraphicsElement=function(){return this.graphicsElement};jsgl.elements.AbstractDomPresenter.prototype.setGraphicsElement=function(a){this.graphicsElement=a;this.getXmlElement().jsglElement=a;this.graphicsElement.addChangeListener(jsgl.util.delegate(this,this.invalidate))};jsgl.elements.AbstractDomPresenter.prototype.getXmlElement=function(){throw"getXmlElement(): not implemented"};jsgl.elements.AbstractDomPresenter.prototype.update=function(){this.getXmlElement().style.zIndex=this.getGraphicsElement().getZIndex();this.getXmlElement().style.cursor=this.getGraphicsElement().getCursor().asCSS};jsgl.elements.AbstractDomPresenter.prototype.invalidate=function(){if(!jsgl.IMMEDIATE_UPDATE==true){if(this.refreshTimer!=null){window.clearTimeout(this.refreshTimer)}this.refreshTimer=window.setTimeout(jsgl.util.delegate(this,this.update),0)}else{this.update()}};jsgl.elements.AbstractDomPresenter.prototype.attachMouseHandlers=function(a){a.onclick=jsgl.util.delegate(this,function(b){if(jsgl.util.BrowserInfo.usesWindowEvent){b=window.event}this.graphicsElement.raiseClick(jsgl.MouseEvent.fromJsglElement(b,this.graphicsElement,jsgl.MouseEvent.CLICK))});a.ondblclick=jsgl.util.delegate(this,function(b){if(jsgl.util.BrowserInfo.usesWindowEvent){b=window.event}this.graphicsElement.raiseDoubleClick(jsgl.MouseEvent.fromJsglElement(b,this.graphicsElement,jsgl.MouseEvent.DOUBLE_CLICK))});a.onmousedown=jsgl.util.delegate(this,function(b){if(jsgl.util.BrowserInfo.usesWindowEvent){b=window.event}this.graphicsElement.raiseMouseDown(jsgl.MouseEvent.fromJsglElement(b,this.graphicsElement,jsgl.MouseEvent.DOWN))});a.onmouseup=jsgl.util.delegate(this,function(b){if(jsgl.util.BrowserInfo.usesWindowEvent){b=window.event}this.graphicsElement.raiseMouseUp(jsgl.MouseEvent.fromJsglElement(b,this.graphicsElement,jsgl.MouseEvent.UP))});a.onmousemove=jsgl.util.delegate(this,function(b){if(jsgl.util.BrowserInfo.usesWindowEvent){b=window.event}this.graphicsElement.raiseMouseMove(jsgl.MouseEvent.fromJsglElement(b,this.graphicsElement,jsgl.MouseEvent.MOVE))});a.onmouseover=jsgl.util.delegate(this,function(b){if(jsgl.util.BrowserInfo.usesWindowEvent){b=window.event}this.graphicsElement.raiseMouseOver(jsgl.MouseEvent.fromJsglElement(b,this.graphicsElement,jsgl.MouseEvent.OVER))});a.onmouseout=jsgl.util.delegate(this,function(b){if(jsgl.util.BrowserInfo.usesWindowEvent){b=window.event}this.graphicsElement.raiseMouseOut(jsgl.MouseEvent.fromJsglElement(b,this.graphicsElement,jsgl.MouseEvent.OUT))})};jsgl.elements.DomSorter=function(a){this.domRoot=a;this.idToPosition={};this.posToElement={};this.idToZICL={};this.numElements=0;this.ageCounter=0};jsgl.elements.DomSorter.prototype.add=function(a){a.setAge(this.ageCounter++);this.domRoot.appendChild(a.getDomPresenter().getXmlElement());this.idToPosition[a.getUid()]=this.numElements;this.posToElement[this.numElements]=a;this.numElements++;var b=jsgl.util.delegate(this,function(){this.update(a)});a.addZIndexChangeListener(b);this.idToZICL[a.getUid()]=b;this.update(a)};jsgl.elements.DomSorter.prototype.remove=function(d){var c=d.getUid();d.setAge(-1);var a=this.idToPosition[c];for(var b=a;b<this.numElements-1;b++){this.posToElement[b]=this.posToElement[b+1];this.idToPosition[this.posToElement[b+1].getUid()]--}this.idToPosition[c]=null;this.posToElement[this.numElements-1]=null;d.removeZIndexChangeListener(this.idToZICL[c]);this.idToZICL[c]=null;this.domRoot.removeChild(d.getDomPresenter().getXmlElement());this.numElements--};jsgl.elements.DomSorter.prototype.update=function(c){if(!jsgl.util.BrowserInfo.supportsSvg){return}var d=this.idToPosition[c.getUid()];var b=d;var e;do{e=false;if(b!=this.numElements-1&&this.lessThan(this.posToElement[b+1],c)){b++;e=true}if(b!=0&&this.lessThan(c,this.posToElement[b-1])){b--;e=true}}while(e);if(d==b){return}this.domRoot.removeChild(c.getDomPresenter().getXmlElement());if(b<d){for(var a=d;a>b;a--){this.idToPosition[this.posToElement[a-1].getUid()]++;this.posToElement[a]=this.posToElement[a-1]}this.domRoot.insertBefore(c.getDomPresenter().getXmlElement(),this.domRoot.childNodes.item(b))}else{for(var a=d;a<b;a++){this.idToPosition[this.posToElement[a+1].getUid()]--;this.posToElement[a]=this.posToElement[a+1]}if(b!=this.numElements-1){this.domRoot.insertBefore(c.getDomPresenter().getXmlElement(),this.domRoot.childNodes.item(b))}else{this.domRoot.appendChild(c.getDomPresenter().getXmlElement())}}this.idToPosition[c.getUid()]=b;this.posToElement[b]=c};jsgl.elements.DomSorter.prototype.lessThan=function(b,a){if(b.getZIndex()==a.getZIndex()){return b.getAge()<a.getAge()}return b.getZIndex()<a.getZIndex()};jsgl.elements.GroupElement=function(c,b,a,e,d){jsgl.elements.AbstractElement.call(this,b,d);this.location=new jsgl.Vector2D(a,e);this.elements=new jsgl.util.ArrayList();this.domPresenter=c;this.domPresenter.setGraphicsElement(this);this.domSorter=new jsgl.elements.DomSorter(this.domPresenter.getXmlElement())};jsgl.elements.GroupElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.GroupElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.GroupElement.prototype.addElement=function(a){if(this.elements.contains(a)){return false}this.elements.add(a);this.domSorter.add(a);a.setContainer(this);a.getDomPresenter().update()};jsgl.elements.GroupElement.prototype.getElementAt=function(a){return this.elements.get(a)};jsgl.elements.GroupElement.prototype.getElementsCount=function(){return this.elements.getCount()};jsgl.elements.GroupElement.prototype.containsElement=function(a){return this.elements.contains(a)};jsgl.elements.GroupElement.prototype.removeElement=function(a){if(!this.elements.contains(a)){return false}this.elements.remove(a);this.domSorter.remove(a);a.setContainer(null)};jsgl.elements.GroupElement.prototype.removeAllElements=function(){this.clear()};jsgl.elements.GroupElement.prototype.clear=function(){var b;for(var a=this.elements.getCount()-1;a>=0;a--){b=this.elements.get(a);this.domSorter.remove(b);b.setContainer(null)}this.elements.clear()};jsgl.elements.GroupElement.prototype.getX=function(){return this.location.X};jsgl.elements.GroupElement.prototype.setX=function(a){this.location.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.GroupElement.prototype.getY=function(){return this.location.Y};jsgl.elements.GroupElement.prototype.setY=function(a){this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.GroupElement.prototype.setLocation=function(a){this.setLocationXY(a.X,a.Y)};jsgl.elements.GroupElement.prototype.setLocationXY=function(a,b){this.location=new jsgl.Vector2D(a,b);this.onChangeRaiser.raiseEvent()};jsgl.elements.GroupElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.SvgGroupDomPresenter=function(a){this.svgGroupElement=a.createElementNS("http://www.w3.org/2000/svg","g");this.attachMouseHandlers(this.svgGroupElement)};jsgl.elements.SvgGroupDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgGroupDomPresenter.prototype.getXmlElement=function(){return this.svgGroupElement};jsgl.elements.SvgGroupDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var a=this.graphicsElement.getLocation();this.svgGroupElement.setAttribute("transform","translate("+a.X+","+a.Y+")")};jsgl.elements.NonSvgGroupDomPresenter=function(a){this.divElement=a.createElement("div");this.divElement.style.position="absolute";this.divElement.style.width=this.divElement.style.height="0px";this.divElement.style.overflow="visible";this.attachMouseHandlers(this.divElement)};jsgl.elements.NonSvgGroupDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.NonSvgGroupDomPresenter.prototype.getXmlElement=function(){return this.divElement};jsgl.elements.NonSvgGroupDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);for(var b=0;b<this.graphicsElement.getElementsCount();b++){this.graphicsElement.getElementAt(b).getDomPresenter().update()}var a=this.graphicsElement.getLocation();this.divElement.style.left=a.X+"px";this.divElement.style.top=a.Y+"px"};jsgl.elements.CurveElement=function(b,a){jsgl.elements.AbstractElement.call(this,a);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.startPoint=new jsgl.Vector2D();this.control1Point=new jsgl.Vector2D();this.control2Point=new jsgl.Vector2D();this.endPoint=new jsgl.Vector2D();this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.fill.setEnabled(false);this.domPresenter=b;this.domPresenter.setGraphicsElement(this)};jsgl.elements.CurveElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.CurveElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.CurveElement.prototype.getStartX=function(){return this.startPoint.X};jsgl.elements.CurveElement.prototype.setStartX=function(a){this.startPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getStartY=function(){return this.startPoint.Y};jsgl.elements.CurveElement.prototype.setStartY=function(a){this.startPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getStartPoint=function(){return jsgl.cloneObject(this.startPoint)};jsgl.elements.CurveElement.prototype.setStartPoint=function(a){this.startPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setStartPointXY=function(b,a){this.startPoint.X=b;this.startPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl1X=function(){return this.control1Point.X};jsgl.elements.CurveElement.prototype.setControl1X=function(a){this.control1Point.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl1Y=function(){return this.control1Point.Y};jsgl.elements.CurveElement.prototype.setControl1Y=function(a){this.control1Point.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl1Point=function(){return jsgl.cloneObject(this.control1Point)};jsgl.elements.CurveElement.prototype.setControl1Point=function(a){this.control1Point=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setControl1PointXY=function(b,a){this.control1Point.X=b;this.control1Point.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl2X=function(){return this.control2Point.X};jsgl.elements.CurveElement.prototype.setControl2X=function(a){this.control2Point.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl2Y=function(){return this.control2Point.Y};jsgl.elements.CurveElement.prototype.setControl2Y=function(a){this.control2Point.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getControl2Point=function(){return jsgl.cloneObject(this.control2Point)};jsgl.elements.CurveElement.prototype.setControl2Point=function(a){this.control2Point=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setControl2PointXY=function(b,a){this.control2Point.X=b;this.control2Point.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getEndX=function(){return this.endPoint.X};jsgl.elements.CurveElement.prototype.setEndX=function(a){this.endPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getEndY=function(){return this.endPoint.Y};jsgl.elements.CurveElement.prototype.setEndY=function(a){this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.elements.CurveElement.prototype.setEndPoint=function(a){this.endPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.setEndPointXY=function(b,a){this.endPoint.X=b;this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.CurveElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.CurveElement.prototype.getFill=function(){return this.fill};jsgl.elements.CurveElement.prototype.setFill=function(a){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=a;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgCurveDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.svgPathElement=a.createElementNS("http://www.w3.org/2000/svg","path");this.attachMouseHandlers(this.svgPathElement)};jsgl.elements.SvgCurveDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgCurveDomPresenter.prototype.getXmlElement=function(){return this.svgPathElement};jsgl.elements.SvgCurveDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.svgPathElement.setAttribute("d","M"+this.graphicsElement.getStartX()+","+this.graphicsElement.getStartY()+"C"+this.graphicsElement.getControl1X()+","+this.graphicsElement.getControl1Y()+","+this.graphicsElement.getControl2X()+","+this.graphicsElement.getControl2Y()+","+this.graphicsElement.getEndX()+","+this.graphicsElement.getEndY());this.graphicsElement.getStroke().applyToSvgElement(this.svgPathElement);this.graphicsElement.getFill().applyToSvgElement(this.svgPathElement)};jsgl.elements.VmlCurveDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.vmlCurveElement=a.createElement("vml:curve");this.vmlCurveElement.style.position="absolute";this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlCurveElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=a.createElement("vml:fill");this.vmlCurveElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlCurveElement)};jsgl.elements.VmlCurveDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlCurveDomPresenter.prototype.getXmlElement=function(){return this.vmlCurveElement};jsgl.elements.VmlCurveDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlCurveDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlCurveDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.vmlCurveElement.from=this.graphicsElement.getStartPoint().toString();this.vmlCurveElement.control1=this.graphicsElement.getControl1Point().toString();this.vmlCurveElement.control2=this.graphicsElement.getControl2Point().toString();this.vmlCurveElement.to=this.graphicsElement.getEndPoint().toString();this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.CircleElement=function(b,a){jsgl.elements.AbstractElement.call(this,a);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.centerLocation=new jsgl.Vector2D();this.radius=0;this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=b;this.domPresenter.setGraphicsElement(this)};jsgl.elements.CircleElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.CircleElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.CircleElement.prototype.getCenterX=function(){return this.centerLocation.X};jsgl.elements.CircleElement.prototype.setCenterX=function(a){this.centerLocation.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getCenterY=function(){return this.centerLocation.Y};jsgl.elements.CircleElement.prototype.setCenterY=function(a){this.centerLocation.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getCenterLocation=function(){return jsgl.cloneObject(this.centerLocation)};jsgl.elements.CircleElement.prototype.setCenterLocation=function(a){this.centerLocation=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.setCenterLocationXY=function(a,b){this.centerLocation.X=a;this.centerLocation.Y=b;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getRadius=function(){return this.radius};jsgl.elements.CircleElement.prototype.setRadius=function(a){this.radius=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.CircleElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.CircleElement.prototype.getFill=function(){return this.fill};jsgl.elements.CircleElement.prototype.setFill=function(a){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=a;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgCircleDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.svgCircleElement=a.createElementNS("http://www.w3.org/2000/svg","circle");this.attachMouseHandlers(this.svgCircleElement)};jsgl.elements.SvgCircleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgCircleDomPresenter.prototype.getXmlElement=function(){return this.svgCircleElement};jsgl.elements.SvgCircleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var b=this.graphicsElement.getCenterLocation(),a=this.graphicsElement.getRadius();this.svgCircleElement.setAttribute("cx",b.X);this.svgCircleElement.setAttribute("cy",b.Y);this.svgCircleElement.setAttribute("r",a);this.graphicsElement.getStroke().applyToSvgElement(this.svgCircleElement);this.graphicsElement.getFill().applyToSvgElement(this.svgCircleElement)};jsgl.elements.VmlCircleDomPresenter=function(a){this.vmlElement=a.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=a.createElement("vml:fill");this.vmlElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlCircleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlCircleDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlCircleDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlCircleDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlCircleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var b=this.graphicsElement.getCenterLocation(),a=this.graphicsElement.getRadius();this.vmlElement.style.left=(b.X-a)+"px";this.vmlElement.style.top=(b.Y-a)+"px";this.vmlElement.style.width=this.vmlElement.style.height=2*a+"px";this.vmlElement.coordsize=20*a+" "+20*a;this.vmlElement.path="m"+Math.round(20*a)+" "+Math.round(10*a)+"qy"+Math.round(10*a)+" "+Math.round(20*a)+"qx0 "+Math.round(10*a)+"qy"+Math.round(10*a)+" 0qx"+Math.round(20*a)+" "+Math.round(10*a)+"xe";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.EllipseElement=function(b,a){jsgl.elements.AbstractElement.call(this,a);this.centerLocation=new jsgl.Vector2D();this.size=new jsgl.Vector2D();this.rotation=0;this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=b;this.domPresenter.setGraphicsElement(this)};jsgl.elements.EllipseElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.EllipseElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.EllipseElement.prototype.getCenterX=function(){return this.centerLocation.X};jsgl.elements.EllipseElement.prototype.setCenterX=function(a){this.centerLocation.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getCenterY=function(){return this.centerLocation.Y};jsgl.elements.EllipseElement.prototype.setCenterY=function(a){this.centerLocation.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getCenterLocation=function(){return jsgl.cloneObject(this.centerLocation)};jsgl.elements.EllipseElement.prototype.setCenterLocation=function(a){this.centerLocation=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.setCenterLocationXY=function(a,b){this.centerLocation.X=a;this.centerLocation.Y=b;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getWidth=function(){return this.size.X};jsgl.elements.EllipseElement.prototype.setWidth=function(a){this.size.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getHeight=function(){return this.size.Y};jsgl.elements.EllipseElement.prototype.setHeight=function(a){this.size.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getSize=function(){return jsgl.cloneObject(this.size)};jsgl.elements.EllipseElement.prototype.setSize=function(a){this.size=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.setSizeWH=function(b,a){this.size=new jsgl.Vector2D(b,a);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getRotation=function(){return this.rotation};jsgl.elements.EllipseElement.prototype.setRotation=function(a){this.rotation=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.EllipseElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.EllipseElement.prototype.getFill=function(){return this.fill};jsgl.elements.EllipseElement.prototype.setFill=function(a){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=a;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgEllipseDomPresenter=function(a){this.svgEllipseElement=a.createElementNS("http://www.w3.org/2000/svg","ellipse");this.attachMouseHandlers(this.svgEllipseElement)};jsgl.elements.SvgEllipseDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgEllipseDomPresenter.prototype.getXmlElement=function(){return this.svgEllipseElement};jsgl.elements.SvgEllipseDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var a=this.graphicsElement.getCenterLocation();this.svgEllipseElement.setAttribute("cx",a.X);this.svgEllipseElement.setAttribute("cy",a.Y);this.svgEllipseElement.setAttribute("rx",this.graphicsElement.getWidth()/2);this.svgEllipseElement.setAttribute("ry",this.graphicsElement.getHeight()/2);this.svgEllipseElement.setAttribute("transform","rotate("+this.graphicsElement.getRotation()+" "+a.X+" "+a.Y+")");this.graphicsElement.getStroke().applyToSvgElement(this.svgEllipseElement);this.graphicsElement.getFill().applyToSvgElement(this.svgEllipseElement)};jsgl.elements.VmlEllipseDomPresenter=function(a){this.vmlElement=a.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlFillElement=a.createElement("vml:fill");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlEllipseDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlEllipseDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlEllipseDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlEllipseDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlEllipseDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var a=this.graphicsElement.getCenterLocation(),b=this.graphicsElement.getSize();this.vmlElement.style.left=(a.X-b.X/2);this.vmlElement.style.top=(a.Y-b.Y/2);this.vmlElement.style.width=b.X+"px";this.vmlElement.style.height=b.Y+"px";this.vmlElement.style.rotation=this.graphicsElement.getRotation();this.vmlElement.coordsize=10*b.X+" "+10*b.Y;this.vmlElement.path="m"+Math.round(10*b.X)+" "+Math.round(5*b.Y)+"qy"+Math.round(5*b.X)+" "+Math.round(10*b.Y)+"qx0 "+Math.round(5*b.Y)+"qy"+Math.round(5*b.X)+" 0qx"+Math.round(10*b.X)+" "+Math.round(5*b.Y)+"xe";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.RectangleElement=function(b,a){jsgl.elements.AbstractElement.call(this,a);this.location=new jsgl.Vector2D();this.size=new jsgl.Vector2D();this.horizontalAnchor=jsgl.HorizontalAnchor.LEFT;this.verticalAnchor=jsgl.VerticalAnchor.TOP;this.rotation=0;this.roundingRadii=new jsgl.Vector2D();this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=b;this.domPresenter.setGraphicsElement(this)};jsgl.elements.RectangleElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.RectangleElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.RectangleElement.prototype.getX=function(){return this.location.X};jsgl.elements.RectangleElement.prototype.setX=function(a){this.location.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getY=function(){return this.location.Y};jsgl.elements.RectangleElement.prototype.setY=function(a){this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.RectangleElement.prototype.setLocation=function(a){this.location=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.setLocationXY=function(b,a){this.location.X=b;this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getWidth=function(){return this.size.X};jsgl.elements.RectangleElement.prototype.setWidth=function(a){this.size.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getHeight=function(){return this.size.Y};jsgl.elements.RectangleElement.prototype.setHeight=function(a){this.size.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getSize=function(){return jsgl.cloneObject(this.size)};jsgl.elements.RectangleElement.prototype.setSize=function(a){this.size=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.setSizeWH=function(b,a){this.size.X=b;this.size.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getRotation=function(){return this.rotation};jsgl.elements.RectangleElement.prototype.setRotation=function(a){this.rotation=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getHorizontalAnchor=function(){return this.horizontalAnchor};jsgl.elements.RectangleElement.prototype.setHorizontalAnchor=function(a){this.horizontalAnchor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getVerticalAnchor=function(){return this.verticalAnchor};jsgl.elements.RectangleElement.prototype.setVerticalAnchor=function(a){this.verticalAnchor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getXRadius=function(){return this.roundingRadii.X};jsgl.elements.RectangleElement.prototype.setXRadius=function(a){this.roundingRadii.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getYRadius=function(){return this.roundingRadii.Y};jsgl.elements.RectangleElement.prototype.setYRadius=function(a){this.roundingRadii.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getRadii=function(){return jsgl.cloneObject(this.roundingRadii)};jsgl.elements.RectangleElement.prototype.setRadii=function(a){this.roundingRadii=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.setRadiiXY=function(a,b){this.roundingRadii.X=a;this.roundingRadii.Y=b;this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.RectangleElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.RectangleElement.prototype.getFill=function(){return this.fill};jsgl.elements.RectangleElement.prototype.setFill=function(a){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=a;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgRectangleDomPresenter=function(a){this.svgRectElement=a.createElementNS("http://www.w3.org/2000/svg","rect");this.attachMouseHandlers(this.svgRectElement)};jsgl.elements.SvgRectangleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgRectangleDomPresenter.prototype.getXmlElement=function(){return this.svgRectElement};jsgl.elements.SvgRectangleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var b=this.graphicsElement.getLocation(),c=this.graphicsElement.getSize(),d=this.graphicsElement.getRadii();var a,e;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:a=b.X;break;case jsgl.HorizontalAnchor.CENTER:a=b.X-c.X/2;break;case jsgl.HorizontalAnchor.RIGHT:a=b.X-c.X;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:e=b.Y;break;case jsgl.VerticalAnchor.MIDDLE:e=b.Y-c.Y/2;break;case jsgl.VerticalAnchor.BOTTOM:e=b.Y-c.Y;break}this.svgRectElement.setAttribute("x",a);this.svgRectElement.setAttribute("y",e);this.svgRectElement.setAttribute("width",c.X);this.svgRectElement.setAttribute("height",c.Y);this.svgRectElement.setAttribute("rx",d.X);this.svgRectElement.setAttribute("ry",d.Y);this.svgRectElement.setAttribute("transform","rotate("+this.graphicsElement.getRotation()+","+b.X+","+b.Y+")");this.graphicsElement.getStroke().applyToSvgElement(this.svgRectElement);this.graphicsElement.getFill().applyToSvgElement(this.svgRectElement)};jsgl.elements.VmlRectangleDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.vmlShapeElement=document.createElement("vml:shape");this.vmlShapeElement.style.position="absolute";this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlShapeElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=a.createElement("vml:fill");this.vmlShapeElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlShapeElement)};jsgl.elements.VmlRectangleDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlRectangleDomPresenter.prototype.getXmlElement=function(){return this.vmlShapeElement};jsgl.elements.VmlRectangleDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlRectangleDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlRectangleDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var m=this.graphicsElement.getSize(),e=new jsgl.Vector2D(Math.min(this.graphicsElement.getXRadius(),m.X/2),Math.min(this.graphicsElement.getYRadius(),m.Y/2)),h=this.graphicsElement.getLocation();var f=Math.PI*this.graphicsElement.getRotation()/180;var n,k;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:n=h.X+m.X/2;break;case jsgl.HorizontalAnchor.CENTER:n=h.X;break;case jsgl.HorizontalAnchor.RIGHT:n=h.X-m.X/2;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:k=h.Y+m.Y/2;break;case jsgl.VerticalAnchor.MIDDLE:k=h.Y;break;case jsgl.VerticalAnchor.BOTTOM:k=h.Y-m.Y/2;break}var j=Math.atan2(k-h.Y,n-h.X);var g=jsgl.Vector2D.getDistance(h,new jsgl.Vector2D(n,k));var c=h.X+Math.cos(j+f)*g;var b=h.Y+Math.sin(j+f)*g;this.vmlShapeElement.style.left=c-m.X/2;this.vmlShapeElement.style.top=b-m.Y/2;this.vmlShapeElement.coordsize=m.X.jsglVmlize()+" "+m.Y.jsglVmlize();this.vmlShapeElement.style.width=m.X;this.vmlShapeElement.style.height=m.Y;var a=e.X>0&&e.Y>0;var l="m"+e.X.jsglVmlize()+",0";l+="l"+(m.X-(a?e.X:0)).jsglVmlize()+",0";if(a){l+="qx"+m.X.jsglVmlize()+","+e.Y.jsglVmlize()}l+="l"+m.X.jsglVmlize()+","+(m.Y-(a?e.Y:0)).jsglVmlize();if(a){l+="qy"+(m.X-e.X).jsglVmlize()+","+m.Y.jsglVmlize()}l+="l"+e.X.jsglVmlize()+","+m.Y.jsglVmlize();if(a){l+="qx0,"+(m.Y-e.Y).jsglVmlize()}l+="l0,"+e.Y.jsglVmlize();if(a){l+="qy"+e.X.jsglVmlize()+",0"}l+="ex";this.vmlShapeElement.rotation=this.graphicsElement.getRotation();this.vmlShapeElement.path=l;this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.LineElement=function(g,a,c,e,b,d,f,h){jsgl.elements.AbstractElement.call(this,a,h);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.startPoint=new jsgl.Vector2D(c,e);this.endPoint=new jsgl.Vector2D(b,d);this.stroke=null;this.setStroke(f||new jsgl.stroke.SolidStroke());this.domPresenter=g;this.domPresenter.setGraphicsElement(this)};jsgl.elements.LineElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.LineElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.LineElement.prototype.getStartX=function(){return this.startPoint.X};jsgl.elements.LineElement.prototype.setStartX=function(a){this.startPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getStartY=function(){return this.startPoint.Y};jsgl.elements.LineElement.prototype.setStartY=function(a){this.startPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getStartPoint=function(){return jsgl.cloneObject(this.startPoint)};jsgl.elements.LineElement.prototype.setStartPoint=function(a){this.setStartPointXY(a.X,a.Y)};jsgl.elements.LineElement.prototype.setStartPointXY=function(b,a){this.startPoint.X=b;this.startPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getEndX=function(){return this.endPoint.X};jsgl.elements.LineElement.prototype.setEndX=function(a){this.endPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getEndY=function(){return this.endPoint.Y};jsgl.elements.LineElement.prototype.setEndY=function(a){this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.elements.LineElement.prototype.setEndPoint=function(a){this.setEndPointXY(a.X,a.Y)};jsgl.elements.LineElement.prototype.setEndPointXY=function(b,a){this.endPoint.X=b;this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LineElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.LineElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgLineDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.svgLineElement=a.createElementNS("http://www.w3.org/2000/svg","line");this.attachMouseHandlers(this.svgLineElement)};jsgl.elements.SvgLineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgLineDomPresenter.prototype.getXmlElement=function(){return this.svgLineElement};jsgl.elements.SvgLineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.svgLineElement.setAttribute("x1",this.graphicsElement.getStartX());this.svgLineElement.setAttribute("y1",this.graphicsElement.getStartY());this.svgLineElement.setAttribute("x2",this.graphicsElement.getEndX());this.svgLineElement.setAttribute("y2",this.graphicsElement.getEndY());this.graphicsElement.getStroke().applyToSvgElement(this.svgLineElement)};jsgl.elements.VmlLineDomPresenter=function(a){this.vmlElement=a.createElement("vml:line");this.vmlElement.style.position="absolute";this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlLineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlLineDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlLineDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlLineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.vmlElement.from=this.graphicsElement.getStartPoint().toString();this.vmlElement.to=this.graphicsElement.getEndPoint().toString();this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement)};jsgl.elements.LabelElement=function(c,b,a,f,d,e){jsgl.elements.AbstractElement.call(this,b,e);this.location=new jsgl.Vector2D(a,f);this.text=d||"";this.fontFamily="sans-serif";this.fontSize=12;this.fontColor="black";this.underlined=false;this.overlined=false;this.struckThrough=false;this.bold=false;this.italic=false;this.horizontalAnchor=jsgl.HorizontalAnchor.LEFT;this.verticalAnchor=jsgl.VerticalAnchor.TOP;this.opacity=1;this.domPresenter=c;this.domPresenter.setGraphicsElement(this)};jsgl.elements.LabelElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.LabelElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.LabelElement.prototype.getX=function(){return this.location.X};jsgl.elements.LabelElement.prototype.setX=function(a){this.location.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getY=function(){return this.location.Y};jsgl.elements.LabelElement.prototype.setY=function(a){this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.LabelElement.prototype.setLocation=function(a){this.setLocationXY(a.X,a.Y)};jsgl.elements.LabelElement.prototype.setLocationXY=function(b,a){this.location.X=b;this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getHorizontalAnchor=function(){return this.horizontalAnchor};jsgl.elements.LabelElement.prototype.setHorizontalAnchor=function(a){this.horizontalAnchor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getVerticalAnchor=function(){return this.verticalAnchor};jsgl.elements.LabelElement.prototype.setVerticalAnchor=function(a){this.verticalAnchor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getText=function(){return this.text};jsgl.elements.LabelElement.prototype.setText=function(a){this.text=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getFontFamily=function(){return this.fontFamily};jsgl.elements.LabelElement.prototype.setFontFamily=function(a){this.fontFamily=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getFontSize=function(){return this.fontSize};jsgl.elements.LabelElement.prototype.setFontSize=function(a){this.fontSize=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getFontColor=function(){return this.fontColor};jsgl.elements.LabelElement.prototype.setFontColor=function(a){this.fontColor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getUnderlined=function(){return this.underlined};jsgl.elements.LabelElement.prototype.isUnderlined=jsgl.elements.LabelElement.prototype.getUnderlined;jsgl.elements.LabelElement.prototype.setUnderlined=function(a){this.underlined=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getOverlined=function(){return this.overlined};jsgl.elements.LabelElement.prototype.isOverlined=jsgl.elements.LabelElement.prototype.getOverlined;jsgl.elements.LabelElement.prototype.setOverlined=function(a){this.overlined=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getStruckThrough=function(){return this.struckThrough};jsgl.elements.LabelElement.prototype.isStruckThrough=jsgl.elements.LabelElement.prototype.getStruckThrough;jsgl.elements.LabelElement.prototype.setStruckThrough=function(a){this.struckThrough=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getBold=function(){return this.bold};jsgl.elements.LabelElement.prototype.isBold=jsgl.elements.LabelElement.prototype.getBold();jsgl.elements.LabelElement.prototype.setBold=function(a){this.bold=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getItalics=function(){return this.italics};jsgl.elements.LabelElement.prototype.isItalics=jsgl.elements.LabelElement.getItalics;jsgl.elements.LabelElement.prototype.setItalics=function(a){this.italics=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.LabelElement.prototype.getOpacity=function(){return this.opacity};jsgl.elements.LabelElement.prototype.setOpacity=function(a){this.opacity=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgLabelDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.svgTextElement=a.createElementNS("http://www.w3.org/2000/svg","text");this.textNode=a.createTextNode("");this.svgTextElement.appendChild(this.textNode);this.attachMouseHandlers(this.svgTextElement)};jsgl.elements.SvgLabelDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgLabelDomPresenter.prototype.getXmlElement=function(){return this.svgTextElement};jsgl.elements.SvgLabelDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.textNode.nodeValue=this.graphicsElement.getText();this.svgTextElement.style.setProperty("font-family",this.graphicsElement.getFontFamily(),null);this.svgTextElement.style.setProperty("fill",this.graphicsElement.getFontColor(),null);var c=this.graphicsElement.getUnderlined(),b=this.graphicsElement.getOverlined(),d=this.graphicsElement.getStruckThrough(),a="";if(c){a="underline"}if(b){if(a){a+=" overline"}else{a="overline"}}if(d){if(a){a+=" line-through"}else{a="line-through"}}this.svgTextElement.style.fontSize=this.graphicsElement.getFontSize()+"px";this.svgTextElement.style.textDecoration=a;this.svgTextElement.style.fontWeight=this.graphicsElement.getBold()?"bold":"normal";this.svgTextElement.style.fontStyle=this.graphicsElement.getItalics()?"italic":"normal";this.svgTextElement.style.opacity=this.graphicsElement.getOpacity();switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:this.svgTextElement.style.setProperty("text-anchor","start",null);break;case jsgl.HorizontalAnchor.CENTER:this.svgTextElement.style.setProperty("text-anchor","middle",null);break;case jsgl.HorizontalAnchor.RIGHT:this.svgTextElement.style.setProperty("text-anchor","end",null);break}this.svgTextElement.setAttribute("x",this.graphicsElement.getX());switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:this.svgTextElement.setAttribute("dy","1em",null);break;case jsgl.VerticalAnchor.MIDDLE:this.svgTextElement.setAttribute("dy","0.6ex",null);break;case jsgl.VerticalAnchor.BOTTOM:this.svgTextElement.setAttribute("dy","0em",null);break}this.svgTextElement.setAttribute("y",this.graphicsElement.getY())};jsgl.elements.NonSvgLabelDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.spanElement=a.createElement("nobr");this.spanTextNode=a.createTextNode("");this.spanElement.appendChild(this.spanTextNode);this.spanElement.style.position="absolute";this.attachMouseHandlers(this.spanElement)};jsgl.elements.NonSvgLabelDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.NonSvgLabelDomPresenter.prototype.getXmlElement=function(){return this.spanElement};jsgl.elements.NonSvgLabelDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);this.spanTextNode.nodeValue=this.graphicsElement.getText();this.spanElement.style.fontFamily=this.graphicsElement.getFontFamily();this.spanElement.style.color=this.graphicsElement.getFontColor();var c=this.graphicsElement.getUnderlined(),b=this.graphicsElement.getOverlined(),d=this.graphicsElement.getStruckThrough(),a="";if(c){a="underline"}if(b){if(a){a+=" overline"}else{a="overline"}}if(d){if(a){a+=" line-through"}else{a="line-through"}}this.spanElement.style.fontSize=this.graphicsElement.getFontSize()+"px";this.spanElement.style.textDecoration=a;this.spanElement.style.fontWeight=this.graphicsElement.getBold()?"bold":"normal";this.spanElement.style.fontStyle=this.graphicsElement.getItalics()?"italic":"normal";if(jsgl.util.BrowserInfo.isMSIElte7){if(this.graphicsElement.getOpacity()!=1){this.spanElement.style.filter="alpha(opacity="+Math.round(100*this.graphicsElement.getOpacity())+")"}else{this.spanElement.style.filter=""}}else{this.spanElement.style.opacity=this.graphicsElement.getOpacity()}switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:this.spanElement.style.left=this.graphicsElement.getX()+"px";break;case jsgl.HorizontalAnchor.RIGHT:this.spanElement.style.left=(this.graphicsElement.getX()-this.spanElement.clientWidth)+"px";break;case jsgl.HorizontalAnchor.CENTER:this.spanElement.style.left=(this.graphicsElement.getX()-this.spanElement.clientWidth/2)+"px";break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:this.spanElement.style.top=this.graphicsElement.getY()+"px";break;case jsgl.VerticalAnchor.BOTTOM:this.spanElement.style.top=(this.graphicsElement.getY()-this.spanElement.clientHeight)+"px";break;case jsgl.VerticalAnchor.MIDDLE:this.spanElement.style.top=(this.graphicsElement.getY()-this.spanElement.clientHeight/2)+"px";break}};jsgl.elements.AbstractPolygonalElement=function(a,b){jsgl.elements.AbstractElement.call(this,a,b);this.points=new jsgl.util.ArrayList()};jsgl.elements.AbstractPolygonalElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.AbstractPolygonalElement.prototype.addPoint=function(a){this.addPointXY(a.X,a.Y)};jsgl.elements.AbstractPolygonalElement.prototype.addPointXY=function(a,b){this.points.add(new jsgl.Vector2D(a,b));this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.clearPoints=function(){this.points.clear();this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.getPointAt=function(a){return jsgl.cloneObject(this.points.get(a))};jsgl.elements.AbstractPolygonalElement.prototype.setPointXYAt=function(b,d,c){var a=this.points.get(c);a.X=b;a.Y=d;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.setPointAt=function(a,b){this.setPointXYAt(a.X,a.Y,b)};jsgl.elements.AbstractPolygonalElement.prototype.getPointsCount=function(){return this.points.getCount()};jsgl.elements.AbstractPolygonalElement.prototype.insertPointAt=function(a,b){this.insertPointXYAt(a.X,a.Y,b)};jsgl.elements.AbstractPolygonalElement.prototype.insertPointXYAt=function(a,c,b){this.points.insertAt(new jsgl.Vector2D(a,c),b);this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractPolygonalElement.prototype.removePointAt=function(a){this.points.removeAt(a);this.onChangeRaiser.raiseEvent()};jsgl.elements.PolygonElement=function(d,a,c,b,e){jsgl.elements.AbstractPolygonalElement.call(this,a,e);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(c||new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(b||new jsgl.fill.SolidFill());this.domPresenter=d;this.domPresenter.setGraphicsElement(this)};jsgl.elements.PolygonElement.jsglExtend(jsgl.elements.AbstractPolygonalElement);jsgl.elements.PolygonElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.PolygonElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.PolygonElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.PolygonElement.prototype.getFill=function(){return this.fill};jsgl.elements.PolygonElement.prototype.setFill=function(a){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=a;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgPolygonDomPresenter=function(a){this.svgPolygonElement=a.createElementNS("http://www.w3.org/2000/svg","polygon");this.attachMouseHandlers(this.svgPolygonElement)};jsgl.elements.SvgPolygonDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgPolygonDomPresenter.prototype.getXmlElement=function(){return this.svgPolygonElement};jsgl.elements.SvgPolygonDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var c=this.graphicsElement.getPointsCount();if(c<2){this.svgPolygonElement.setAttribute("points","");return}var a=(this.graphicsElement.getPointAt(0).X)+","+(this.graphicsElement.getPointAt(0).Y);for(var b=1;b<c;b++){a+=" "+(this.graphicsElement.getPointAt(b).X)+","+(this.graphicsElement.getPointAt(b).Y)}this.svgPolygonElement.setAttribute("points",a);this.graphicsElement.getStroke().applyToSvgElement(this.svgPolygonElement);this.graphicsElement.getFill().applyToSvgElement(this.svgPolygonElement)};jsgl.elements.VmlPolygonDomPresenter=function(a){this.vmlElement=a.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=a.createElement("vml:fill");this.vmlElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlPolygonDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlPolygonDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlPolygonDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlPolygonDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlPolygonDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var e=this.graphicsElement.getPointsCount();if(e<2){this.vmlElement.path="";this.vmlElement.style.width=this.vmlElement.style.height="0px";return}var h=this.graphicsElement.getPointAt(0);var g=h.X,d=h.X,f=h.Y,b=h.Y,a="M"+h.X.jsglVmlize()+" "+h.Y.jsglVmlize();for(var c=0;c<e;c++){h=this.graphicsElement.getPointAt(c);if(g>h.X){g=h.X}if(d<h.X){d=h.X}if(f>h.Y){f=h.Y}if(b<h.Y){b=h.Y}a+="l"+h.X.jsglVmlize()+" "+h.Y.jsglVmlize()}a+="xe";this.vmlElement.coordsize=(d-g).jsglVmlize()+" "+(b-f).jsglVmlize();this.vmlElement.setAttribute("path",a);this.vmlElement.style.width=(d-g)+"px";this.vmlElement.style.height=(b-f)+"px";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.elements.PolylineElement=function(c,a,b,d){jsgl.elements.AbstractPolygonalElement.call(this,a,d);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(b||new jsgl.stroke.SolidStroke());this.domPresenter=c;this.domPresenter.setGraphicsElement(this)};jsgl.elements.PolylineElement.jsglExtend(jsgl.elements.AbstractPolygonalElement);jsgl.elements.PolylineElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.PolylineElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.PolylineElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgPolylineDomPresenter=function(a){this.svgPolylineElement=a.createElementNS("http://www.w3.org/2000/svg","polyline");this.svgPolylineElement.style.setProperty("fill","none",null);this.attachMouseHandlers(this.svgPolylineElement)};jsgl.elements.SvgPolylineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgPolylineDomPresenter.prototype.getXmlElement=function(){return this.svgPolylineElement};jsgl.elements.SvgPolylineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var c=this.graphicsElement.getPointsCount();if(c==0){this.svgPolylineElement.setAttribute("points","");return}var a=(this.graphicsElement.getPointAt(0).X)+","+(this.graphicsElement.getPointAt(0).Y);for(var b=1;b<c;b++){a+=" "+(this.graphicsElement.getPointAt(b).X)+","+(this.graphicsElement.getPointAt(b).Y)}this.svgPolylineElement.setAttribute("points",a);this.graphicsElement.getStroke().applyToSvgElement(this.svgPolylineElement)};jsgl.elements.VmlPolylineDomPresenter=function(a){this.vmlElement=a.createElement("vml:shape");this.vmlElement.style.position="absolute";this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlElement.appendChild(this.vmlStrokeElement);this.vmlElement.filled="no";this.attachMouseHandlers(this.vmlElement)};jsgl.elements.VmlPolylineDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlPolylineDomPresenter.prototype.getXmlElement=function(){return this.vmlElement};jsgl.elements.VmlPolylineDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlPolylineDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var e=this.graphicsElement.getPointsCount();if(e<2){this.vmlElement.path="";this.vmlElement.style.width=this.vmlElement.style.height="0px";return}var h=this.graphicsElement.getPointAt(0);var g=h.X,d=h.X,f=h.Y,b=h.Y,a="m"+Math.round(h.X)+" "+Math.round(h.Y);for(var c=0;c<e;c++){h=this.graphicsElement.getPointAt(c);if(g>h.X){g=h.X}if(d<h.X){d=h.X}if(f>h.Y){f=h.Y}if(b<h.Y){b=h.Y}a+="l"+Math.round(h.X)+","+Math.round(h.Y)}a+="e";this.vmlElement.setAttribute("path",a);this.vmlElement.coordsize=(d-g)*100+" "+(b-f)*100;this.vmlElement.style.width=(d-g)*100+"px";this.vmlElement.style.height=(b-f)*100+"px";this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement)};jsgl.elements.ImageElement=function(b,a){jsgl.elements.AbstractElement.call(this,a);this.location=new jsgl.Vector2D();this.size=new jsgl.Vector2D();this.horizontalAnchor=jsgl.HorizontalAnchor.LEFT;this.verticalAnchor=jsgl.VerticalAnchor.TOP;this.autosizeX=true;this.autosizeY=true;this.rotation=0;this.opacity=1;this.url="";this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.stroke.setEnabled(false);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.domPresenter=b;this.domPresenter.setGraphicsElement(this)};jsgl.elements.ImageElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.ImageElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.ImageElement.prototype.getX=function(){return this.location.X};jsgl.elements.ImageElement.prototype.setX=function(a){this.location.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getY=function(){return this.location.Y};jsgl.elements.ImageElement.prototype.setY=function(a){this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.elements.ImageElement.prototype.setLocation=function(a){this.setlLcationXY(a.X,a.Y)};jsgl.elements.ImageElement.prototype.setLocationXY=function(b,a){this.location.X=b;this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getWidth=function(){return this.autosizeX?this.domPresenter.getImageSize().X:this.size.X};jsgl.elements.ImageElement.prototype.setWidth=function(a){this.autosizeX=false;this.size.X=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getHeight=function(){return this.autosizeY?this.domPresenter.getImageSize().Y:this.size.Y};jsgl.elements.ImageElement.prototype.setHeight=function(a){this.autosizeY=false;this.size.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getSize=function(){return new jsgl.Vector2D(this.autosizeX?this.domPresenter.getImageSize().X:this.size.X,this.autosizeY?this.domPresenter.getImageSize().Y:this.size.Y)};jsgl.elements.ImageElement.prototype.setSize=function(a){this.setSizeWH(a.X,a.Y)};jsgl.elements.ImageElement.prototype.setSizeWH=function(b,a){this.autosizeX=false;this.autosizeY=false;this.size.X=b;this.size.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getOpacity=function(){return this.opacity};jsgl.elements.ImageElement.prototype.setOpacity=function(a){this.opacity=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getRotation=function(){return this.rotation};jsgl.elements.ImageElement.prototype.setRotation=function(a){this.rotation=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getHorizontalAnchor=function(){return this.horizontalAnchor};jsgl.elements.ImageElement.prototype.setHorizontalAnchor=function(a){this.horizontalAnchor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getVerticalAnchor=function(){return this.verticalAnchor};jsgl.elements.ImageElement.prototype.setVerticalAnchor=function(a){this.verticalAnchor=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getUrl=function(){return this.url};jsgl.elements.ImageElement.prototype.setUrl=function(a){this.url=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.ImageElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.ImageElement.prototype.setStroke=function(a){this.stroke=a;this.onChangeRaiser.raiseEvent()};jsgl.elements.AbstractImageDomPresenter=function(){this.loadedUrl=null;this.isLoaded=false;this.image=null};jsgl.elements.AbstractImageDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.AbstractImageDomPresenter.prototype.loadUrl=function(a){if(this.loadedUrl!=a){this.loadedUrl=a;this.imageLoaded=false;this.image=new Image();this.image.src=a;this.image.onload=jsgl.util.delegate(this,function(){this.isLoaded=true})}};jsgl.elements.AbstractImageDomPresenter.prototype.getImageSize=function(){if(this.isLoaded){return new jsgl.Vector2D(this.image.width,this.image.height)}return new jsgl.Vector2D()};jsgl.elements.SvgImageDomPresenter=function(a){jsgl.elements.AbstractImageDomPresenter.call(this);this.svgGElement=a.createElementNS("http://www.w3.org/2000/svg","g");this.svgImageElement=a.createElementNS("http://www.w3.org/2000/svg","image");this.svgImageElement.setAttribute("preserveAspectRatio","none");this.svgGElement.appendChild(this.svgImageElement);this.svgRectElement=a.createElementNS("http://www.w3.org/2000/svg","rect");this.svgRectElement.style.setProperty("fill","none",null);this.svgGElement.appendChild(this.svgRectElement);this.attachMouseHandlers(this.svgGElement)};jsgl.elements.SvgImageDomPresenter.jsglExtend(jsgl.elements.AbstractImageDomPresenter);jsgl.elements.SvgImageDomPresenter.prototype.getXmlElement=function(){return this.svgGElement};jsgl.elements.SvgImageDomPresenter.prototype.update=function(){this.loadUrl(this.graphicsElement.getUrl());if(!this.isLoaded){window.setTimeout(jsgl.util.delegate(this,this.update),50);return}jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var c=this.graphicsElement.getSize(),b=this.graphicsElement.getLocation();var a,d;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:a=b.X;break;case jsgl.HorizontalAnchor.CENTER:a=b.X-c.X/2;break;case jsgl.HorizontalAnchor.RIGHT:a=b.X-c.X;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:d=b.Y;break;case jsgl.VerticalAnchor.MIDDLE:d=b.Y-c.Y/2;break;case jsgl.VerticalAnchor.BOTTOM:d=b.Y-c.Y;break}this.svgImageElement.setAttribute("x",a);this.svgRectElement.setAttribute("x",a);this.svgImageElement.setAttribute("y",d);this.svgRectElement.setAttribute("y",d);this.svgImageElement.setAttribute("width",c.X);this.svgRectElement.setAttribute("width",c.X);this.svgImageElement.setAttribute("height",c.Y);this.svgRectElement.setAttribute("height",c.Y);this.svgImageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",this.graphicsElement.getUrl());this.svgGElement.setAttribute("transform","rotate("+this.graphicsElement.getRotation()+","+b.X+","+b.Y+")");this.svgImageElement.style.opacity=this.graphicsElement.getOpacity();this.graphicsElement.getStroke().applyToSvgElement(this.svgRectElement)};jsgl.elements.VmlImageDomPresenter=function(a){jsgl.elements.AbstractImageDomPresenter.call(this);this.vmlRectElement=a.createElement("vml:rect");this.vmlRectElement.style.position="absolute";this.vmlRectElement.stroked=false;this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlRectElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=a.createElement("vml:fill");this.vmlFillElement.type="frame";this.vmlFillElement.rotate=true;this.vmlRectElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlRectElement)};jsgl.elements.VmlImageDomPresenter.jsglExtend(jsgl.elements.AbstractImageDomPresenter);jsgl.elements.VmlImageDomPresenter.prototype.getXmlElement=function(){return this.vmlRectElement};jsgl.elements.VmlImageDomPresenter.prototype.update=function(){this.loadUrl(this.graphicsElement.getUrl());if(!this.isLoaded){window.setTimeout(jsgl.util.delegate(this,this.update),50);return}jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var j=this.graphicsElement.getSize(),f=this.graphicsElement.getLocation();var c=Math.PI*this.graphicsElement.getRotation()/180;var k,h;switch(this.graphicsElement.getHorizontalAnchor()){case jsgl.HorizontalAnchor.LEFT:k=f.X+j.X/2;break;case jsgl.HorizontalAnchor.CENTER:k=f.X;break;case jsgl.HorizontalAnchor.RIGHT:k=f.X-j.X/2;break}switch(this.graphicsElement.getVerticalAnchor()){case jsgl.VerticalAnchor.TOP:h=f.Y+j.Y/2;break;case jsgl.VerticalAnchor.MIDDLE:h=f.Y;break;case jsgl.VerticalAnchor.BOTTOM:h=f.Y-j.Y/2;break}var g=Math.atan2(h-f.Y,k-f.X);var e=jsgl.Vector2D.getDistance(f,new jsgl.Vector2D(k,h));var b=f.X+Math.cos(g+c)*e;var a=f.Y+Math.sin(g+c)*e;this.vmlRectElement.style.left=b-j.X/2;this.vmlRectElement.style.top=a-j.Y/2;this.vmlRectElement.style.width=j.X;this.vmlRectElement.style.height=j.Y;this.vmlRectElement.style.rotation=this.graphicsElement.getRotation()%360;this.vmlFillElement.src=this.graphicsElement.getUrl();this.vmlFillElement.opacity=this.graphicsElement.getOpacity();this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement)};jsgl.elements.ShapeElement=function(b,a){jsgl.elements.AbstractElement.call(this,a);this.path=new jsgl.util.ArrayList();this.pathChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.strokeChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.fillChangeListener=jsgl.util.delegate(this.onChangeRaiser,this.onChangeRaiser.raiseEvent);this.stroke=null;this.setStroke(new jsgl.stroke.SolidStroke());this.fill=null;this.setFill(new jsgl.fill.SolidFill());this.domPresenter=b;this.domPresenter.setGraphicsElement(this)};jsgl.elements.ShapeElement.jsglExtend(jsgl.elements.AbstractElement);jsgl.elements.ShapeElement.prototype.getDomPresenter=function(){return this.domPresenter};jsgl.elements.ShapeElement.prototype.addPathSegment=function(a){this.path.add(a);a.registerChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.getPathSegmentAt=function(a){return this.path.get(a)};jsgl.elements.ShapeElement.prototype.getPathSize=function(){return this.path.getCount()};jsgl.elements.ShapeElement.prototype.setPathSegmentAt=function(b,a){if(this.path.get(a)){this.path.get(a).unregisterChangeListener(this.pathChangeListener)}this.path.setAt(segment,a);segment.registerChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.removePathSegmentAt=function(a){this.path.get(a).unregisterChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.insertPathSegmentAt=function(b,a){this.path.insertAt(b,a);b.registerChangeListener(this.pathChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.clearPath=function(){var b=this.path.getCount();for(var a=0;a<b;a++){this.path.get(a).unregisterChangeListener(this.pathChangeListener)}this.path.clear();this.inChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.getStroke=function(){return this.stroke};jsgl.elements.ShapeElement.prototype.setStroke=function(a){if(this.stroke){this.stroke.unregisterChangeListener(this.strokeChangeListener)}this.stroke=a;this.stroke.registerChangeListener(this.strokeChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.ShapeElement.prototype.getFill=function(){return this.fill};jsgl.elements.ShapeElement.prototype.setFill=function(a){if(this.fill){this.fill.unregisterChangeListener(this.fillChangeListener)}this.fill=a;this.fill.registerChangeListener(this.fillChangeListener);this.onChangeRaiser.raiseEvent()};jsgl.elements.SvgShapeDomPresenter=function(a){jsgl.elements.AbstractDomPresenter.call(this);this.svgPathElement=a.createElementNS("http://www.w3.org/2000/svg","path");this.svgPathElement.style.setProperty("fill-rule","evenodd",null);this.attachMouseHandlers(this.svgPathElement)};jsgl.elements.SvgShapeDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.SvgShapeDomPresenter.prototype.getXmlElement=function(){return this.svgPathElement};jsgl.elements.SvgShapeDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var b="";var c=this.graphicsElement.getPathSize();for(var a=0;a<c;a++){b+=this.graphicsElement.getPathSegmentAt(a).toSvgCommand()}this.svgPathElement.setAttribute("d",b);this.graphicsElement.getStroke().applyToSvgElement(this.svgPathElement);this.graphicsElement.getFill().applyToSvgElement(this.svgPathElement)};jsgl.elements.VmlShapeDomPresenter=function(a){this.vmlShapeElement=document.createElement("vml:shape");this.vmlShapeElement.style.position="absolute";this.vmlShapeElement.coordsize=(1).jsglVmlize()+" "+(1).jsglVmlize();this.vmlShapeElement.style.width=this.vmlShapeElement.style.height=1;this.vmlStrokeElement=a.createElement("vml:stroke");this.vmlShapeElement.appendChild(this.vmlStrokeElement);this.vmlFillElement=a.createElement("vml:fill");this.vmlShapeElement.appendChild(this.vmlFillElement);this.attachMouseHandlers(this.vmlShapeElement)};jsgl.elements.VmlShapeDomPresenter.jsglExtend(jsgl.elements.AbstractDomPresenter);jsgl.elements.VmlShapeDomPresenter.prototype.getXmlElement=function(){return this.vmlShapeElement};jsgl.elements.VmlShapeDomPresenter.prototype.getStrokeElement=function(){return this.vmlStrokeElement};jsgl.elements.VmlShapeDomPresenter.prototype.getFillElement=function(){return this.vmlFillElement};jsgl.elements.VmlShapeDomPresenter.prototype.update=function(){jsgl.elements.AbstractDomPresenter.prototype.update.call(this);var b="",c=this.graphicsElement.getPathSize();var e={currLoc:new jsgl.Vector2D(),lastStart:new jsgl.Vector2D()};for(var a=0;a<c;a++){var d=this.graphicsElement.getPathSegmentAt(a);b+=d.toVmlCommand(e);if(d.isCubicBezier()){e.lastCBCtl=d.getCBControlPoint(e)}else{e.lastCBCtl=d.getNewLocation(e)}if(d.isQuadraticBezier()){e.lastQBCtl=d.getQBControlPoint(e)}else{e.lastQBCtl=d.getNewLocation(e)}if(!d.closesSubpath()){e.currLoc=d.getNewLocation(e)}else{e.currLoc=jsgl.cloneObject(e.lastStart)}if(d.startsNewSubpath()){e.lastStart=jsgl.cloneObject(e.currLoc)}}this.vmlShapeElement.path=b;this.graphicsElement.getStroke().applyToVmlStrokeElement(this.vmlStrokeElement);this.graphicsElement.getFill().applyToVmlFillElement(this.vmlFillElement)};jsgl.Panel=function(a){this.holderElement=a;this.elements=new jsgl.util.ArrayList();this.ownerDocument=null;if(jsgl.util.BrowserInfo.isMSIE55){this.ownerDocument=document}else{this.ownerDocument=a.ownerDocument}this.holderElement.style.position="relative";this.holderElement.style.overflow="hidden";this.holderElement.style.cursor="default";this.domPresenter=null;if(jsgl.util.BrowserInfo.supportsSvg){this.domPresenter=new jsgl.panel.SvgPanelDomPresenter(this)}else{this.domPresenter=new jsgl.panel.NonSvgPanelDomPresenter(this)}this.cursor=jsgl.Cursor.INHERIT;this.mouseMoveRaiser=new jsgl.util.EventRaiser();this.mouseDownRaiser=new jsgl.util.EventRaiser();this.mouseUpRaiser=new jsgl.util.EventRaiser();this.mouseOverRaiser=new jsgl.util.EventRaiser();this.mouseOutRaiser=new jsgl.util.EventRaiser();this.clickRaiser=new jsgl.util.EventRaiser();this.dblClickRaiser=new jsgl.util.EventRaiser()};jsgl.Panel.prototype.getHolderElement=function(){return this.holderElement};jsgl.Panel.prototype.getOwnerDocument=function(){return this.ownerDocument};jsgl.Panel.prototype.addElement=function(a){this.domPresenter.addElement(a);this.elements.add(a);a.setContainer(this)};jsgl.Panel.prototype.clear=function(){this.domPresenter.clear();this.elements.clear();for(i=0;i<this.elements.getCount();i++){this.elements.get(i).setContainer(null)}};jsgl.Panel.prototype.getElementsCount=function(){return this.elements.getCount()};jsgl.Panel.prototype.getElementAt=function(a){return this.elements.get(a)};jsgl.Panel.prototype.containsElement=function(a){return this.elements.contains(a)};jsgl.Panel.prototype.removeElement=function(a){this.domPresenter.removeElement(a);this.elements.remove(a);a.setContainer(null)};jsgl.Panel.prototype.createGroup=function(a,d,c){var b;if(jsgl.util.BrowserInfo.supportsSvg){b=new jsgl.elements.SvgGroupDomPresenter(this.ownerDocument)}else{b=new jsgl.elements.NonSvgGroupDomPresenter(this.ownerDocument)}return new jsgl.elements.GroupElement(b,this,a,d,c)};jsgl.Panel.prototype.createCircle=function(b,g,a,e,d,f){var c;if(jsgl.util.BrowserInfo.supportsSvg){c=new jsgl.elements.SvgCircleDomPresenter(this.ownerDocument)}else{c=new jsgl.elements.VmlCircleDomPresenter(this.ownerDocument)}return new jsgl.elements.CircleElement(c,this,b,g,a,e,d,f)};jsgl.Panel.prototype.createEllipse=function(e,c,b,f,j,g,h,d){var a;if(jsgl.util.BrowserInfo.supportsSvg){a=new jsgl.elements.SvgEllipseDomPresenter(this.ownerDocument)}else{a=new jsgl.elements.VmlEllipseDomPresenter(this.ownerDocument)}return new jsgl.elements.EllipseElement(a,this,e,c,b,f,j,g,h,d)};jsgl.Panel.prototype.createRectangle=function(){var a;if(jsgl.util.BrowserInfo.supportsSvg){a=new jsgl.elements.SvgRectangleDomPresenter(this.ownerDocument)}else{a=new jsgl.elements.VmlRectangleDomPresenter(this.ownerDocument)}return new jsgl.elements.RectangleElement(a,this)};jsgl.Panel.prototype.createLine=function(b,d,a,c,f,g){var e;if(jsgl.util.BrowserInfo.supportsSvg){e=new jsgl.elements.SvgLineDomPresenter(this.ownerDocument)}else{e=new jsgl.elements.VmlLineDomPresenter(this.ownerDocument)}return new jsgl.elements.LineElement(e,this,b,d,a,c,f,g)};jsgl.Panel.prototype.createLabel=function(a,e,c,d){var b;if(jsgl.util.BrowserInfo.supportsSvg){b=new jsgl.elements.SvgLabelDomPresenter(this.ownerDocument)}else{b=new jsgl.elements.NonSvgLabelDomPresenter(this.ownerDocument)}return new jsgl.elements.LabelElement(b,this,a,e,c,d)};jsgl.Panel.prototype.createPolyline=function(b,c){var a;if(jsgl.util.BrowserInfo.supportsSvg){a=new jsgl.elements.SvgPolylineDomPresenter(this.ownerDocument)}else{a=new jsgl.elements.VmlPolylineDomPresenter(this.ownerDocument)}return new jsgl.elements.PolylineElement(a,this,b,c)};jsgl.Panel.prototype.createPolygon=function(c,b,d){var a;if(jsgl.util.BrowserInfo.supportsSvg){a=new jsgl.elements.SvgPolygonDomPresenter(this.ownerDocument)}else{a=new jsgl.elements.VmlPolygonDomPresenter(this.ownerDocument)}return new jsgl.elements.PolygonElement(a,this,c,b,d)};jsgl.Panel.prototype.createImage=function(){var a;if(jsgl.util.BrowserInfo.supportsSvg){a=new jsgl.elements.SvgImageDomPresenter(this.ownerDocument)}else{a=new jsgl.elements.VmlImageDomPresenter(this.ownerDocument)}return new jsgl.elements.ImageElement(a,this)};jsgl.Panel.prototype.createCurve=function(){var a;if(jsgl.util.BrowserInfo.supportsSvg){a=new jsgl.elements.SvgCurveDomPresenter(this.ownerDocument)}else{a=new jsgl.elements.VmlCurveDomPresenter(this.ownerDocument)}return new jsgl.elements.CurveElement(a,this)};jsgl.Panel.prototype.createShape=function(){var a;if(jsgl.util.BrowserInfo.supportsSvg){a=new jsgl.elements.SvgShapeDomPresenter(this.ownerDocument)}else{a=new jsgl.elements.VmlShapeDomPresenter(this.ownerDocument)}return new jsgl.elements.ShapeElement(a,this)};jsgl.Panel.prototype.setCursor=function(a){this.cursor=a;this.domPresenter.update()};jsgl.Panel.prototype.getCursor=function(){return this.cursor};jsgl.Panel.prototype.addMouseMoveListener=function(a){this.mouseMoveRaiser.registerListener(a)};jsgl.Panel.prototype.removeMouseMoveListener=function(a){this.mouseMoveRaiser.unregisterListener(a)};jsgl.Panel.prototype.raiseMouseMove=function(a){this.mouseMoveRaiser.raiseEvent(a)};jsgl.Panel.prototype.addMouseDownListener=function(a){this.mouseDownRaiser.registerListener(a)};jsgl.Panel.prototype.removeMouseDownListener=function(a){this.mouseDownRaiser.unregisterListener(a)};jsgl.Panel.prototype.raiseMouseDown=function(a){this.mouseDownRaiser.raiseEvent(a)};jsgl.Panel.prototype.addMouseUpListener=function(a){this.mouseUpRaiser.registerListener(a)};jsgl.Panel.prototype.removeMouseUpListener=function(a){this.mouseUpRaiser.unregisterListener(a)};jsgl.Panel.prototype.raiseMouseUp=function(a){this.mouseUpRaiser.raiseEvent(a)};jsgl.Panel.prototype.addMouseOverListener=function(a){this.mouseOverRaiser.registerListener(a)};jsgl.Panel.prototype.removeMouseOverListener=function(a){this.mouseOverRaiser.unregisterListener(a)};jsgl.Panel.prototype.raiseMouseOver=function(a){this.mouseOverRaiser.raiseEvent(a)};jsgl.Panel.prototype.addMouseOutListener=function(a){this.mouseOutRaiser.registerListener(a)};jsgl.Panel.prototype.removeMouseOutListener=function(a){this.mouseOutRaiser.unregisterListener(a)};jsgl.Panel.prototype.raiseMouseOut=function(a){this.mouseOutRaiser.raiseEvent(a)};jsgl.Panel.prototype.addClickListener=function(a){this.clickRaiser.registerListener(a)};jsgl.Panel.prototype.removeClickListener=function(a){this.clickRaiser.unregisterListener(a)};jsgl.Panel.prototype.raiseClick=function(a){this.clickRaiser.raiseEvent(a)};jsgl.Panel.prototype.addDoubleClickListener=function(a){this.dblClickRaiser.registerListener(a)};jsgl.Panel.prototype.removeDoubleClickListener=function(a){this.dblClickRaiser.unregisterListener(a)};jsgl.Panel.prototype.raiseDoubleClick=function(a){this.dblClickRaiser.raiseEvent(a)};jsgl.panel.AbstractPanelDomPresenter=function(a){this.panelObject=a;this.holderElement=this.panelObject.getHolderElement();this.initMouseHandlers()};jsgl.panel.AbstractPanelDomPresenter.prototype.addElement=function(a){throw"Not implemented"};jsgl.panel.AbstractPanelDomPresenter.prototype.removeElement=function(a){throw"Not implemented"};jsgl.panel.AbstractPanelDomPresenter.prototype.clear=function(){throw"Not implemented"};jsgl.panel.AbstractPanelDomPresenter.prototype.update=function(){this.holderElement.style.cursor=this.panelObject.getCursor().asCSS};jsgl.panel.AbstractPanelDomPresenter.prototype.initMouseHandlers=function(){this.holderElement.onclick=jsgl.util.delegate(this,function(a){if(jsgl.util.BrowserInfo.usesWindowEvent){a=window.event}this.panelObject.raiseClick(jsgl.MouseEvent.fromJsglPanel(a,this.panelObject,jsgl.MouseEvent.CLICK));return false});this.holderElement.ondblclick=jsgl.util.delegate(this,function(a){if(jsgl.util.BrowserInfo.usesWindowEvent){a=window.event}this.panelObject.raiseDoubleClick(jsgl.MouseEvent.fromJsglPanel(a,this.panelObject,jsgl.MouseEvent.DOUBLE_CLICK));return false});this.holderElement.onmousedown=jsgl.util.delegate(this,function(a){if(jsgl.util.BrowserInfo.usesWindowEvent){a=window.event}this.panelObject.raiseMouseDown(jsgl.MouseEvent.fromJsglPanel(a,this.panelObject,jsgl.MouseEvent.DOWN));return false});this.holderElement.onmouseup=jsgl.util.delegate(this,function(a){if(jsgl.util.BrowserInfo.usesWindowEvent){a=window.event}this.panelObject.raiseMouseUp(jsgl.MouseEvent.fromJsglPanel(a,this.panelObject,jsgl.MouseEvent.UP));return false});this.holderElement.onmousemove=jsgl.util.delegate(this,function(a){if(jsgl.util.BrowserInfo.usesWindowEvent){a=window.event}this.panelObject.raiseMouseMove(jsgl.MouseEvent.fromJsglPanel(a,this.panelObject,jsgl.MouseEvent.MOVE));return false});this.holderElement.onmouseover=jsgl.util.delegate(this,function(a){if(jsgl.util.BrowserInfo.usesWindowEvent){a=window.event}this.panelObject.raiseMouseOver(jsgl.MouseEvent.fromJsglPanel(a,this.panelObject,jsgl.MouseEvent.OVER));return false});this.holderElement.onmouseout=jsgl.util.delegate(this,function(a){if(jsgl.util.BrowserInfo.usesWindowEvent){a=window.event}this.panelObject.raiseMouseOut(jsgl.MouseEvent.fromJsglPanel(a,this.panelObject,jsgl.MouseEvent.OUT));return false})};jsgl.panel.NonSvgPanelDomPresenter=function(a){jsgl.panel.AbstractPanelDomPresenter.call(this,a);this.elementsGroup=this.panelObject.createGroup();this.holderElement.appendChild(this.elementsGroup.getDomPresenter().getXmlElement());this.elementsGroup.setContainer(a)};jsgl.panel.NonSvgPanelDomPresenter.jsglExtend(jsgl.panel.AbstractPanelDomPresenter);jsgl.panel.NonSvgPanelDomPresenter.prototype.addElement=function(a){this.elementsGroup.addElement(a)};jsgl.panel.NonSvgPanelDomPresenter.prototype.removeElement=function(a){this.elementsGroup.removeElement(a)};jsgl.panel.NonSvgPanelDomPresenter.prototype.clear=function(){this.elementsGroup.clear()};jsgl.panel.SvgPanelDomPresenter=function(a){jsgl.panel.AbstractPanelDomPresenter.call(this,a);this.svgHolder=this.panelObject.getOwnerDocument().createElementNS("http://www.w3.org/2000/svg","svg");this.svgHolder.style.position="absolute";this.svgHolder.style.left="0px";this.svgHolder.style.top="0px";this.holderElement.appendChild(this.svgHolder);this.domSorter=new jsgl.elements.DomSorter(this.svgHolder);this.lastSize=new jsgl.Vector2D();this.sizeUpdate();window.setInterval(jsgl.util.delegate(this,this.sizeUpdate),50)};jsgl.panel.SvgPanelDomPresenter.jsglExtend(jsgl.panel.AbstractPanelDomPresenter);jsgl.panel.SvgPanelDomPresenter.prototype.addElement=function(a){this.domSorter.add(a)};jsgl.panel.SvgPanelDomPresenter.prototype.removeElement=function(a){this.domSorter.remove(a)};jsgl.panel.SvgPanelDomPresenter.prototype.clear=function(){for(var a=0;a<this.panelObject.getElementsCount();a++){this.domSorter.remove(this.panelObject.getElementAt(a))}};jsgl.panel.SvgPanelDomPresenter.prototype.sizeUpdate=function(){if(this.lastSize.X!=this.holderElement.clientWidth||this.lastSize.Y!=this.holderElement.clientHeight){this.lastSize.X=this.holderElement.clientWidth;this.lastSize.Y=this.holderElement.clientHeight;this.svgHolder.setAttribute("width",this.lastSize.X);this.svgHolder.setAttribute("height",this.lastSize.Y)}};jsgl.DashStyles={DASH:jsgl.stroke.DashDashStyle.getInstance(),DASH_DOT:jsgl.stroke.DashDotDashStyle.getInstance(),DOT:jsgl.stroke.DotDashStyle.getInstance(),LONG_DASH:jsgl.stroke.LongDashDashStyle.getInstance(),LONG_DASH_DOT:jsgl.stroke.LongDashDotDashStyle.getInstance(),LONG_DASH_DOT_DOT:jsgl.stroke.LongDashDotDotDashStyle.getInstance(),SHORT_DASH_DOT:jsgl.stroke.ShortDashDotDashStyle.getInstance(),SOLID:jsgl.stroke.SolidDashStyle.getInstance()};jsgl.JoinStyles={ROUND:jsgl.stroke.RoundJoinStyle.getInstance(),BEVEL:jsgl.stroke.BevelJoinStyle.getInstance(),MITER:new jsgl.stroke.MiterJoinStyle(10)};jsgl.EndcapTypes={ROUND:jsgl.stroke.RoundEndcapType.getInstance(),FLAT:jsgl.stroke.FlatEndcapType.getInstance(),SQUARE:jsgl.stroke.SquareEndcapType.getInstance()};jsgl.Cursor={INHERIT:{asCSS:jsgl.util.BrowserInfo.isMSIE?"":"inherit"},DEFAULT:{asCSS:"default"},POINTER:{asCSS:"pointer"},CROSSHAIR:{asCSS:"crosshair"},HELP:{asCSS:"help"},TEXT:{asCSS:"text"},WAIT:{asCSS:"wait"},PROGRESS:{asCSS:"progress"},MOVE:{asCSS:"move"},N_RESIZE:{asCSS:"n-resize"},NE_RESIZE:{asCSS:"ne-resize"},E_RESIZE:{asCSS:"e-resize"},SE_RESIZE:{asCSS:"se-resize"},S_RESIZE:{asCSS:"s-resize"},SW_RESIZE:{asCSS:"sw-resize"},W_RESIZE:{asCSS:"w-resize"},NW_RESIZE:{asCSS:"nw-resize"}};jsgl.VerticalAnchor={TOP:0,BOTTOM:1,MIDDLE:2};jsgl.HorizontalAnchor={LEFT:0,RIGHT:1,CENTER:2};jsgl.MouseEvent=function(a,d,c,b){this.eventType=c||jsgl.MouseEvent.UNKNOWN;this.location=new jsgl.Vector2D(a,d);this.sourceElement=b||null};jsgl.MouseEvent.fromJsglElement=function(c,f,d){var b;if(jsgl.util.BrowserInfo.usesWindowEvent){if(jsgl.util.BrowserInfo.isOpera){b=new jsgl.Vector2D(c.pageX,c.pageY)}else{b=new jsgl.Vector2D(c.x,c.y)}b.X-=parseInt(f.getPanel().getHolderElement().style.borderLeftWidth)||0;b.Y-=parseInt(f.getPanel().getHolderElement().style.borderTopWidth)||0}else{b=new jsgl.Vector2D(c.layerX,c.layerY)}var a=f.getPanel();var h=new jsgl.Vector2D();var e=f.getContainer();do{if(e!=a){h=h.add(e.getLocation());e=e.getContainer()}}while(e!=a);if(jsgl.util.BrowserInfo.isOpera){var g=f.getPanel().getHolderElement();while(g!=document.body){h.X+=g.offsetLeft;h.Y+=g.offsetTop;g=g.offsetParent}}b=b.subtract(h);var f=null,g=c.srcElement||c.target;do{if(g.jsglElement){f=g.jsglElement;break}g=g.parentNode}while(g!=document.body);return new jsgl.MouseEvent(b.X,b.Y,d,f)};jsgl.MouseEvent.fromJsglPanel=function(b,e,c){var a=new jsgl.Vector2D();if(jsgl.util.BrowserInfo.usesWindowEvent){if(jsgl.util.BrowserInfo.isOpera){a=new jsgl.Vector2D(b.pageX,b.pageY)}else{a=new jsgl.Vector2D(b.x,b.y)}a.X-=parseInt(e.getHolderElement().style.borderLeftWidth)||0;a.Y-=parseInt(e.getHolderElement().style.borderTopWidth)||0}else{a=new jsgl.Vector2D(b.layerX,b.layerY)}if(jsgl.util.BrowserInfo.isOpera){var f=e.getHolderElement();while(f!=document.body){a.X-=f.offsetLeft;a.Y-=f.offsetTop;f=f.offsetParent}}var d=null,f=b.srcElement||b.target;do{if(f.jsglElement){d=f.jsglElement;break}f=f.parentNode}while(f!=document.body);return new jsgl.MouseEvent(a.X,a.Y,c,d)};jsgl.MouseEvent.UNKNOWN=0;jsgl.MouseEvent.CLICK=1;jsgl.MouseEvent.DOUBLE_CLICK=2;jsgl.MouseEvent.DOWN=3;jsgl.MouseEvent.UP=4;jsgl.MouseEvent.MOVE=5;jsgl.MouseEvent.OVER=6;jsgl.MouseEvent.OUT=7;jsgl.MouseEvent.prototype.getX=function(){return this.location.X};jsgl.MouseEvent.prototype.getY=function(){return this.location.Y};jsgl.MouseEvent.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.MouseEvent.prototype.getSourceElement=function(){return this.sourceElement};jsgl.MouseEvent.prototype.getEventType=function(){return this.eventType};jsgl.path.AbstractPathSegment=function(){this.onChangeRaiser=new jsgl.util.EventRaiser()};jsgl.path.AbstractPathSegment.prototype.registerChangeListener=function(a){this.onChangeRaiser.registerListener(a)};jsgl.path.AbstractPathSegment.prototype.unregisterChangeListener=function(a){this.onChangeRaiser.unregisterListener(a)};jsgl.path.AbstractPathSegment.prototype.toSvgCommand=function(){throw"not implemented"};jsgl.path.AbstractPathSegment.prototype.toVmlCommand=function(a){throw"not implemented"};jsgl.path.AbstractPathSegment.prototype.getNewLocation=function(a){return new jsgl.Vector2D(Number.NaN,Number.NaN)};jsgl.path.AbstractPathSegment.prototype.startsNewSubpath=function(){return false};jsgl.path.AbstractPathSegment.prototype.closesSubpath=function(){return false};jsgl.path.AbstractPathSegment.prototype.isCubicBezier=function(){return false};jsgl.path.AbstractPathSegment.prototype.getCBControlPoint=function(a){throw"not applicable"};jsgl.path.AbstractPathSegment.prototype.isQuadraticBezier=function(){return false};jsgl.path.AbstractPathSegment.prototype.getQBControlPoint=function(a){throw"not applicable"};jsgl.path.AbstractMoveTo=function(a,b){jsgl.path.AbstractPathSegment.call(this);this.location=new jsgl.Vector2D(a||0,b||0)};jsgl.path.AbstractMoveTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractMoveTo.prototype.getX=function(){return this.location.X};jsgl.path.AbstractMoveTo.prototype.setX=function(a){this.location.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.getY=function(){return this.location.Y};jsgl.path.AbstractMoveTo.prototype.setY=function(a){this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.getLocation=function(){return jsgl.cloneObject(this.location)};jsgl.path.AbstractMoveTo.prototype.setLocation=function(a){this.location=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.setLocationXY=function(b,a){this.location.X=b;this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractMoveTo.prototype.startsNewSubpath=function(){return true};jsgl.path.AbsoluteMoveTo=function(a,b){jsgl.path.AbstractMoveTo.call(this,a||0,b||0)};jsgl.path.AbsoluteMoveTo.jsglExtend(jsgl.path.AbstractMoveTo);jsgl.path.AbsoluteMoveTo.prototype.toSvgCommand=function(){return"M"+this.location.X+","+this.location.Y};jsgl.path.AbsoluteMoveTo.prototype.toVmlCommand=function(a){return"m"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.AbsoluteMoveTo.prototype.getNewLocation=function(a){return jsgl.cloneObject(this.location)};jsgl.path.RelativeMoveTo=function(a,b){jsgl.path.AbstractMoveTo.call(this,a||0,b||0)};jsgl.path.RelativeMoveTo.jsglExtend(jsgl.path.AbstractMoveTo);jsgl.path.RelativeMoveTo.prototype.toSvgCommand=function(){return"m"+this.location.X+","+this.location.Y};jsgl.path.RelativeMoveTo.prototype.toVmlCommand=function(a){return"t"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.RelativeMoveTo.prototype.getNewLocation=function(a){return a.currLoc.add(this.location)};jsgl.path.AbstractLineTo=function(a,b){jsgl.path.AbstractPathSegment.call(this);this.location=new jsgl.Vector2D(a||0,b||0)};jsgl.path.AbstractLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractLineTo.prototype.getX=function(){return this.location.X};jsgl.path.AbstractLineTo.prototype.setX=function(a){this.location.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractLineTo.prototype.getY=function(){return this.location.Y};jsgl.path.AbstractLineTo.prototype.setY=function(a){this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractLineTo.prototype.getEndPoint=function(){return jsgl.cloneObject(this.location)};jsgl.path.AbstractLineTo.prototype.setEndPoint=function(a){this.location=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractLineTo.prototype.setEndPointXY=function(b,a){this.location.X=b;this.location.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbsoluteLineTo=function(a,b){jsgl.path.AbstractLineTo.call(this,a||0,b||0)};jsgl.path.AbsoluteLineTo.jsglExtend(jsgl.path.AbstractLineTo);jsgl.path.AbsoluteLineTo.prototype.toSvgCommand=function(){return"L"+this.location.X+","+this.location.Y};jsgl.path.AbsoluteLineTo.prototype.toVmlCommand=function(a){return"l"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.AbsoluteLineTo.prototype.getNewLocation=function(a){return jsgl.cloneObject(this.location)};jsgl.path.RelativeLineTo=function(a,b){jsgl.path.AbstractLineTo.call(this,a||0,b||0)};jsgl.path.RelativeLineTo.jsglExtend(jsgl.path.AbstractLineTo);jsgl.path.RelativeLineTo.prototype.toSvgCommand=function(){return"l"+this.location.X+","+this.location.Y};jsgl.path.RelativeLineTo.prototype.toVmlCommand=function(a){return"r"+(this.location.X).jsglVmlize()+","+(this.location.Y).jsglVmlize()};jsgl.path.RelativeLineTo.prototype.getNewLocation=function(a){return a.currLoc.add(this.location)};jsgl.path.ClosePath=function(){jsgl.path.AbstractPathSegment.call(this)};jsgl.path.ClosePath.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.ClosePath.prototype.toSvgCommand=function(){return"Z"};jsgl.path.ClosePath.prototype.toVmlCommand=function(a){return"xm"+(a.lastStart.X).jsglVmlize()+","+(a.lastStart.Y).jsglVmlize()};jsgl.path.ClosePath.prototype.getNewLocation=function(a){return jsgl.cloneObject(a.currLoc)};jsgl.path.ClosePath.prototype.closesSubpath=function(){return true};jsgl.path.AbsoluteHorizontalLineTo=function(a){jsgl.path.AbstractPathSegment.call(this);this.x=a||0};jsgl.path.AbsoluteHorizontalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbsoluteHorizontalLineTo.prototype.getX=function(){return this.x};jsgl.path.AbsoluteHorizontalLineTo.prototype.setX=function(a){this.x=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbsoluteHorizontalLineTo.prototype.toSvgCommand=function(){return"H"+this.x};jsgl.path.AbsoluteHorizontalLineTo.prototype.toVmlCommand=function(a){return"l"+(this.x).jsglVmlize()+","+(pathHistory.currLoc.Y).jsglVmlize()};jsgl.path.AbsoluteHorizontalLineTo.prototype.getNewLocation=function(a){return new jsgl.Vector2D(this.x,a.currLoc.Y)};jsgl.path.RelativeHorizontalLineTo=function(a){jsgl.path.AbstractPathSegment.call(this);this.x=a||0};jsgl.path.RelativeHorizontalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.RelativeHorizontalLineTo.prototype.getX=function(){return this.x};jsgl.path.RelativeHorizontalLineTo.prototype.setX=function(a){this.x=a;this.onChangeRaiser.raiseEvent()};jsgl.path.RelativeHorizontalLineTo.prototype.toSvgCommand=function(){return"h"+this.x};jsgl.path.RelativeHorizontalLineTo.prototype.toVmlCommand=function(a){return"r"+(this.x).jsglVmlize()+",0"};jsgl.path.RelativeHorizontalLineTo.prototype.getNewLocation=function(a){return new jsgl.Vector2D(a.currLoc.X+this.x,a.currLoc.Y)};jsgl.path.AbsoluteVerticalLineTo=function(a){jsgl.path.AbstractPathSegment.call(this);this.y=a||0};jsgl.path.AbsoluteVerticalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbsoluteVerticalLineTo.prototype.getY=function(){return this.y};jsgl.path.AbsoluteVerticalLineTo.prototype.setY=function(a){this.y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbsoluteVerticalLineTo.prototype.toSvgCommand=function(){return"V"+this.y};jsgl.path.AbsoluteVerticalLineTo.prototype.toVmlCommand=function(a){return"l"+(a.currLoc.X).jsglVmlize()+","+(this.y).jsglVmlize()};jsgl.path.AbsoluteVerticalLineTo.prototype.getNewLocation=function(a){return new jsgl.Vector2D(a.currLoc.X,this.y)};jsgl.path.RelativeVerticalLineTo=function(a){jsgl.path.AbstractPathSegment.call(this);this.y=a||0};jsgl.path.RelativeVerticalLineTo.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.RelativeVerticalLineTo.prototype.getY=function(){return this.y};jsgl.path.RelativeVerticalLineTo.prototype.setY=function(a){this.y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.RelativeVerticalLineTo.prototype.toSvgCommand=function(){return"v"+this.y};jsgl.path.RelativeVerticalLineTo.prototype.toVmlCommand=function(a){return"r0,"+(this.y).jsglVmlize()};jsgl.path.RelativeVerticalLineTo.prototype.getNewLocation=function(a){return new jsgl.Vector2D(a.currLoc.X,a.currLoc.Y+this.y)};jsgl.path.AbstractCubicBezier=function(f,e,b,a,d,c){jsgl.path.AbstractPathSegment.call(this);this.control1=new jsgl.Vector2D(f||0,e||0);this.control2=new jsgl.Vector2D(b||0,a||0);this.endPoint=new jsgl.Vector2D(d||0,c||0)};jsgl.path.AbstractCubicBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractCubicBezier.prototype.getControl1X=function(){return this.control1.X};jsgl.path.AbstractCubicBezier.prototype.setControl1X=function(a){this.control1.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl1Y=function(){return this.control1.Y};jsgl.path.AbstractCubicBezier.prototype.setControl1Y=function(a){this.control1.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl1Point=function(){return jsgl.cloneObject(this.control1)};jsgl.path.AbstractCubicBezier.prototype.setControl1Point=function(a){this.control1=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl2X=function(){return this.control2.X};jsgl.path.AbstractCubicBezier.prototype.setControl2X=function(a){this.control2.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl2Y=function(){return this.control2.Y};jsgl.path.AbstractCubicBezier.prototype.setControl2Y=function(a){this.control2.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getControl2Point=function(){return jsgl.cloneObject(this.control2)};jsgl.path.AbstractCubicBezier.prototype.setControl2Point=function(a){this.control2=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractCubicBezier.prototype.setEndX=function(a){this.endPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractCubicBezier.prototype.setEndY=function(a){this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractCubicBezier.prototype.setEndPoint=function(a){this.endPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractCubicBezier.prototype.isCubicBezier=function(){return true};jsgl.path.AbsoluteCubicBezier=function(f,e,b,a,d,c){jsgl.path.AbstractCubicBezier.call(this,f||0,e||0,b||0,a||0,d||0,c||0)};jsgl.path.AbsoluteCubicBezier.jsglExtend(jsgl.path.AbstractCubicBezier);jsgl.path.AbsoluteCubicBezier.prototype.toSvgCommand=function(){return"C"+this.control1.X+","+this.control1.Y+","+this.control2.X+","+this.control2.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteCubicBezier.prototype.toVmlCommand=function(a){return"c"+(this.control1.X).jsglVmlize()+","+(this.control1.Y).jsglVmlize()+","+(this.control2.X).jsglVmlize()+","+(this.control2.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteCubicBezier.prototype.getNewLocation=function(a){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteCubicBezier.prototype.getCBControlPoint=function(a){return jsgl.cloneObject(this.control2)};jsgl.path.RelativeCubicBezier=function(f,e,b,a,d,c){jsgl.path.AbstractCubicBezier.call(this,f||0,e||0,b||0,a||0,d||0,c||0)};jsgl.path.RelativeCubicBezier.jsglExtend(jsgl.path.AbstractCubicBezier);jsgl.path.RelativeCubicBezier.prototype.toSvgCommand=function(){return"c"+this.control1.X+","+this.control1.Y+","+this.control2.X+","+this.control2.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeCubicBezier.prototype.toVmlCommand=function(a){return"v"+(this.control1.X).jsglVmlize()+","+(this.control1.Y).jsglVmlize()+","+(this.control2.X).jsglVmlize()+","+(this.control2.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeCubicBezier.prototype.getNewLocation=function(a){return a.currLoc.add(this.endPoint)};jsgl.path.RelativeCubicBezier.prototype.getCBControlPoint=function(a){return a.currLoc.add(this.control2)};jsgl.path.AbstractSmoothCubicBezier=function(d,c,b,a){jsgl.path.AbstractPathSegment.call(this);this.controlPoint=new jsgl.Vector2D(d||0,c||0);this.endPoint=new jsgl.Vector2D(b||0,a||0)};jsgl.path.AbstractSmoothCubicBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractSmoothCubicBezier.prototype.getControlX=function(){return this.controlPoint.X};jsgl.path.AbstractSmoothCubicBezier.prototype.setControlX=function(a){this.controlPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getControlY=function(){return this.controlPoint.Y};jsgl.path.AbstractSmoothCubicBezier.prototype.setControlY=function(a){this.controlPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getControlPoint=function(){return this.controlPoint};jsgl.path.AbstractSmoothCubicBezier.prototype.setControlPoint=function(a){this.controlPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractSmoothCubicBezier.prototype.setEndX=function(a){this.endPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractSmoothCubicBezier.prototype.setEndY=function(a){this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.getEndPoint=function(){return this.endPoint};jsgl.path.AbstractSmoothCubicBezier.prototype.setEndPoint=function(a){this.endPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothCubicBezier.prototype.isCubicBezier=function(){return true};jsgl.path.AbsoluteSmoothCubicBezier=function(d,c,b,a){jsgl.path.AbstractSmoothCubicBezier.call(this,d||0,c||0,b||0,a||0)};jsgl.path.AbsoluteSmoothCubicBezier.jsglExtend(jsgl.path.AbstractSmoothCubicBezier);jsgl.path.AbsoluteSmoothCubicBezier.prototype.toSvgCommand=function(){return"S"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteSmoothCubicBezier.prototype.toVmlCommand=function(b){var a=new jsgl.Vector2D(2*b.currLoc.X-b.lastCBCtl.X,2*b.currLoc.Y-b.lastCBCtl.Y);return"c"+(a.X).jsglVmlize()+","+(a.Y).jsglVmlize()+","+(this.controlPoint.X).jsglVmlize()+","+(this.controlPoint.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteSmoothCubicBezier.prototype.getNewLocation=function(a){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteSmoothCubicBezier.prototype.getCBControlPoint=function(a){return jsgl.cloneObject(this.controlPoint)};jsgl.path.RelativeSmoothCubicBezier=function(d,c,b,a){jsgl.path.AbstractSmoothCubicBezier.call(this,d||0,c||0,b||0,a||0)};jsgl.path.RelativeSmoothCubicBezier.jsglExtend(jsgl.path.AbstractSmoothCubicBezier);jsgl.path.RelativeSmoothCubicBezier.prototype.toSvgCommand=function(){return"s"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeSmoothCubicBezier.prototype.toVmlCommand=function(b){var a=new jsgl.Vector2D(b.currLoc.X-b.lastCBCtl.X,b.currLoc.Y-b.lastCBCtl.Y);return"v"+(a.X).jsglVmlize()+","+(a.Y).jsglVmlize()+","+(this.controlPoint.X).jsglVmlize()+","+(this.controlPoint.Y).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeSmoothCubicBezier.prototype.getNewLocation=function(a){return a.currLoc.add(this.endPoint)};jsgl.path.RelativeSmoothCubicBezier.prototype.getCBControlPoint=function(a){return a.currLoc.add(this.controlPoint)};jsgl.path.AbstractQuadraticBezier=function(d,c,b,a){jsgl.path.AbstractPathSegment.call(this);this.controlPoint=new jsgl.Vector2D(d||0,c||0);this.endPoint=new jsgl.Vector2D(b||0,a||0)};jsgl.path.AbstractQuadraticBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractQuadraticBezier.prototype.getControlX=function(){return this.controlPoint.X};jsgl.path.AbstractQuadraticBezier.prototype.setControlX=function(a){this.controlPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getControlY=function(){return this.controlPoint.Y};jsgl.path.AbstractQuadraticBezier.prototype.setControlY=function(a){this.controlPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getControlPoint=function(){return jsgl.cloneObject(this.controlPoint)};jsgl.path.AbstractQuadraticBezier.prototype.setControlPoint=function(a){this.controlPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractQuadraticBezier.prototype.setEndX=function(a){this.endPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractQuadraticBezier.prototype.setEndY=function(a){this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractQuadraticBezier.prototype.setEndPoint=function(a){this.endPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractQuadraticBezier.prototype.isQuadraticBezier=function(){return true};jsgl.path.AbsoluteQuadraticBezier=function(d,c,b,a){jsgl.path.AbstractQuadraticBezier.call(this,d||0,c||0,b||0,a||0)};jsgl.path.AbsoluteQuadraticBezier.jsglExtend(jsgl.path.AbstractQuadraticBezier);jsgl.path.AbsoluteQuadraticBezier.prototype.toSvgCommand=function(){return"Q"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteQuadraticBezier.prototype.toVmlCommand=function(a){return"c"+((a.currLoc.X+2*this.controlPoint.X)/3).jsglVmlize()+","+((a.currLoc.Y+2*this.controlPoint.Y)/3).jsglVmlize()+","+((2*this.controlPoint.X+this.endPoint.X)/3).jsglVmlize()+","+((2*this.controlPoint.Y+this.endPoint.Y)/3).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteQuadraticBezier.prototype.getNewLocation=function(a){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteQuadraticBezier.prototype.getQBControlPoint=function(a){return jsgl.cloneObject(this.controlPoint)};jsgl.path.RelativeQuadraticBezier=function(d,c,b,a){jsgl.path.AbstractQuadraticBezier.call(this,d||0,c||0,b||0,a||0)};jsgl.path.RelativeQuadraticBezier.jsglExtend(jsgl.path.AbstractQuadraticBezier);jsgl.path.RelativeQuadraticBezier.prototype.toSvgCommand=function(){return"q"+this.controlPoint.X+","+this.controlPoint.Y+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeQuadraticBezier.prototype.toVmlCommand=function(a){return"c"+(a.currLoc.X+(2*this.controlPoint.X)/3).jsglVmlize()+","+(a.currLoc.Y+(2*this.controlPoint.Y)/3).jsglVmlize()+","+(a.currLoc.X+(2*this.controlPoint.X+this.endPoint.X)/3).jsglVmlize()+","+(a.currLoc.Y+(2*this.controlPoint.Y+this.endPoint.Y)/3).jsglVmlize()+","+(a.currLoc.X+this.endPoint.X).jsglVmlize()+","+(a.currLoc.Y+this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeQuadraticBezier.prototype.getNewLocation=function(a){return a.currLoc.add(this.endPoint)};jsgl.path.RelativeQuadraticBezier.prototype.getQBControlPoint=function(a){return a.currLoc.add(this.controlPoint)};jsgl.path.AbstractSmoothQuadraticBezier=function(a,b){jsgl.path.AbstractPathSegment.call(this);this.endPoint=new jsgl.Vector2D(a||0,b||0)};jsgl.path.AbstractSmoothQuadraticBezier.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractSmoothQuadraticBezier.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractSmoothQuadraticBezier.prototype.setEndX=function(a){this.endPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothQuadraticBezier.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractSmoothQuadraticBezier.prototype.setEndY=function(a){this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractSmoothQuadraticBezier.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractSmoothQuadraticBezier.prototype.setEndPoint=function(a){this.endPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent(a)};jsgl.path.AbstractSmoothQuadraticBezier.prototype.isQuadraticBezier=function(){return true};jsgl.path.AbsoluteSmoothQuadraticBezier=function(a,b){jsgl.path.AbstractSmoothQuadraticBezier.call(this,a||0,b||0)};jsgl.path.AbsoluteSmoothQuadraticBezier.jsglExtend(jsgl.path.AbstractSmoothQuadraticBezier);jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.toSvgCommand=function(){return"T"+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.toVmlCommand=function(b){var a=new jsgl.Vector2D(2*b.currLoc.X-b.lastQBCtl.X,2*b.currLoc.Y-b.lastQBCtl.Y);return"c"+((b.currLoc.X+2*a.X)/3).jsglVmlize()+","+((b.currLoc.Y+2*a.Y)/3).jsglVmlize()+","+((2*a.X+this.endPoint.X)/3).jsglVmlize()+","+((2*a.Y+this.endPoint.Y)/3).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.getNewLocation=function(a){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbsoluteSmoothQuadraticBezier.prototype.getQBControlPoint=function(a){return newCtlPoint=new jsgl.Vector2D(2*a.currLoc.X-a.lastQBCtl.X,2*a.currLoc.Y-a.lastQBCtl.Y)};jsgl.path.RelativeSmoothQuadraticBezier=function(a,b){jsgl.path.AbstractSmoothQuadraticBezier.call(this,a||0,b||0)};jsgl.path.RelativeSmoothQuadraticBezier.jsglExtend(jsgl.path.AbstractSmoothQuadraticBezier);jsgl.path.RelativeSmoothQuadraticBezier.prototype.toSvgCommand=function(){return"t"+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeSmoothQuadraticBezier.prototype.toVmlCommand=function(b){var a=new jsgl.Vector2D(b.currLoc.X-b.lastQBCtl.X,b.currLoc.Y-b.lastQBCtl.Y);return"v"+((2*a.X)/3).jsglVmlize()+","+((2*a.Y)/3).jsglVmlize()+","+((2*a.X+this.endPoint.X)/3).jsglVmlize()+","+((2*a.Y+this.endPoint.Y)/3).jsglVmlize()+","+(this.endPoint.X).jsglVmlize()+","+(this.endPoint.Y).jsglVmlize()};jsgl.path.RelativeSmoothQuadraticBezier.prototype.getNewLocation=function(a){return a.currLoc.add(this.endPoint)};jsgl.path.RelativeSmoothQuadraticBezier.prototype.getQBControlPoint=function(a){return new jsgl.Vector2D(2*a.currLoc.X-a.lastQBCtl.X,2*a.currLoc.Y-a.lastQBCtl.Y)};jsgl.path.AbstractEllipticalArc=function(g,e,a,f,d,c,b){jsgl.path.AbstractPathSegment.call(this);this.radii=new jsgl.Vector2D(g||0,e||0);this.rotation=a||0;this.largeArc=!!f;this.sweep=!!d;this.endPoint=new jsgl.Vector2D(c||0,b||0)};jsgl.path.AbstractEllipticalArc.jsglExtend(jsgl.path.AbstractPathSegment);jsgl.path.AbstractEllipticalArc.prototype.getXRadius=function(){return this.radii.X};jsgl.path.AbstractEllipticalArc.prototype.setXRadius=function(a){this.radii.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getYRadius=function(){return this.radii.Y};jsgl.path.AbstractEllipticalArc.prototype.setYRadius=function(a){this.radii.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getRadii=function(){return jsgl.cloneObject(this.radii)};jsgl.path.AbstractEllipticalArc.prototype.setRadii=function(a){this.radii=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.setRadiiXY=function(a,b){this.radii=new jsgl.Vector2D(a,b);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getRotation=function(){return this.rotation};jsgl.path.AbstractEllipticalArc.prototype.setRotation=function(a){this.rotation=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getLargeArc=function(){return this.largeArc};jsgl.path.AbstractEllipticalArc.prototype.setLargeArc=function(a){this.largeArc=!!a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getSweep=function(){return this.sweep};jsgl.path.AbstractEllipticalArc.prototype.setSweep=function(a){this.sweep=!!a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getEndX=function(){return this.endPoint.X};jsgl.path.AbstractEllipticalArc.prototype.setEndX=function(a){this.endPoint.X=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getEndY=function(){return this.endPoint.Y};jsgl.path.AbstractEllipticalArc.prototype.setEndY=function(a){this.endPoint.Y=a;this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.getEndPoint=function(){return jsgl.cloneObject(this.endPoint)};jsgl.path.AbstractEllipticalArc.prototype.setEndPoint=function(a){this.endPoint=jsgl.cloneObject(a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.setEndPointXY=function(b,a){this.endPoint=new jsgl.Vector2D(b,a);this.onChangeRaiser.raiseEvent()};jsgl.path.AbstractEllipticalArc.prototype.bezierApproximation=function(D,h,g,k,j,C,f,b){var k=Math.abs(k),j=Math.abs(j),g=Math.PI*g/180,z=Math.cos(g),e=Math.sin(g);if((k==0&&j==0)||(D==C&&h==f)){return"l"+D.jsglVmlize()+","+h.jsglVmlize()+","+C.jsglVmlize()+","+f.jsglVmlize()}var v=(z*(D-C)+e*(h-f))/2,c=(-e*(D-C)+z*(h-f))/2,x=Math.sqrt((v*v)/(k*k)+(c*c)/(j*j));if(x>1){k*=x;j*=x}var r=this.largeArc,E=this.sweep,d=(r==E)?-1:1,l=k*k*j*j;wt2=k*k*c*c+j*j*v*v,root=Math.sqrt(Math.max(0,l/wt2-1)),cxs=d*root*k*c/j,cys=-d*root*j*v/k,cx=z*cxs-e*cys+(D+C)/2,cy=e*cxs+z*cys+(h+f)/2,xt1=z*(D-cx)+e*(h-cy),yt1=-e*(D-cx)+z*(h-cy),xt2=z*(C-cx)+e*(f-cy),yt2=-e*(C-cx)+z*(f-cy),th1=xt1/k,th2=yt1/j,th3=xt2/k,th4=yt2/j,vh=(yt1>=0?1:-1),vg=(yt2>=0?1:-1),theta1=vh*Math.acos(th1/Math.sqrt(th1*th1+th2*th2)),theta2=vg*Math.acos(th3/Math.sqrt(th3*th3+th4*th4)),dtheta=Math.abs(theta2-theta1),dthetb=Math.abs(dtheta-2*Math.PI);if(r){dtheta=Math.max(dtheta,dthetb)}else{dtheta=Math.min(dtheta,dthetb)}if(!E){dtheta*=-1}var p=dtheta/b,F=[];for(var B=0;B<=b;B++){F[B]=[];var a=B*p,A=Math.cos(a+theta1),w=Math.sin(a+theta1),n=k*A,y=j*w,u=-p*k*w,t=p*j*A;F[B][0]=z*n-e*y+cx;F[B][1]=e*n+z*y+cy;F[B][2]=z*u-e*t;F[B][3]=e*u+z*t}var q=F[0][0]+F[0][2]/3,o=F[0][1]+F[0][3]/3;var m=[];for(var B=0;B<=b;B++){m[B]={x:F[B][0]-F[B][2]/3,y:F[B][1]-F[B][3]/3}}var s="l"+F[0][0].jsglVmlize()+","+F[0][1].jsglVmlize()+"c"+q.jsglVmlize()+","+o.jsglVmlize()+","+m[1].x.jsglVmlize()+","+m[1].y.jsglVmlize()+","+F[1][0].jsglVmlize()+","+F[1][1].jsglVmlize();for(var B=2;B<=b;B++){s+="c"+(2*F[B-1][0]-m[B-1].x).jsglVmlize()+","+(2*F[B-1][1]-m[B-1].y).jsglVmlize()+","+m[B].x.jsglVmlize()+","+m[B].y.jsglVmlize()+","+F[B][0].jsglVmlize()+","+F[B][1].jsglVmlize()}return s};jsgl.path.AbsoluteEllipticalArc=function(g,e,a,f,d,c,b){jsgl.path.AbstractEllipticalArc.call(this,g||0,e||0,a||0,!!f,!!d,c||0,b||0)};jsgl.path.AbsoluteEllipticalArc.jsglExtend(jsgl.path.AbstractEllipticalArc);jsgl.path.AbsoluteEllipticalArc.prototype.toSvgCommand=function(){return"A"+this.radii.X+","+this.radii.Y+","+this.rotation+","+(this.largeArc?"1":"0")+","+(this.sweep?"1":"0")+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.AbsoluteEllipticalArc.prototype.toVmlCommand=function(a){return this.bezierApproximation(a.currLoc.X,a.currLoc.Y,this.rotation,this.radii.X,this.radii.Y,this.endPoint.X,this.endPoint.Y,16)};jsgl.path.AbsoluteEllipticalArc.prototype.getNewLocation=function(a){return jsgl.cloneObject(this.endPoint)};jsgl.path.RelativeEllipticalArc=function(g,e,a,f,d,c,b){jsgl.path.AbstractEllipticalArc.call(this,g||0,e||0,a||0,!!f,!!d,c||0,b||0)};jsgl.path.RelativeEllipticalArc.jsglExtend(jsgl.path.AbstractEllipticalArc);jsgl.path.RelativeEllipticalArc.prototype.toSvgCommand=function(){return"a"+this.radii.X+","+this.radii.Y+","+this.rotation+","+(this.largeArc?"1":"0")+","+(this.sweep?"1":"0")+","+this.endPoint.X+","+this.endPoint.Y};jsgl.path.RelativeEllipticalArc.prototype.toVmlCommand=function(a){return this.bezierApproximation(a.currLoc.X,a.currLoc.Y,this.rotation,this.radii.X,this.radii.Y,a.currLoc.X+this.endPoint.X,a.currLoc.Y+this.endPoint.Y,16)};jsgl.path.RelativeEllipticalArc.prototype.getNewLocation=function(a){return a.currLoc.add(this.endPoint)};(function(a){function h(a,b){var c=a.length;while(c--)if(a[c]===b)return c;return-1}function i(a){var b,g,i,j,k;b=a.keyCode;if(b==93||b==224)b=91;if(b in d){d[b]=!0;for(i in f)f[i]==b&&(l[i]=!0);return}if(!l.filter.call(this,a))return;if(!(b in c))return;for(j=0;j<c[b].length;j++){g=c[b][j];if(g.scope==e||g.scope=="all"){k=g.mods.length>0;for(i in d)if(!d[i]&&h(g.mods,+i)>-1||d[i]&&h(g.mods,+i)==-1)k=!1;(g.mods.length==0&&!d[16]&&!d[18]&&!d[17]&&!d[91]||k)&&g.method(a,g)===!1&&(a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation&&a.stopPropagation(),a.cancelBubble&&(a.cancelBubble=!0))}}}function j(a){var b=a.keyCode,c;if(b==93||b==224)b=91;if(b in d){d[b]=!1;for(c in f)f[c]==b&&(l[c]=!1)}}function k(){for(b in d)d[b]=!1;for(b in f)l[b]=!1}function l(a,b,d){var e,h,i,j;d===undefined&&(d=b,b="all"),a=a.replace(/\s/g,""),e=a.split(","),e[e.length-1]==""&&(e[e.length-2]+=",");for(i=0;i<e.length;i++){h=[],a=e[i].split("+");if(a.length>1){h=a.slice(0,a.length-1);for(j=0;j<h.length;j++)h[j]=f[h[j]];a=[a[a.length-1]]}a=a[0],a=g[a]||a.toUpperCase().charCodeAt(0),a in c||(c[a]=[]),c[a].push({shortcut:e[i],scope:b,method:d,key:e[i],mods:h})}}function m(a){var b=(a.target||a.srcElement).tagName;return b!="SELECT"&&b!="TEXTAREA"}function n(a){e=a||"all"}function o(){return e||"all"}function p(a){var b,d,e;for(b in c){d=c[b];for(e=0;e<d.length;)d[e].scope===a?d.splice(e,1):e++}}function q(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,function(){c(window.event)})}var b,c={},d={16:!1,18:!1,17:!1,91:!1},e="all",f={"?":16,shift:16,"?":18,alt:18,option:18,"^":17,ctrl:17,control:17,"?":91,command:91},g={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220};for(b=1;b<20;b++)f["f"+b]=111+b;for(b in f)l[b]=!1;q(document,"keydown",i),q(document,"keyup",j),q(window,"focus",k),a.key=l,a.key.setScope=n,a.key.getScope=o,a.key.deleteScope=p,a.key.filter=m,typeof module!="undefined"&&(module.exports=key)})(this);var color_black="#000000";var color_white="#FFFFFF";var color_red="#FF0000";var color_lime="#00FF00";var color_blue="#0000FF";var color_yellow="#FFFF00";var color_cyan="#00FFFF";var color_magenta="#FF00FF";var color_silver="#C0C0C0";var color_gray="#808080";var color_maroon="#800000";var color_olive="#808000";var color_green="#008000";var color_lime="#00ff00";var color_purple="#800080";var color_teal="#008080";var color_navy="#000080";var color_orange_red="#FF4500";var color_dark_orange="#FF8C00";var color_gold="#FFD700";var color_golden_rod="#DAA520";var color_khaki="#F0E68C";var color_yellow_green="#9ACD32";var color_green_yellow="#ADFF2F";var color_purple="#800080";var color_deep_pink="#FF1493";var color_pink="#FFC0CB";var color_chocolate="#D2691E";var color_grey="#808080";var color_gray=color_grey;var color_orange="#ff8000";var color_chrome_yellow="rgb(252,222,40)";var color_anti_chrome_yellow="rgb(126,111,20)";var color_breadcrumb=color_orange;var color_earth_fill="rgb(1,70,150)";var color_earth_fill=color_blue;var color_earth_stroke=color_yellow;var color_moon_fill="rgb(200,200,200)";var color_moon_fill=color_grey;var color_moon_stroke="rgb(255,255,0)";var color_moon_stroke=color_yellow;var color_moon_stroke=color_green;var color_counterweight_fill="rgb(255,0,0)";var color_counterweight_stroke="rgb(0,0,255)";var color_scale_o_meters=color_chrome_yellow;var color_title_text_bright=color_chrome_yellow;var color_title_text_dark="#644e0f";var color_sv_stroke=color_blue;var color_sv_stroke=color_black;var color_sv_fill="rgb(20,255,20)";var color_sv_fill=color_lime;var color_label_1="rgb(0,150,0)";var color_label_2="rgb(110,110,40)";var color_label_3="rgb(90,90,90)";var color_label_4="rgb(60,90,120)";var color_vertical_line="rgb(150,150,150)";var color_vertical_line=color_cyan;var color_horizontal_line="rgb(150,150,150)";var color_SE_cable=color_olive;var color_velocity_line="rgb(250,200,0)";var color_velocity_magnifier_line="rgb(125,100,0)";key("A",function(){alert("* U-Fly-It Satellite with Space Elevators. Version 0.2  (UFlySatSE.js, UFlySatSE.exe, etc.)\n* Copyright 2012 by EndlessSkyway (mainjs_info at endlessskyway.com)\n*\n* ALL RIGHTS RESERVED.\n* You may run this on one computer, but you may not modify it and you may not redistribute it.\n* You may run this when it is loaded from a web site as part of a web page.\n* You may not put it on any web page without permission from the copyright holder.\n* \n* This program is a prototype.  It is distributed WITHOUT ANY WARRANTY; without\n* even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. \n*\n* The copyright holder is inclined to make this license GNU LGPL or GNU GPL in \n* the future, but it isn't yet.  Contact him to work out easy agreements in the meantime.\n* \n* The graphics library used here, Javascript Graphics Library (JSGL), is subject to the terms of JSGL.\n* The keyboard library used here, keymaster.js c 2011 Thomas Fuchs, is subject to those terms.\n\n\n")});key("9",function(){delta_v(+1.524);return false});key("8, shift+up",function(){delta_v(+15.24);return false});key("i, up",function(){remove_intro_labels();delta_v(+152.4);return false});key("k, down",function(){remove_intro_labels();delta_v(-152.4);return false});key(",",function(){delta_v(-15.24);return false});key("shift+down",function(){delta_v(-15.24);return false});key(".",function(){delta_v(-1.524);return false});key("shift+left",function(){delta_v_sideways(-15.24);return false});key("j, left",function(){delta_v_sideways(-152.4);return false});key("l, right",function(){delta_v_sideways(+152.4);return false});key("shift+right",function(){delta_v_sideways(+15.24);return false});key("[",function(){special_velocity("reverse");return false});key("]",function(){special_velocity("zero");return false});key("shift+home",function(){scroll();return false});key("v",function(){increase_se_level(+1);return false});key("c",function(){increase_se_level(+0.002);return false});key("x",function(){increase_se_level(-0.002);return false});key("z",function(){increase_se_level(-1);return false});key("tab",function(){move_center();return false});key("pageup",function(){change_scale_on_the_fly(-1.5);return false});key("r",function(){change_scale_on_the_fly(-1.5);return false});key("pagedown",function(){change_scale_on_the_fly(+1.5);return false});key("f",function(){change_scale_on_the_fly(+1.5);return false});key("p",function(){paused_state("toggle");return false});key("shift+r",function(){reset_to_zero();return false});key("2",function(){new_breadcrumb_weight(1.2);return false});key("1",function(){new_breadcrumb_weight(-1.2);return false});key("4",function(){rings_brighten(1.2);return false});key("3",function(){rings_brighten(-1.2);return false});var reduce_angle_54672726_TWO_PI=2*Math.PI;var reduce_angle_76468975_PI=Math.PI;function reduce_angle(a){var b=a%(reduce_angle_54672726_TWO_PI);if(b>reduce_angle_76468975_PI){return b-reduce_angle_54672726_TWO_PI}if(b<=-reduce_angle_76468975_PI){return b+reduce_angle_54672726_TWO_PI}return b}myPanel=new jsgl.Panel(document.getElementById("panel"));var xmax=4000;var ymax=2000;var xmid=xmax/2;var ymid=ymax/2;xmid=xmid*(1200/xmax);ymid=ymid*(700/ymax);var ymid_original=ymid;var x_screen_center=xmid;var y_screen_center=ymid;function scroll(b,a){x_screen_center=x_screen_center+b;y_screen_center=y_screen_center+a;if(typeof a=="undefined"){y_screen_center=ymid}if(typeof b=="undefined"){x_screen_center=xmid}breadcrumb_move();earth_move();rings_move();thrust_marker_move(0,0,0,0)}function scroll_to_crosshairs(){display_crosshairs(crosshair_x,crosshair_y);x_screen_center=crosshair_x;y_screen_center=crosshair_y;scroll(0,0)}var drag_scroller_mdownx,drag_scroller_mdowny;var crosshair_x=600,crosshair_y=400;var horizontal_crosshair=myPanel.createLine();horizontal_crosshair.getStroke().setDashStyle(jsgl.DashStyles.DASH);horizontal_crosshair.getStroke().setColor(color_red);horizontal_crosshair.setZIndex(400);horizontal_crosshair.getStroke().setWeight(2);horizontal_crosshair.getStroke().setOpacity(0.4);var vertical_crosshair=myPanel.createLine();vertical_crosshair.getStroke().setDashStyle(jsgl.DashStyles.DASH);vertical_crosshair.getStroke().setColor(color_red);vertical_crosshair.setZIndex(400);vertical_crosshair.getStroke().setWeight(2);vertical_crosshair.getStroke().setOpacity(0.4);myPanel.addElement(horizontal_crosshair);myPanel.addElement(vertical_crosshair);function crosshairs_hide(){horizontal_crosshair.getStroke().setOpacity(0);vertical_crosshair.getStroke().setOpacity(0)}function crosshairs_show(){horizontal_crosshair.getStroke().setOpacity(0.4);vertical_crosshair.getStroke().setOpacity(0.4)}function crosshairs_move(a,b){crosshair_x=a;crosshair_y=b;horizontal_crosshair.setStartPointXY(0,b);horizontal_crosshair.setEndPointXY(6000,b);vertical_crosshair.setStartPointXY(a,0);vertical_crosshair.setEndPointXY(a,4000)}function crosshairs_park(a){crosshair_x=x_screen_center;crosshair_y=y_screen_center;display_crosshairs(x_screen_center,y_screen_center,a)}function display_crosshairs(b,d,c){var a=false;if(typeof c=="undefined"){c=0;a=true}crosshairs_move(b,d);crosshairs_show()}function panel_mdown(a){remove_intro_labels();drag_scroller_mdownx=a.getX();drag_scroller_mdowny=a.getY();crosshair_x=drag_scroller_mdownx;crosshair_y=drag_scroller_mdowny;display_crosshairs(crosshair_x,crosshair_y)}function panel_mup(c){var b=c.getX();var a=c.getY();scroll(b-drag_scroller_mdownx,a-drag_scroller_mdowny);crosshair_x=b;crosshair_y=a;display_crosshairs(crosshair_x,crosshair_y)}function panel_mDoubleclick(a){scroll_to_crosshairs()}myPanel.addMouseDownListener(panel_mdown);myPanel.addMouseUpListener(panel_mup);myPanel.addDoubleClickListener(panel_mDoubleclick);crosshairs_park(500);crosshairs_hide();var spacey_backdrop_on=true;document.getElementById("body_id").background="../paper.jpg";document.getElementById("body_id").background="../starry.jpg";function toggle_spaceybackdrop(){if(spacey_backdrop_on==true){spacey_backdrop_on=false}else{spacey_backdrop_on=true}set_backdrop()}function set_backdrop(){if(spacey_backdrop_on==true){scale_o_meters_bar.getStroke().setColor(color_chrome_yellow);scale_o_meters_label.setFontColor(color_chrome_yellow);document.getElementById("button_spaceybackdrop").value="Backdrop: Spacey";document.getElementById("body_id").bgcolor="#000000";document.getElementById("body_id").background="../starry.jpg"}if(spacey_backdrop_on==false){scale_o_meters_bar.getStroke().setColor(color_anti_chrome_yellow);scale_o_meters_label.setFontColor(color_anti_chrome_yellow);document.getElementById("button_spaceybackdrop").value="Backdrop: Paper";document.getElementById("body_id").bgcolor="#cc0000";document.getElementById("body_id").background="../paper.jpg"}}label_intro1=myPanel.createLabel();label_intro1.setZIndex(50);label_intro1.setText("Hit up/down arrows to change speed and alter orbit.");label_intro1.setLocationXY(60,100);label_intro1.setFontSize(20);label_intro1.setFontColor(color_orange);label_intro2=myPanel.createLabel();label_intro2.setZIndex(50);label_intro2.setText("Grapple the Earth elevator at 66%, then release.");label_intro2.setLocationXY(70,130);label_intro2.setFontSize(20);label_intro2.setFontColor(color_olive);label_intro3=myPanel.createLabel();label_intro3.setZIndex(50);label_intro3.setText("Try Trail, Velocity, & Horizon buttons.  Planet crash?  Hit the '512:1' button.");label_intro3.setLocationXY(80,160);label_intro3.setFontSize(20);label_intro3.setFontColor(color_pink);label_intro4=myPanel.createLabel();label_intro4.setZIndex(50);label_intro4.setText("Click the 'must read' Help/Instructions or Videos (above) for more know-how.");label_intro4.setLocationXY(90,190);label_intro4.setFontSize(20);label_intro4.setFontColor(color_lime);label_intro5=myPanel.createLabel();label_intro5.setZIndex(50);label_intro5.setText("[ Click anywhere to clear these opening messages. ] ");label_intro5.setLocationXY(100,220);label_intro5.setFontSize(16);label_intro5.setFontColor(color_grey);function add_intro_labels(){myPanel.addElement(label_intro1);myPanel.addElement(label_intro2);myPanel.addElement(label_intro3);myPanel.addElement(label_intro4);myPanel.addElement(label_intro5);intro_labels_on=true}var intro_labels_on=true;function remove_intro_labels(){if(intro_labels_on==true){myPanel.removeElement(label_intro1);myPanel.removeElement(label_intro2);myPanel.removeElement(label_intro3);myPanel.removeElement(label_intro4);myPanel.removeElement(label_intro5)}intro_labels_on=false}var intro_label_add_delay=0;var intro_label_remove_delay=16000;setTimeout(add_intro_labels,intro_label_add_delay);setTimeout(remove_intro_labels,intro_label_remove_delay);label_1=myPanel.createLabel();label_1.setZIndex(-15);label_1.setText("Setting up, please wait...");label_1.setLocationXY(260,3);label_1.setFontSize(20);label_1.setFontColor(color_label_1);myPanel.addElement(label_1);label_2=myPanel.createLabel();label_2.setZIndex(-15);label_2.setText("......");label_2.setLocationXY(7,26);label_2.setFontSize(20);label_2.setFontColor(color_label_2);myPanel.addElement(label_2);label_3=myPanel.createLabel();label_3.setZIndex(-15);label_3.setText("......");label_3.setLocationXY(7,49);label_3.setFontSize(20);label_3.setFontColor(color_label_3);myPanel.addElement(label_3);label_4=myPanel.createLabel();label_4.setZIndex(-15);label_4.setText("......");label_4.setLocationXY(7,72);label_4.setFontSize(20);label_4.setFontColor(color_label_4);myPanel.addElement(label_4);var PI=Math.PI;var PI_over_2=Math.PI/2;var DPR=360/(2*PI);var RPD=(2*PI)/360;var MPF=0.3048;var ER=6356766;var EM=5.98e+24;var E_mass=EM;var SPD=86164.0905;var E_period_sidereal=SPD;var EAR=(2*PI/SPD);var E_revolution_rate=EAR;var GEM=398600441800000;var GEO_r=Math.abs(Math.pow((GEM/(EAR*EAR)),(1/3)));var GEO_alt=GEO_r-ER;var M_period_sidereal=27.32166155*24*3600;var M_revolution_rate=2*PI/M_period_sidereal;var MR=0.273*ER;var GMM_const=4902777900000;var GMM=GMM_const;var M_distance=384400000;var L1_Eradius=326458295.84900576;var L2_Eradius=449078799.40258586;var L3_Eradius=382021838.12011606;L3_Eradius=382022700;L3_Eradius=382022600;L3_Eradius=382022650;var L4_Eradius=M_distance;var L4_angle_advance=60*RPD;var L4_angle_advance_sine=Math.sin(L4_angle_advance);var L4_angle_advance_cosine=Math.cos(L4_angle_advance);var L4_angle;var L4_angle_sine;var L4_angle_cosine;var L4_x,L4_y;var L4_s=M_revolution_rate*L4_Eradius;var L5_Eradius=M_distance;var L5_angle_advance=-60*RPD;var L5_angle_advance_sine=Math.sin(L5_angle_advance);var L5_angle_advance_cosine=Math.cos(L5_angle_advance);var L5_angle;var L5_angle_sine;var L5_angle_cosine;var L5_x,L5_y;var L5_s=M_revolution_rate*L5_Eradius;var L1_Malt=M_distance-L1_Eradius-MR;var L2_Malt=L2_Eradius-M_distance-MR;var L2_lse_percent=-100*(L2_Eradius-M_distance+MR)/L1_Malt;var L3_Malt=M_distance+L3_Eradius-MR;var L3_lse_percent=100*(L3_Malt)/L1_Malt;var moon_gravity_on=true;function toggle_moon_gravity(){if(moon_gravity_on==true){moon_gravity_on=false;document.getElementById("button_moongravity").value="Moon Gravity OFF"}else{moon_gravity_on=true;document.getElementById("button_moongravity").value="Moon Gravity ON"}}var Barycenter_Eradius;var Barycenter_Eradius_moongrav_on=M_distance*(GMM_const/(GEM+GMM_const));var Barycenter_Eradius_moongrav_off=0;if(moon_gravity_on==true){Barycenter_Eradius=Barycenter_Eradius_moongrav_on}else{Barycenter_Eradius=Barycenter_Eradius_moongrav_off}var Barycenter_Mradius;var Barycenter_Mradius_moongrav_on=M_distance-Barycenter_Eradius_moongrav_on;var Barycenter_Mradius_moongrav_off=M_distance-Barycenter_Eradius_moongrav_off;if(moon_gravity_on==true){Barycenter_Mradius=Barycenter_Mradius_moongrav_on}else{Barycenter_Mradius=Barycenter_Mradius_moongrav_off}var M_s=M_distance*M_revolution_rate;var E_a;var E_a_moongrav_on=M_revolution_rate*M_revolution_rate*Barycenter_Eradius_moongrav_on;var E_a_moongrav_off=M_revolution_rate*M_revolution_rate*Barycenter_Eradius_moongrav_off;if(moon_gravity_on==true){E_a=E_a_moongrav_on}else{E_a=E_a_moongrav_off}var M_a;var M_a_moongrav_on=M_revolution_rate*M_revolution_rate*Barycenter_Mradius_moongrav_on;var M_a_moongrav_off=M_revolution_rate*M_revolution_rate*Barycenter_Mradius_moongrav_off;if(moon_gravity_on==true){M_a=M_a_moongrav_on}else{M_a=M_a_moongrav_off}var sim_sec_per_world_sidereal_day=60;var sim_sec_per_world_sidereal_day=1200;var bigify_temp=1;var MUs_per_screen=3;MUs_per_screen=2*3/2.6/11.39;MUs_per_screen=4*3/2.6/11.39;MUs_per_screen=MUs_per_screen*Math.pow(1.5,4);var screen_width=MUs_per_screen*M_distance;var plot_scale=screen_width/xmax;var center_of_display=0;var center_of_display_rotating_around_earth_center=0;var center_of_display_string=new Array(7);center_of_display_string[0]="..EARTH...";center_of_display_string[1]="EARTH TOP ";center_of_display_string[2]="Barycenter";center_of_display_string[3]=".EARTH CW.";center_of_display_string[4]=".MOON.....";center_of_display_string[5]="....L1 .........";center_of_display_string[6]="MOON CW";center_of_display_string[7]="SATELLITE";function plotx(a){if(center_of_display==0){return(a)/plot_scale+x_screen_center}if(center_of_display==2){return(a-barycenter_x())/plot_scale+x_screen_center}if(center_of_display==4){return(a-moon_center_x())/plot_scale+x_screen_center}if(center_of_display==5){return(a-L1_x())/plot_scale+x_screen_center}if(center_of_display==6){return(a-LCW_x())/plot_scale+x_screen_center}if(center_of_display==7){return(a-SV_x)/plot_scale+x_screen_center}}function ploty(a){if(center_of_display==0){return -(a)/plot_scale+y_screen_center}if(center_of_display==2){return -(a-barycenter_y())/plot_scale+y_screen_center}if(center_of_display==4){return -(a-moon_center_y())/plot_scale+y_screen_center}if(center_of_display==5){return -(a-L1_y())/plot_scale+y_screen_center}if(center_of_display==6){return -(a-LCW_y())/plot_scale+y_screen_center}if(center_of_display==7){return -(a-SV_y)/plot_scale+y_screen_center}}function move_center(){if(!paused_state()){center_of_display=center_of_display+1;if(center_of_display==1){center_of_display=2}if(center_of_display==3){center_of_display=4}if(center_of_display>7){center_of_display=0}change_scale_on_the_fly(1)}center_of_display_rotating_around_earth_center=true;if(center_of_display==0){center_of_display_rotating_around_earth_center=false}document.getElementById("button_screencenter").value="Attention Object: "+center_of_display_string[center_of_display];earth_move();rings_move()}function change_scale_on_the_fly(i,h,f){var d,g;var a=true;if(typeof h=="undefined"){a=false}if(typeof f=="undefined"){a=false}h=crosshair_x;f=crosshair_y;display_crosshairs(crosshair_x,crosshair_y);if(i==0){i=1}if(i>0){g=true;d=false}else{d=true;g=false}i=Math.abs(i);if(g){MUs_per_screen=MUs_per_screen*i}if(d){MUs_per_screen=MUs_per_screen/i}screen_width=MUs_per_screen*M_distance;plot_scale=screen_width/xmax;if(a==true){var c=x_screen_center-h;var b=y_screen_center-f;var e;if(g){e=-(1-1/i)}if(d){e=(i-1)}scroll(c*e,b*e)}moon_setsize();earth_setsize();barycenter_setsize();L1_setsize();L2_setsize();L3_setsize();L4_setsize();L5_setsize();CW_setsize();ESE_cable_setthickness();LCW_setsize();LSE_cable_setthickness();rings_setsize();SV_setsize();thrust_marker_setthickness();velocity_line_setthickness();horizontal_vertical_line_setthickness();meters_per_scale_bar=(scale_o_meters_bar_length*plot_scale).toPrecision(3);scale_o_meters_label.setText("^ "+scale_o_meters_bar_length+"-pixel bar = "+meters_per_scale_bar+" meters ^");breadcrumb_move();earth_move();rings_move()}var ring_radius=new Array(MR+100000,ER+100000*0.3048,ER+100000,ER+350000,0.66*GEO_alt+ER,GEO_r,L1_Eradius,M_distance,L2_Eradius);var ring_name=new Array("CSM","100,000 feet","100km - Karman Line","350 km - LEO (ISS)","66%","GEO","L1","Moon","L2");var Nrings=ring_radius.length;var ring=new Array(Nrings);for(var ringnum=0;ringnum<Nrings;ringnum++){ring[ringnum]=myPanel.createCircle();ring[ringnum].setCenterLocationXY(earth_center_x(),earth_center_y());ring[ringnum].getStroke().setWeight(0.5);ring[ringnum].getStroke().setColor("#888888");ring[ringnum].setZIndex(-40);ring[ringnum].setFill(jsgl.fill.DISABLED);myPanel.addElement(ring[ringnum])}rings_move();rings_setsize();function rings_setsize(){for(var a=0;a<Nrings;a++){ring[a].setRadius(ring_radius[a]/plot_scale)}}function rings_move(){ring[0].setCenterLocationXY(plotx(moon_center_x()),ploty(moon_center_y()));for(var a=1;a<Nrings;a++){ring[a].setCenterLocationXY(plotx(earth_center_x()),ploty(earth_center_y()))}}function rings_brighten(c){var a=1,d=1;if(c==0){c=1}if(c<0){d=1/Math.abs(c)}else{d=c}for(var b=0;b<Nrings;b++){a=d*ring[b].getStroke().getWeight();if(a>5){a=5}if(a<0.04){a=0.04}ring[b].getStroke().setWeight(a)}}var earth_image=myPanel.createImage();earth_image.setUrl("earth_image1.png");earth_image.setHorizontalAnchor(jsgl.HorizontalAnchor.CENTER);earth_image.setVerticalAnchor(jsgl.VerticalAnchor.MIDDLE);earth_image.setZIndex(-20);myPanel.addElement(earth_image);var moon_image=myPanel.createImage();myPanel.addElement(moon_image);moon_image.setUrl("moon_test_image_bw.png");moon_image.setHorizontalAnchor(jsgl.HorizontalAnchor.CENTER);moon_image.setVerticalAnchor(jsgl.VerticalAnchor.MIDDLE);moon_image.setLocationXY(xmid,ymid);moon_image.setZIndex(-20);moon_image.setRotation(-10);moon_image.setRotation(-20);moon_image.setSizeWH(50,50);var earth_angle=0;var earth_angle_old=earth_angle;earth=myPanel.createCircle();earth.setRadius(bigify_temp*ER/plot_scale);earth.getFill().setColor(color_earth_fill);earth.getStroke().setWeight(0);earth.getStroke().setColor(color_earth_fill);earth.setZIndex(-26);myPanel.addElement(earth);earth_setsize();earth_angle_update(0);function earth_center_x(){return 0}function earth_center_y(){return 0}function earth_setsize(){var a=bigify_temp*ER/plot_scale;earth.setRadius(a);earth.getStroke().setWeight(0);var b=0.997;var c=b*2*a;earth_image.setSizeWH(c,c)}function earth_angle_update(a){earth_angle_old=earth_angle;earth_angle=earth_angle_bias+a;earth_angle_sine=Math.sin(earth_angle);earth_angle_cosine=Math.cos(earth_angle);earth_image.setRotation(-earth_angle*DPR)}function earth_move(){earth.setCenterLocationXY(plotx(earth_center_x()),ploty(earth_center_y()));earth_image.setLocationXY(plotx(earth_center_x()),ploty(earth_center_y()))}earth_move();var moon_angle=PI/5;var moon_angle_old=moon_angle;var moon_angle_sine;var moon_angle_cosine;moon=myPanel.createCircle();moon_setsize();moon.getFill().setColor(color_moon_fill);moon.setStroke(jsgl.stroke.DISABLED);moon.setZIndex(-26);myPanel.addElement(moon);function moon_center_x(){return M_distance*moon_angle_cosine}function moon_center_y(){return M_distance*moon_angle_sine}function moon_setsize(){var a=bigify_temp*MR/plot_scale;moon.setRadius(a);var b=0.999;var c=b*2*a;moon_image.setSizeWH(c,c)}function moon_angle_update(a){moon_angle_old=moon_angle;moon_angle=moon_angle_bias+a;moon_angle_sine=Math.sin(moon_angle);moon_angle_cosine=Math.cos(moon_angle);L4_angle_sine=-(moon_angle_sine*L4_angle_advance_cosine+moon_angle_cosine*L4_angle_advance_sine);L4_angle_cosine=-(moon_angle_cosine*L4_angle_advance_cosine-moon_angle_sine*L4_angle_advance_sine);L5_angle_sine=-(moon_angle_sine*L5_angle_advance_cosine+moon_angle_cosine*L5_angle_advance_sine);L5_angle_cosine=-(moon_angle_cosine*L5_angle_advance_cosine-moon_angle_sine*L5_angle_advance_sine);moon_image.setRotation(-moon_angle*DPR+90)}function moon_move(){var a=plotx(moon_center_x());var b=ploty(moon_center_y());moon.setCenterLocationXY(a,b);moon_image.setLocationXY(a,b);ring[0].setCenterLocationXY(plotx(moon_center_x()),ploty(moon_center_y()))}moon_angle_update(0);moon_move();barycenter=myPanel.createCircle();barycenter.setCenterLocationXY(0,0);barycenter.getFill().setColor(color_chrome_yellow);barycenter.getStroke().setWeight(0.5);barycenter.getStroke().setColor(color_orange);barycenter.setZIndex(+35);myPanel.addElement(barycenter);barycenter_setsize();function barycenter_setsize(){barycenter.setRadius(0.02*bigify_temp*ER/plot_scale);if(barycenter.getRadius()>3){barycenter.setRadius(3)}}function barycenter_x(){return Barycenter_Eradius*moon_angle_cosine}function barycenter_y(){return Barycenter_Eradius*moon_angle_sine}moon_angle_update(0);barycenter.setCenterLocationXY(plotx(barycenter_x()),ploty(barycenter_y()));L1=myPanel.createCircle();L1.getFill().setColor("rgb(255,0,0)");L1.getStroke().setWeight(0);L1.getStroke().setColor("rgb(255,0,255)");L1.setZIndex(+2);myPanel.addElement(L1);function L1_x(){return(L1_Eradius)*moon_angle_cosine}function L1_y(){return(L1_Eradius)*moon_angle_sine}moon_angle_update(0);L1.setCenterLocationXY(plotx(L2_x()),ploty(L2_y()));L1_setsize();function L1_setsize(){var a=0.15*bigify_temp*ER/plot_scale;if(a<0.75){a=0.75}if(a>3){a=3}L1.setRadius(a)}L2=myPanel.createCircle();L2.getFill().setColor("rgb(255,0,0)");L2.getStroke().setWeight(0);L2.getStroke().setColor("rgb(255,0,255)");L2.setZIndex(+2);myPanel.addElement(L2);function L2_x(){return(L2_Eradius)*moon_angle_cosine}function L2_y(){return(L2_Eradius)*moon_angle_sine}moon_angle_update(0);L2.setCenterLocationXY(plotx(L2_x()),ploty(L2_y()));L2_setsize();function L2_setsize(){var a=0.15*bigify_temp*ER/plot_scale;if(a<0.75){a=0.75}if(a>3){a=3}L2.setRadius(a)}L3=myPanel.createCircle();L3.getFill().setColor("rgb(255,0,0)");L3.getStroke().setWeight(0);L3.getStroke().setColor("rgb(255,0,255)");L3.setZIndex(+2);myPanel.addElement(L3);function L3_x(){return -(L3_Eradius)*moon_angle_cosine}function L3_y(){return -(L3_Eradius)*moon_angle_sine}moon_angle_update(0);L3.setCenterLocationXY(plotx(L3_x()),ploty(L3_y()));L3_setsize();function L3_setsize(){var a=0.15*bigify_temp*ER/plot_scale;if(a<0.75){a=0.75}if(a>3){a=3}L3.setRadius(a)}L4=myPanel.createCircle();L4.getFill().setColor("rgb(255,0,0)");L4.getStroke().setWeight(0);L4.getStroke().setColor("rgb(255,0,255)");L4.setZIndex(+2);myPanel.addElement(L4);function L4_x(){return -(L4_Eradius)*L4_angle_cosine}function L4_y(){return -(L4_Eradius)*L4_angle_sine}moon_angle_update(0);L4.setCenterLocationXY(plotx(L4_x()),ploty(L4_y()));L4_setsize();function L4_setsize(){var a=0.15*bigify_temp*ER/plot_scale;if(a<0.75){a=0.75}if(a>3){a=3}L4.setRadius(a)}function L4_goto(){release_from_se();SV_x=L4_x();SV_y=L4_y();SV_u=L4_s*L4_angle_sine;SV_v=-L4_s*L4_angle_cosine}L5=myPanel.createCircle();L5.getFill().setColor("rgb(255,0,0)");L5.getStroke().setWeight(0);L5.getStroke().setColor("rgb(255,0,255)");L5.setZIndex(+2);myPanel.addElement(L5);function L5_x(){return -(L5_Eradius)*L5_angle_cosine}function L5_y(){return -(L5_Eradius)*L5_angle_sine}moon_angle_update(0);L5.setCenterLocationXY(plotx(L5_x()),ploty(L5_y()));L5_setsize();function L5_setsize(){var a=0.15*bigify_temp*ER/plot_scale;if(a<0.75){a=0.75}if(a>3){a=3}L5.setRadius(a)}function L5_goto(){release_from_se();SV_x=L5_x();SV_y=L5_y();SV_u=L5_s*L5_angle_sine;SV_v=-L5_s*L5_angle_cosine}LCW=myPanel.createCircle();LCW.getFill().setColor(color_counterweight_fill);LCW.getStroke().setWeight(1.5);LCW.getStroke().setColor(color_counterweight_stroke);LCW.setZIndex(+2);myPanel.addElement(LCW);LCW_setsize();function LCW_setsize(){var a=0.2*bigify_temp*ER/plot_scale;if(a<1.8){a=1.8}if(a>5){a=5}LCW.setRadius(a)}function LCW_x(){return(LSE_Eradius)*moon_angle_cosine}function LCW_y(){return(LSE_Eradius)*moon_angle_sine}moon_angle_update(0);LCW.setCenterLocationXY(plotx(LCW_x()),ploty(LCW_y()));var SE_height=100000000;var SE_longitude=-105*RPD;var CW_sine;var CW_cosine;CW=myPanel.createCircle();CW.getFill().setColor(color_counterweight_fill);CW.getStroke().setWeight(1.5);CW.getStroke().setColor(color_counterweight_stroke);CW.setZIndex(+2);myPanel.addElement(CW);CW_setsize();function CW_setsize(){var a=0.2*bigify_temp*ER/plot_scale;if(a<1.8){a=1.8}if(a>5){a=5}CW.setRadius(a)}CW.setCenterLocationXY(plotx(CW_x()),ploty(CW_y()));function CW_x(){CW_cosine=Math.cos(earth_angle+SE_longitude);return(SE_height+ER)*CW_cosine}function CW_y(){CW_sine=Math.sin(earth_angle+SE_longitude);return(SE_height+ER)*CW_sine}ESE_cable=myPanel.createLine();ESE_cable.getStroke().setColor(color_SE_cable);ESE_cable.setZIndex(-30);myPanel.addElement(ESE_cable);ESE_cable_setthickness();ESE_cable_move();function ESE_cable_move(){ESE_cable.setStartPointXY(plotx(earth_center_x()),ploty(earth_center_y()));ESE_cable.setEndPointXY(plotx(CW_x()),ploty(CW_y()))}function ESE_cable_setthickness(){var a=0.1*bigify_temp*ER/plot_scale;if(a<0.5){a=0.5}if(a>3){a=3}ESE_cable.getStroke().setWeight(a)}var LSE_height=120000000;var LSE_height=340000000;var LSE_height=200000000;var LSE_Eradius=M_distance-(LSE_height+MR);LSE_cable=myPanel.createLine();LSE_cable.getStroke().setColor(color_SE_cable);LSE_cable.setZIndex(-30);myPanel.addElement(LSE_cable);LSE_cable_setthickness();LSE_cable_move();function LSE_cable_move(){LSE_cable.setStartPointXY(plotx(moon_center_x()),ploty(moon_center_y()));LSE_cable.setEndPointXY(plotx(LCW_x()),ploty(LCW_y()))}function LSE_cable_setthickness(){var a=0.06*bigify_temp*ER/plot_scale;if(a<0.5){a=0.5}if(a>2){a=2}LSE_cable.getStroke().setWeight(a)}thrust_marker=myPanel.createLine();thrust_marker.getStroke().setColor("rgb(255,0,0)");thrust_marker.setZIndex(99);myPanel.addElement(thrust_marker);thrust_marker_setthickness();thrust_marker_move(0,0,0,0);var SV_x,SV_y;function thrust_marker_move(d,c,b,a){if(typeof b=="undefined"){b=plotx(SV_x)}if(typeof a=="undefined"){a=ploty(SV_y)}thrust_marker.setStartPointXY(b,a);thrust_marker.setEndPointXY(d,c)}function thrust_marker_setthickness(){var a=0.3*bigify_temp*ER/plot_scale;if(a<3.75){a=3.75}if(a>7.5){a=7.5}thrust_marker.getStroke().setWeight(a)}velocity_line=myPanel.createLine();velocity_line.getStroke().setColor(color_velocity_line);velocity_line.setZIndex(500);myPanel.addElement(velocity_line);velocity_line_setthickness();velocity_line_move();var velocity_line_pixels_per_mps=0.01;var velocity_line_pixels_per_mps=0.014;velocity_magnifier_line=myPanel.createLine();velocity_magnifier_line.getStroke().setColor(color_velocity_line);velocity_magnifier_line.setZIndex(500);myPanel.addElement(velocity_magnifier_line);velocity_magnifier_line.getStroke().setColor("rgb(0,128,192)");velocity_magnifier_line.getStroke().setWeight(8);velocity_magnifier_line.getStroke().setOpacity(0.4);var velocity_magnifier_line_limit=2500*0.3048;var velocity_magnifier_line_factor=80;var velocity_magnifier_line_pixels_per_mps=velocity_magnifier_line_factor*velocity_line_pixels_per_mps;var fine_fpa_line=myPanel.createLine();fine_fpa_line.getStroke().setColor("rgb(55,40,40)");fine_fpa_line.getStroke().setColor("rgb(110,60,60)");fine_fpa_line.setZIndex(99);myPanel.addElement(fine_fpa_line);fine_fpa_line_setthickness();fine_fpa_line.setStartPointXY(0,0);fine_fpa_line.setEndPointXY(0,0);var fine_fpa_line_pixels=50;var fine_fpa_line_stretch_factor=1.2;var fine_fpa_line_pixels_times_factor=fine_fpa_line_pixels*fine_fpa_line_stretch_factor;var scale_o_meters_bar_length=200;var scale_o_meters_bar=myPanel.createLine();var scale_o_meters_bar_thickness=6;var scale_o_meters_bar_half_thickness=scale_o_meters_bar_thickness/2;scale_o_meters_bar.getStroke().setColor("rgb(200,200,200)");scale_o_meters_bar.getStroke().setColor("rgb(200,200,0)");scale_o_meters_bar.getStroke().setColor(color_scale_o_meters);scale_o_meters_bar.setZIndex(200);myPanel.addElement(scale_o_meters_bar);scale_o_meters_bar.getStroke().setWeight(scale_o_meters_bar_thickness);scale_o_meters_bar.setStartPointXY(scale_o_meters_bar_half_thickness,scale_o_meters_bar_half_thickness);scale_o_meters_bar.setEndPointXY(scale_o_meters_bar_length-scale_o_meters_bar_half_thickness,scale_o_meters_bar_half_thickness);scale_o_meters_label=myPanel.createLabel();scale_o_meters_label.setZIndex(200);scale_o_meters_label.setText("^ "+scale_o_meters_bar_length+"-Pixel scale bar ^");var meters_per_scale_bar=(scale_o_meters_bar_length*plot_scale).toPrecision(3);scale_o_meters_label.setText("^ "+scale_o_meters_bar_length+"-pixel bar = "+meters_per_scale_bar+" meters ^");scale_o_meters_label.setLocationXY(1,scale_o_meters_bar_thickness);scale_o_meters_label.setFontSize(14);scale_o_meters_label.setFontColor(color_scale_o_meters);myPanel.addElement(scale_o_meters_label);var SV_zenith_angle;var SV_E_zenith_angle;var SV_M_zenith_angle;var SV_E_zenith_angle_old;var SV_M_zenith_angle_old;var SV_E_zenith_angle_delta;var SV_M_zenith_angle_delta;var SV_velocity_angle;var SV_flightpath_angle;var E_zenith_cosine;var E_zenith_sine;var M_zenith_cosine;var M_zenith_sine;var SV_zenith_cosine;var SV_zenith_sine;var N_iterations_per_frame_test;var N_iterations_per_frame_test2;var N_iterations_GAIN=2000;function set_zenith_cosines(){E_zenith_cosine=SV_x/SV_E_r;E_zenith_sine=SV_y/SV_E_r;M_zenith_cosine=moon_grav_cosine;M_zenith_sine=moon_grav_sine;SV_E_zenith_angle_old=SV_E_zenith_angle;SV_E_zenith_angle=Math.atan2(E_zenith_sine,E_zenith_cosine);SV_M_zenith_angle_old=SV_M_zenith_angle;SV_M_zenith_angle=Math.atan2(M_zenith_sine,M_zenith_cosine);SV_E_zenith_angle_delta=Math.abs(reduce_angle(SV_E_zenith_angle-SV_E_zenith_angle_old));SV_M_zenith_angle_delta=Math.abs(reduce_angle(SV_M_zenith_angle-SV_M_zenith_angle_old));SV_Total_zenith_angle_delta=SV_E_zenith_angle_delta+SV_M_zenith_angle_delta;N_iterations_per_frame_test2=N_iterations_GAIN*SV_Total_zenith_angle_delta*SV_Total_zenith_angle_delta;N_iterations_per_frame_test=N_iterations_per_frame_test2;if(N_iterations_per_frame_test2<N_iterations_per_frame_start){N_iterations_per_frame_test=N_iterations_per_frame_start}if(velocity_center==0){SV_zenith_cosine=E_zenith_cosine;SV_zenith_sine=E_zenith_sine;SV_zenith_angle=SV_E_zenith_angle}if(velocity_center==1){SV_zenith_cosine=M_zenith_cosine;SV_zenith_sine=M_zenith_sine;SV_zenith_angle=SV_M_zenith_angle}}var FPA_fine_display_range=5*RPD;var FPA_fine_display_range_sine=Math.sin(FPA_fine_display_range);var FPA_fine_display_range_cosine=Math.cos(FPA_fine_display_range);var FPA_fine_max_angle=90*RPD;var FPA_fine_magnification=FPA_fine_max_angle/FPA_fine_display_range;var SV_flightpath_angle_MAGNIFIED;var fine_fpa_line_screen_angle;var fine_fpa_line_screen_angle_cosine;var fine_fpa_line_screen_angle_sine;function velocity_line_move(g,f){if(typeof g=="undefined"){g=SV_x}if(typeof f=="undefined"){f=SV_y}var d=plotx(g);var q=ploty(f);var j,m,n;if(velocity_center==1){j=SV_Mu;m=SV_Mv;n=SV_Ms}else{j=SV_u;m=SV_v;n=SV_s}var i=SV_zenith_cosine*m-SV_zenith_sine*j;var o=i/n;var p=SV_zenith_cosine*j+SV_zenith_sine*m;var k=p/n;var l;if(o>0){l=1}else{l=-1}SV_flightpath_angle=PI_over_2-l*Math.atan2(o,k);if(Math.abs(SV_flightpath_angle)<FPA_fine_display_range){SV_flightpath_angle_MAGNIFIED=SV_flightpath_angle*FPA_fine_magnification;fine_fpa_line_screen_angle=SV_zenith_angle+PI_over_2-l*SV_flightpath_angle_MAGNIFIED;fine_fpa_line_screen_angle_cosine=Math.cos(fine_fpa_line_screen_angle);fine_fpa_line_screen_angle_sine=Math.sin(fine_fpa_line_screen_angle);var c=velocity_line_pixels_per_mps*n*fine_fpa_line_stretch_factor;if(c<fine_fpa_line_pixels_times_factor){c=fine_fpa_line_pixels_times_factor}c=l*c;var h=d+c*fine_fpa_line_screen_angle_cosine;var b=q-c*fine_fpa_line_screen_angle_sine;fine_fpa_line.setStartPointXY(d,q);fine_fpa_line.setEndPointXY(h,b)}else{if(Math.abs(SV_flightpath_angle)>=FPA_fine_display_range){fine_fpa_line.setStartPointXY(0,0);fine_fpa_line.setEndPointXY(0,0)}}var e=d+velocity_line_pixels_per_mps*j;var a=q-velocity_line_pixels_per_mps*m;velocity_line.setStartPointXY(d,q);velocity_line.setEndPointXY(e,a);if(n<velocity_magnifier_line_limit){e=d+velocity_magnifier_line_pixels_per_mps*j;a=q-velocity_magnifier_line_pixels_per_mps*m;velocity_magnifier_line.setStartPointXY(d,q);velocity_magnifier_line.setEndPointXY(e,a)}if(n>=velocity_magnifier_line_limit){velocity_magnifier_line.setStartPointXY(0,0);velocity_magnifier_line.setEndPointXY(0,0)}}function velocity_line_setthickness(){var a=0.2/2.5*bigify_temp*ER/plot_scale;if(a<1){a=1}if(a>2){a=2}velocity_line.getStroke().setWeight(a)}function fine_fpa_line_setthickness(){var a=0.2/2.5*bigify_temp*ER/plot_scale;if(a<1){a=1}if(a>2){a=2}fine_fpa_line.getStroke().setWeight(a)}var display_velocity_line=false;function toggle_velocity_line(){if(display_velocity_line){display_velocity_line=false;velocity_line.setStartPointXY(0,0);velocity_line.setEndPointXY(0,0);fine_fpa_line.setStartPointXY(0,0);fine_fpa_line.setEndPointXY(0,0);velocity_magnifier_line.setStartPointXY(0,0);velocity_magnifier_line.setEndPointXY(0,0);document.getElementById("button_velocitymarkertoggle").value="Velocity: OFF";return}else{display_velocity_line=true;document.getElementById("button_velocitymarkertoggle").value="Velocity: ON ";return}}horizontal_line=myPanel.createLine();horizontal_line.getStroke().setColor(color_horizontal_line);horizontal_line.setZIndex(100);myPanel.addElement(horizontal_line);var horizontal_line_pixels=10;var need_to_extend_horizontals_for_fine_fpa;if(horizontal_line_pixels<<fine_fpa_line_pixels){need_to_extend_horizontals_for_fine_fpa=true}else{need_to_extend_horizontals_for_fine_fpa=true}vertical_line=myPanel.createLine();vertical_line.getStroke().setColor(color_vertical_line);vertical_line.setZIndex(100);myPanel.addElement(vertical_line);var vertical_line_pixels=30;horizontal_vertical_line_setthickness();horizontal_vertical_lines_move();function horizontal_vertical_lines_move(c,b){if(typeof c=="undefined"){c=SV_x}if(typeof b=="undefined"){b=SV_y}var g=plotx(c);var f=ploty(b);var e;var d;g=plotx(c);f=ploty(b);e=g-SV_zenith_cosine*vertical_line_pixels;d=f+SV_zenith_sine*vertical_line_pixels;vertical_line.setStartPointXY(g,f);vertical_line.setEndPointXY(e,d);head_x_screen_temp=g;head_y_screen_temp=f;var a;if(need_to_extend_horizontals_for_fine_fpa==true){if(display_velocity_line==true){a=fine_fpa_line_pixels}else{a=horizontal_line_pixels}}zsh=SV_zenith_sine*a;zch=SV_zenith_cosine*a;g=head_x_screen_temp+zsh;f=head_y_screen_temp+zch;e=head_x_screen_temp-zsh;d=head_y_screen_temp-zch;horizontal_line.setStartPointXY(g,f);horizontal_line.setEndPointXY(e,d)}function horizontal_vertical_line_setthickness(){size=1;horizontal_line.getStroke().setWeight(size);vertical_line.getStroke().setWeight(size)}var display_horizontal_vertical_lines=false;function toggle_horizontal_vertical_lines(){if(display_horizontal_vertical_lines){display_horizontal_vertical_lines=false;horizontal_line.setStartPointXY(0,0);horizontal_line.setEndPointXY(0,0);vertical_line.setStartPointXY(0,0);vertical_line.setEndPointXY(0,0);document.getElementById("button_horizontoggle").value="Horizon: OFF";return}else{display_horizontal_vertical_lines=true;document.getElementById("button_horizontoggle").value="Horizon: ON ";return}}function rotating_trail_toggle_on_off(){if(rotating_trail){rotating_trail=false}else{rotating_trail=true;document.getElementById("button_trailrotation").value="Trail Rotation ON"}}var velocity_center=0;var velocity_center_string=new Array(2);velocity_center_string[0]="Horizon Orientation: EARTH";velocity_center_string[1]="Horizon Orientation: MOON ";function cycle_velocity_center(){if(!paused_state()){velocity_center=velocity_center+1;if(velocity_center>1){velocity_center=0}}document.getElementById("button_orientation").value=velocity_center_string[velocity_center]}var trail_center=0;var trail_center_string=new Array(2);trail_center_string[0]="Trail displayed relative to EARTH CENTER";trail_center_string[1]="Trail displayed relative to MOON CENTER";function cycle_trail_center(){if(!paused_state()){trail_center=trail_center+1;if(trail_center>1){trail_center=0}}}var Crash_exclamations=new Array("Thud!","Biff!","Bam!","Crunch!","Ouch!","Pow!","Slam!","Aieee!","Ooooff!","Bonk!","Eee-Yow!","Whap!","Kapow!","Powie!","Whack!","Splat!","Clank!","Klonk!","Zlonk!","Thunk!","Whamm!","Zowie!","Ky-bosh!","Urkkk!","Vronk!","Crash!","zzz-zwap!","Thwack!","Whoops!","Doh!","Squish!");Crash_label=myPanel.createLabel();Crash_label.setZIndex(30);Crash_label.setLocationXY(xmid*0.4,ymid*0.8);Crash_label.setFontSize(40);Crash_label.setFontColor("rgb(237,124,22)");myPanel.addElement(Crash_label);var Number_of_Crash_exclamations=Crash_exclamations.length;CRASH(0);function CRASH(a){if(a>0.0001&&a<1.999){Crash_label.setText(Crash_exclamations[Math.floor(Math.random()*Number_of_Crash_exclamations)])}if(a>=1.999){Crash_label.setText("Moon Crash.")}if(a<=0.0001){Crash_label.setText("")}}SV=myPanel.createCircle();SV.getFill().setColor(color_sv_fill);SV.getStroke().setWeight(0.5);SV.getStroke().setColor(color_sv_stroke);SV.setZIndex(+220);myPanel.addElement(SV);SV_setsize();function SV_move(){SV.setCenterLocationXY(plotx(SV_x),ploty(SV_y))}var SV_current_radius;function SV_setsize(){var a=0.15*bigify_temp*ER/plot_scale;if(a<2.5){a=2.5}if(a>4){a=4}SV.setRadius(a);SV_current_radius=a}var SV_init_speed;var SV_init_alt;var SV_init_gamma;var SV_init_gamma;var SV_init_ang_pos;var SV_very_far_away;var SV_x;var SV_y;var SV_init_vel_dir;var SV_u;var SV_v;var SV_s;reset_SV();function reset_SV(){SV_init_speed=25500*MPF;SV_init_alt=ER+3000000;if(attached_to_ese){SV_init_alt=ER}SV_init_gamma=30/DPR;SV_init_gamma=0/DPR;SV_init_ang_pos=40/DPR;SV_init_ang_pos=90/DPR;SV_init_gamma=0/DPR;SV_init_ang_pos=80/DPR;SV_very_far_away=100*ER;SV_x=SV_init_alt*Math.cos(SV_init_ang_pos);SV_y=SV_init_alt*Math.sin(SV_init_ang_pos);SV.setCenterLocationXY(plotx(SV_x),ploty(SV_y));SV_init_vel_dir=SV_init_ang_pos+PI/2-SV_init_gamma;SV_u=SV_init_speed*Math.cos(SV_init_vel_dir);SV_v=SV_init_speed*Math.sin(SV_init_vel_dir)}var breadcrumbs_on=false;var max_trail_length=2000;var trail_trim_percentage=10;var trail_trim_length=Math.floor(max_trail_length*(100-trail_trim_percentage)/100);var N_frames_between_breadcrumbs=1;var trail_frame_count=0;var breadcrumb_colors=new Array(color_white,color_red,color_blue,color_yellow,color_cyan,color_magenta,color_lime,color_purple,color_teal,color_khaki,color_green_yellow,color_deep_pink,color_chocolate,color_grey,color_orange);var number_of_breadcrumb_colors=breadcrumb_colors.length;var breadcrumbs=new Array();var breadcrumbs_realworldx=new Array();var breadcrumbs_realworldy=new Array();var SV_M_r_when_bc_dropped=new Array();var SV_E_r_when_bc_dropped=new Array();var SV_Mx_when_bc_dropped=new Array();var SV_My_when_bc_dropped=new Array();var moon_grav_sine_when_bc_dropped=new Array();var moon_grav_cosine_when_bc_dropped=new Array();var moon_angle_when_bc_dropped=new Array();var earth_angle_when_bc_dropped=new Array();var bc_weight=1.61051;function new_breadcrumb_weight(a){if(a==0){a=1}if(a<0){a=Math.abs(1/a)}bc_weight=bc_weight*a;if(bc_weight<1){bc_weight=1}if(bc_weight>8){bc_weight=8}}function return_breadcrumb(c,b){BC=myPanel.createLine();BC.getStroke().setColor(color_breadcrumb);BC.getStroke().setWeight(bc_weight);BC.setZIndex(40);BC.setZIndex(40);var a=plotx(c);var d=ploty(b);BC.setStartPointXY(a,d);BC.setEndPointXY(a,d);return BC}function breadcrumbs_toggle_on_off(){if(breadcrumbs_on){breadcrumbs_on=false;document.getElementById("button_trailtoggle").value="Trail: OFF"}else{breadcrumbs_on=true;document.getElementById("button_trailtoggle").value="Trail: ON "}}function breadcrumbs_dot_connector_toggle_on_off(){if(dot_connector_on){dot_connector_on=false;document.getElementById("button_dotconnectortoggle").value="Connect Dots is OFF"}else{dot_connector_on=true;document.getElementById("button_dotconnectortoggle").value="Connect Dots is ON "}}function moon_centered_trail_toggle_on_off(){if(moon_centered_trail){moon_centered_trail=false;document.getElementById("button_trailcenter").value="Trail Center: EARTH"}else{moon_centered_trail=true;document.getElementById("button_trailcenter").value="Trail Center: MOON"}}function rotating_trail_toggle_on_off(){if(rotating_trail){rotating_trail=false;document.getElementById("button_trailrotation").value="Trail Rotation OFF"}else{rotating_trail=true;document.getElementById("button_trailrotation").value="Trail Rotation ON"}}var dot_connector_on=false;var moon_centered_trail=false;var rotating_trail=false;function breadcrumb_move(){var h,j,i;var c,g,a,d;var b,e;if(moon_centered_trail==true){for(var f=0;f<breadcrumbs.length;f++){if(rotating_trail==false){if(dot_connector_on==false||f==0){breadcrumbs[f].setStartPointXY(plotx(moon_center_x()+SV_Mx_when_bc_dropped[f]),ploty(moon_center_y()+SV_My_when_bc_dropped[f]));breadcrumbs[f].setEndPointXY(plotx(moon_center_x()+SV_Mx_when_bc_dropped[f]),ploty(moon_center_y()+SV_My_when_bc_dropped[f]))}else{breadcrumbs[f].setStartPointXY(plotx(moon_center_x()+SV_Mx_when_bc_dropped[f]),ploty(moon_center_y()+SV_My_when_bc_dropped[f]));breadcrumbs[f].setEndPointXY(plotx(moon_center_x()+SV_Mx_when_bc_dropped[f-1]),ploty(moon_center_y()+SV_My_when_bc_dropped[f-1]))}}else{h=moon_angle-moon_angle_when_bc_dropped[f];j=Math.sin(h);i=Math.cos(h);e=moon_grav_cosine_when_bc_dropped[f];b=moon_grav_sine_when_bc_dropped[f];a=c;d=g;c=moon_center_x()+SV_M_r_when_bc_dropped[f]*(e*i-b*j);g=moon_center_y()+SV_M_r_when_bc_dropped[f]*(b*i+e*j);if(dot_connector_on==false||f==0){breadcrumbs[f].setStartPointXY(plotx(c),ploty(g));breadcrumbs[f].setEndPointXY(plotx(c),ploty(g))}else{breadcrumbs[f].setStartPointXY(plotx(a),ploty(d));breadcrumbs[f].setEndPointXY(plotx(c),ploty(g))}}}}else{for(var f=0;f<breadcrumbs.length;f++){if(rotating_trail==false){if(dot_connector_on==false||f==0){breadcrumbs[f].setStartPointXY(plotx(breadcrumbs_realworldx[f]),ploty(breadcrumbs_realworldy[f]));breadcrumbs[f].setEndPointXY(plotx(breadcrumbs_realworldx[f]),ploty(breadcrumbs_realworldy[f]))}else{breadcrumbs[f].setStartPointXY(plotx(breadcrumbs_realworldx[f]),ploty(breadcrumbs_realworldy[f]));breadcrumbs[f].setEndPointXY(plotx(breadcrumbs_realworldx[f-1]),ploty(breadcrumbs_realworldy[f-1]))}}else{h=earth_angle-earth_angle_when_bc_dropped[f];j=Math.sin(h);i=Math.cos(h);e=breadcrumbs_realworldx[f]/SV_E_r_when_bc_dropped[f];b=breadcrumbs_realworldy[f]/SV_E_r_when_bc_dropped[f];a=c;d=g;c=SV_E_r_when_bc_dropped[f]*(e*i-b*j);g=SV_E_r_when_bc_dropped[f]*(b*i+e*j);if(dot_connector_on==false||f==0){breadcrumbs[f].setStartPointXY(plotx(c),ploty(g));breadcrumbs[f].setEndPointXY(plotx(c),ploty(g))}else{breadcrumbs[f].setStartPointXY(plotx(a),ploty(d));breadcrumbs[f].setEndPointXY(plotx(c),ploty(g))}}}}}function drop_breadcrumb_or_not(){var b,a;trail_frame_count=trail_frame_count+1;if((trail_frame_count>=N_frames_between_breadcrumbs)&&breadcrumbs_on){trail_frame_count=0;breadcrumbs_realworldx.push(SV_x);breadcrumbs_realworldy.push(SV_y);breadcrumb=return_breadcrumb(SV_x,SV_y);breadcrumbs.push(breadcrumb);myPanel.addElement(breadcrumb);SV_Mx_when_bc_dropped.push(SV_Mx);SV_My_when_bc_dropped.push(SV_My);moon_grav_sine_when_bc_dropped.push(moon_grav_sine);moon_grav_cosine_when_bc_dropped.push(moon_grav_cosine);SV_M_r_when_bc_dropped.push(SV_M_r);SV_E_r_when_bc_dropped.push(SV_E_r);moon_angle_when_bc_dropped.push(moon_angle);earth_angle_when_bc_dropped.push(earth_angle);if(breadcrumbs.length>max_trail_length){breadcrumbs_clip(trail_trim_length)}}}function breadcrumbs_clip(b){var a;if(b<0){b=0}if(b<=1){a=b*breadcrumbs.length}if(b>1){a=b}while(breadcrumbs.length>a){myPanel.removeElement(breadcrumbs.shift());breadcrumbs_realworldx.shift();breadcrumbs_realworldy.shift();SV_Mx_when_bc_dropped.shift();SV_My_when_bc_dropped.shift();moon_grav_sine_when_bc_dropped.shift();moon_grav_cosine_when_bc_dropped.shift();SV_M_r_when_bc_dropped.shift();SV_E_r_when_bc_dropped.shift();moon_angle_when_bc_dropped.shift();earth_angle_when_bc_dropped.shift()}}var attached_to_ese=true;var attached_to_ese=false;var attached_to_lse=false;var ese_level_r=0.0314;var ese_level_alt;var last_se_was_lse=false;increase_se_level(0);var earth_onepercent=GEO_alt/100;var moon_onepercent=L1_Malt/100;function increase_se_level(a){var b=Math.sqrt(SV_x*SV_x+SV_y*SV_y);if(attached_to_ese){ese_level_r=ese_level_r+earth_onepercent*a;set_se_level(ese_level_r,"earth_radius")}if(attached_to_lse){ese_level_r=ese_level_r-moon_onepercent*a;set_se_level(ese_level_r,"earth_radius")}}function set_se_level(b,a){if(typeof a=="undefined"){a="earth_percent"}if(a=="earth_percent"){ese_level_r=b/100*GEO_alt+ER}if(a=="earth_radius"){ese_level_r=b}if(a=="earth_altitude"){ese_level_r=b+ER}if(a=="moon_percent"){lse_level_r=b/100*L1_Malt+MR;ese_level_r=M_distance-lse_level_r}}function release_from_se(){if(attached_to_lse){last_se_was_lse=true}else{last_se_was_lse=false}attached_to_ese=false;attached_to_lse=false;stop_catch_up()}function grapple_last_se(){if(ese_level_r==0.0314){return}if(last_se_was_lse==true){grapple_lse()}else{grapple_ese()}}function grapple_ese(a){remove_intro_labels();if(typeof a=="undefined"){increase_se_level(0)}else{set_se_level(a,"earth_percent")}attached_to_ese=true;attached_to_lse=false;last_se_was_lse=false;CRASH(0)}function grapple_lse(a){if(typeof a=="undefined"){increase_se_level(0)}else{set_se_level(a,"moon_percent")}attached_to_ese=false;attached_to_lse=true;last_se_was_lse=true;CRASH(0)}var elapsed_realworld_time=0;var N_iterations_per_frame_start=150;var N_iterations_per_frame=N_iterations_per_frame_start;var dt=0;var hdt2=0;var SV_E_r_last_for_crash_text=ER;var SV_E_r_last_for_crash_text=MR;var SV_E_rsqr=1;var SV_E_r=ER+1;var SV_E_rave2=1;var SV_E_rave=1;var ac_earth_grav;var ac_earth_grav_x;var ac_earth_grav_y;var ac_earth_grav_ave;var ac_earth_grav_x_ave;var ac_earth_grav_y_ave;var ac_moon_grav;var ac_moon_grav_x;var ac_moon_grav_y;var ac_moon_grav_x___temp_for_averaging;var ac_moon_grav_y___temp_for_averaging;var ac_moon_grav_x_ave;var ac_moon_grav_y_ave;var ac_bc_correction_magnitude;var ac_bc_correction_x=0;var ac_bc_correction_y=0;var ac_bc_correction_x___temp_for_averaging;var ac_bc_correction_y___temp_for_averaging;var ac_bc_correction_x_ave;var ac_bc_correction_y_ave;var ac_tot_x;var ac_tot_y;var ac_tot_x_ave;var ac_tot_y_ave;var moon_angle_bias=PI/5;var earth_angle_bias=0;function do_something(){if(!attached_to_ese&&!attached_to_lse){var b=dt/N_iterations_per_frame;var a=b*b/2;for(var c=0;((c<N_iterations_per_frame)&&!crashed);c++){moon_angle_update(M_revolution_rate*(elapsed_realworld_time+(c+0.5)*b));SV_E_r_last_for_crash_text=SV_E_r;SV_M_r_last_for_crash_text=SV_M_r;SV_E_rsqr=SV_x*SV_x+SV_y*SV_y;SV_E_r=Math.sqrt(SV_E_rsqr);get_moon_gravity_and_barycenter_corrections(SV_x,SV_y);ac_earth_grav=GEM/SV_E_rsqr;ac_earth_grav_x=ac_earth_grav*(-SV_x/SV_E_r);ac_earth_grav_y=ac_earth_grav*(-SV_y/SV_E_r);ac_tot_x=ac_earth_grav_x+ac_moon_grav_x-E_ax;ac_tot_y=ac_earth_grav_y+ac_moon_grav_y-E_ay;SV_x2=SV_x+SV_u*b+ac_tot_x*a;SV_xave=(SV_x2+SV_x)/2;SV_y2=SV_y+SV_v*b+ac_tot_y*a;SV_yave=(SV_y2+SV_y)/2;SV_E_rave2=SV_xave*SV_xave+SV_yave*SV_yave;SV_E_rave=Math.sqrt((SV_E_rave2));ac_earth_grav=GEM/SV_E_rave2;ac_earth_grav_x=ac_earth_grav*(-SV_xave/SV_E_rave);ac_earth_grav_y=ac_earth_grav*(-SV_yave/SV_E_rave);get_moon_gravity_and_barycenter_corrections(SV_xave,SV_yave);ac_tot_x_ave=ac_earth_grav_x+ac_moon_grav_x-E_ax;ac_tot_y_ave=ac_earth_grav_y+ac_moon_grav_y-E_ay;SV_x=SV_x+SV_u*b+ac_tot_x_ave*a;SV_y=SV_y+SV_v*b+ac_tot_y_ave*a;SV_u=SV_u+ac_tot_x_ave*b;SV_v=SV_v+ac_tot_y_ave*b;sense_odd_conditions();if(crashed){elapsed_realworld_time=elapsed_realworld_time+(c+0.5)*b}}crashed=false;SV_s=Math.sqrt(SV_u*SV_u+SV_v*SV_v);set_zenith_cosines();N_iterations_per_frame=N_iterations_per_frame_test;set_moon_centered_parameters()}elapsed_realworld_time=elapsed_realworld_time+dt;moon_angle_update(M_revolution_rate*elapsed_realworld_time);earth_angle_update(EAR*elapsed_realworld_time);if(attached_to_ese){CW_x();CW_y();SV_x=ese_level_r*CW_cosine;SV_y=ese_level_r*CW_sine;SV_s=EAR*ese_level_r;SV_u=-SV_s*CW_sine;SV_v=SV_s*CW_cosine;if(SV_s<0){SV_s=-SV_s}SV_E_rsqr=SV_x*SV_x+SV_y*SV_y;SV_E_r=Math.sqrt(SV_E_rsqr);get_moon_gravity_and_barycenter_corrections(SV_x,SV_y);set_moon_centered_parameters();set_zenith_cosines()}if(attached_to_lse){SV_x=ese_level_r*moon_angle_cosine;SV_y=ese_level_r*moon_angle_sine;SV_s=M_revolution_rate*ese_level_r;SV_u=-SV_s*moon_angle_sine;SV_v=SV_s*moon_angle_cosine;if(SV_s<0){SV_s=-SV_s}SV_E_rsqr=SV_x*SV_x+SV_y*SV_y;SV_E_r=Math.sqrt(SV_E_rsqr);get_moon_gravity_and_barycenter_corrections(SV_x,SV_y);set_moon_centered_parameters();set_zenith_cosines()}label_1.setText("ESE Angle / Moon Angle / Difference: ..."+(reduce_angle(earth_angle+SE_longitude)*DPR).toFixed(2)+" / "+(reduce_angle(moon_angle)*DPR).toFixed(2)+" / "+(reduce_angle(reduce_angle(moon_angle)-reduce_angle(earth_angle+SE_longitude))*DPR).toFixed(2));label_2.setText("Earth altitude (km) = "+((SV_E_r-ER)/1000).toFixed(3)+" . . . Earth altitude (%) = "+(100*(SV_E_r-ER)/GEO_alt).toFixed(3)+" . . . SPEED (Earth_referenced) =  "+(SV_s/0.3048).toFixed(0)+" fps . . . Delta-V usage: "+(deltav_total_usage/0.3048).toFixed(0)+" fps");var d=Math.floor(delay+0.5);if(d<0){label_3.setFontColor("#5a4040");d=0}else{label_3.setFontColor("#5a5a5a")}label_3.setText("Framesize Setpoint (ms) = "+FC_ms_per_frame_setpoint+" . . . Delay Margin (ms) = "+d);label_4.setText("Time Scale = "+time_scale.toPrecision(7));moon_move();barycenter.setCenterLocationXY(plotx(barycenter_x()),ploty(barycenter_y()));if(center_of_display_rotating_around_earth_center){earth_move()}L1.setCenterLocationXY(plotx(L1_x()),ploty(L1_y()));L2.setCenterLocationXY(plotx(L2_x()),ploty(L2_y()));L3.setCenterLocationXY(plotx(L3_x()),ploty(L3_y()));L4.setCenterLocationXY(plotx(L4_x()),ploty(L4_y()));L5.setCenterLocationXY(plotx(L5_x()),ploty(L5_y()));LCW.setCenterLocationXY(plotx(LCW_x()),ploty(LCW_y()));LSE_cable_move();CW.setCenterLocationXY(plotx(CW_x()),ploty(CW_y()));ESE_cable_move();if(center_of_display_rotating_around_earth_center){rings_move()}SV_move();if(display_velocity_line){velocity_line_move()}if(display_horizontal_vertical_lines){horizontal_vertical_lines_move()}breadcrumb_move();drop_breadcrumb_or_not()}var E_ax,E_ay,M_ax,M_ax;var SV_Mx,SV_My;var M_u,M_v;var SV_Mu,SV_Mv;var SV_M_rsqr;var SV_M_r;function get_moon_gravity_and_barycenter_corrections(a,b){if(moon_gravity_on){Barycenter_Eradius=Barycenter_Eradius_moongrav_on;GMM=GMM_const;E_a=E_a_moongrav_on;M_a=M_a_moongrav_on}else{Barycenter_Eradius=Barycenter_Eradius_moongrav_off;GMM=0;E_a=E_a_moongrav_off;M_a=M_a_moongrav_off}SV_Mx=a-moon_center_x();SV_My=b-moon_center_y();SV_M_rsqr=SV_Mx*SV_Mx+SV_My*SV_My;SV_M_r=Math.sqrt(SV_M_rsqr);ac_moon_grav=GMM/SV_M_rsqr;moon_grav_cosine=(SV_Mx/SV_M_r);moon_grav_sine=(SV_My/SV_M_r);ac_moon_grav_x=ac_moon_grav*-moon_grav_cosine;ac_moon_grav_y=ac_moon_grav*-moon_grav_sine;E_ax=E_a*moon_angle_cosine;E_ay=E_a*moon_angle_sine}function set_moon_centered_parameters(){get_moon_gravity_and_barycenter_corrections(SV_x,SV_y);M_u=-M_s*moon_angle_sine;M_v=M_s*moon_angle_cosine;M_flightpathangle=SV_Mu=SV_u-M_u;SV_Mv=SV_v-M_v;SV_Ms=Math.sqrt(SV_Mu*SV_Mu+SV_Mv*SV_Mv)}var thrust_marker_meters_per_mps=8000;var thrust_marker_pixels_per_mps=0.2;var deltav_total_usage=0;var u_cosine,v_cosine;var temp_u,temp_v,temp_s;function delta_v(b){deltav_total_usage=deltav_total_usage+Math.abs(b);if(velocity_center==0){temp_u=SV_u;temp_v=SV_v;temp_s=SV_s}else{temp_u=SV_Mu;temp_v=SV_Mv;temp_s=SV_Ms}u_cosine=temp_u/temp_s;v_cosine=temp_v/temp_s;var a=thrust_marker_pixels_per_mps*b;thrust_marker_move(plotx(SV_x)-a*u_cosine,ploty(SV_y)+a*v_cosine);SV_u=SV_u+b*(u_cosine);SV_v=SV_v+b*(v_cosine);setTimeout("thrust_marker_move(0,0,0,0)",30)}function delta_v_sideways(b){deltav_total_usage=deltav_total_usage+Math.abs(b);if(velocity_center==0){temp_u=SV_u;temp_v=SV_v;temp_s=SV_s}else{temp_u=SV_Mu;temp_v=SV_Mv;temp_s=SV_Ms}u_cosine=temp_u/temp_s;v_cosine=temp_v/temp_s;var a=thrust_marker_pixels_per_mps*b;thrust_marker_move(plotx(SV_x)-a*v_cosine,ploty(SV_y)-a*u_cosine);SV_u=SV_u+b*(v_cosine);SV_v=SV_v-b*(u_cosine);setTimeout("thrust_marker_move(0,0,0,0)",30)}function special_velocity(b){var a=0;if(b==="reverse"){if(velocity_center==0){a=-2*SV_s}if(velocity_center==1){a=-2*SV_Ms}delta_v(a)}if(b==="zero"){if(velocity_center==0){a=-SV_s}if(velocity_center==1){a=-SV_Ms}delta_v(a)}}var crashed=false;function sense_odd_conditions(){if((SV_E_r<ER)&&SV_E_r_last_for_crash_text>=ER){CRASH(1);crashed=true;change_time_scale("slog")}if((SV_M_r<MR)&&SV_M_r_last_for_crash_text>=MR){CRASH(2);crashed=true;if(moon_gravity_on){change_time_scale("slog")}}if(SV_M_r>MR&&SV_E_r>ER&&(SV_E_r_last_for_crash_text<ER||SV_M_r_last_for_crash_text<MR)){CRASH(0);crashed=false}}var FC_ms_per_frame_setpoint=100;var FC_t0=+new Date();var FC_frame_number=0;var FC_ms_too_slow=0;var FC_frametime_elapsed=0;var FC_new_clock_time=0;var FC_old_clock_time=0;var FC_stop=true;var delay=FC_ms_per_frame_setpoint-10;var FC_frame_timing_feedback_gain=0.8;var FC_frame_timing_feedback_gain=2;var FC_frame_timing_feedback_gain=0.05;var FC_frame_timing_feedback_gain=4;var FC_frame_timing_feedback_gain=0.8;function Frame_control(){if(paused_state()){previously_paused=true;label_1.setText("PAUSED")}else{FC_old_clock_time=FC_new_clock_time;FC_new_clock_time=+new Date()-FC_t0;FC_frametime_elapsed=FC_ms_per_frame_setpoint*FC_frame_number;FC_frame_number++;FC_ms_too_slow=FC_new_clock_time-FC_frametime_elapsed;FC_next_frame_gotime=FC_new_clock_time+FC_ms_per_frame_setpoint;delay=FC_ms_per_frame_setpoint-FC_ms_too_slow*FC_frame_timing_feedback_gain;do_something()}setTimeout(Frame_control,delay)}var time_scale=SPD/sim_sec_per_world_sidereal_day;var time_scale=Math.pow(2,6);var time_scale=Math.pow(2,10);function change_time_scale(a,b){if(typeof a=="undefined"){return}if(typeof b=="undefined"){}if(b==0){return}if(a==="absolute"){time_scale=Math.abs(b)}if(a==="multiply"){time_scale=time_scale*Math.abs(b)}if(a==="divide"){if(b!=0){time_scale=time_scale/Math.abs(b)}}if(a==="slog"){time_scale=Math.pow(2,-20)}set_realworld_seconds_per_frame();return}var FC_previously_paused=false;var FC_is_paused=false;function paused_state(a){if(a=="toggle"){if(FC_is_paused){FC_is_paused=false;stop_catch_up()}else{FC_is_paused=true}}if(a=="true"){FC_is_paused=true}if(a=="false"){FC_is_paused=false;stop_catch_up()}return FC_is_paused}function increase_setpoint(a){if(typeof a=="undefined"){a=0}FC_ms_per_frame_setpoint=FC_ms_per_frame_setpoint+a;if(FC_ms_per_frame_setpoint<10){FC_ms_per_frame_setpoint=10}set_realworld_seconds_per_frame();stop_catch_up()}function reset_to_zero(){elapsed_realworld_time=0;deltav_total_usage=0;reset_SV();stop_catch_up()}function stop_catch_up(){FC_t0=+new Date();FC_frame_number=0}function frames_per_second(){return 1000/FC_ms_per_frame_setpoint}function seconds_per_frame(){return FC_ms_per_frame_setpoint/1000}function set_realworld_seconds_per_frame(){dt=time_scale*FC_ms_per_frame_setpoint/1000;hdt2=dt*dt/2}set_realworld_seconds_per_frame();function init(){setTimeout(Frame_control,1)}window.onload=init;set_backdrop();